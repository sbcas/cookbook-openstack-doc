<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Cookbook OpenStack Documentation</title>
  <meta name="description" content="Documentation for OpenStack cookbooks generated from the source ReadMe and attribute files. 
">

  <link rel="stylesheet" href="http://kramvan1.github.io/cookbook-openstack-doc/css/main.css">
  <link rel="canonical" href="http://www.openstack.orghttp://kramvan1.github.io/cookbook-openstack-doc/">
  <link rel="alternate" type="application/rss+xml" title="Cookbook OpenStack Documentation" href="http://www.openstack.orghttp://kramvan1.github.io/cookbook-openstack-doc/feed.xml" />
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="http://kramvan1.github.io/cookbook-openstack-doc/">Cookbook OpenStack Documentation</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="home">
  <h1 class="page-heading">Overview</h1>

  <p>The OpenStack cookbook projects are a group of integrated <a href="https://www.chef.io">Chef</a> cookbooks 
  that allow quick and easy deployments of <a href="https://www.openstack.org">Openstack</a>. For more information
  see:</p>
  <ul>
    <li><a href="https://wiki.openstack.org/wiki/Chef">OpenStack Cookbook wiki</a></li>
    <li><a href="http://governance.openstack.org/reference/projects/chefopenstack.html">OpenStack Cookbook projects</a></li>
  </ul>
  
  <p><a href="https://github.com/kramvan1/cookbook-openstack-doc">Link to source for this project.</a></p>
  
  <h1 class="page-heading">Attribute Information</h1>

  <div class="page">
    
    <h1 id="openstack-cookbook-attributes">OpenStack Cookbook Attributes</h1>

<h2 id="contents">Contents</h2>

<ul>
  <li><a href="#cookbook-openstack-common">cookbook-openstack-common</a>
    <ul>
      <li><a href="#cookbook-openstack-common-readme">cookbook-openstack-common-README</a></li>
      <li><a href="#cookbook-openstack-common-attributes-database">cookbook-openstack-common-attributes-database</a></li>
      <li><a href="#cookbook-openstack-common-attributes-default">cookbook-openstack-common-attributes-default</a></li>
      <li><a href="#cookbook-openstack-common-attributes-messaging">cookbook-openstack-common-attributes-messaging</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-bare-metal">cookbook-openstack-bare-metal</a>
    <ul>
      <li><a href="#cookbook-openstack-bare-metal-readme">cookbook-openstack-bare-metal-README</a></li>
      <li><a href="#cookbook-openstack-bare-metal-attributes-default">cookbook-openstack-bare-metal-attributes-default</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-block-storage">cookbook-openstack-block-storage</a>
    <ul>
      <li><a href="#cookbook-openstack-block-storage-readme">cookbook-openstack-block-storage-README</a></li>
      <li><a href="#cookbook-openstack-block-storage-attributes-cinder_conf">cookbook-openstack-block-storage-attributes-cinder_conf</a></li>
      <li><a href="#cookbook-openstack-block-storage-attributes-default">cookbook-openstack-block-storage-attributes-default</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-client">cookbook-openstack-client</a>
    <ul>
      <li><a href="#cookbook-openstack-client-readme">cookbook-openstack-client-README</a></li>
      <li><a href="#cookbook-openstack-client-attributes-default">cookbook-openstack-client-attributes-default</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-compute">cookbook-openstack-compute</a>
    <ul>
      <li><a href="#cookbook-openstack-compute-readme">cookbook-openstack-compute-README</a></li>
      <li><a href="#cookbook-openstack-compute-attributes-default">cookbook-openstack-compute-attributes-default</a></li>
      <li><a href="#cookbook-openstack-compute-attributes-nova_conf">cookbook-openstack-compute-attributes-nova_conf</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-dashboard">cookbook-openstack-dashboard</a>
    <ul>
      <li><a href="#cookbook-openstack-dashboard-readme">cookbook-openstack-dashboard-README</a></li>
      <li><a href="#cookbook-openstack-dashboard-attributes-default">cookbook-openstack-dashboard-attributes-default</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-database">cookbook-openstack-database</a>
    <ul>
      <li><a href="#cookbook-openstack-database-readme">cookbook-openstack-database-README</a></li>
      <li><a href="#cookbook-openstack-database-attributes-default">cookbook-openstack-database-attributes-default</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-data-processing">cookbook-openstack-data-processing</a>
    <ul>
      <li><a href="#cookbook-openstack-data-processing-readme">cookbook-openstack-data-processing-README</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-identity">cookbook-openstack-identity</a>
    <ul>
      <li><a href="#cookbook-openstack-identity-readme">cookbook-openstack-identity-README</a></li>
      <li><a href="#cookbook-openstack-identity-attributes-default">cookbook-openstack-identity-attributes-default</a></li>
      <li><a href="#cookbook-openstack-identity-attributes-keystone_conf">cookbook-openstack-identity-attributes-keystone_conf</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-image">cookbook-openstack-image</a>
    <ul>
      <li><a href="#cookbook-openstack-image-readme">cookbook-openstack-image-README</a></li>
      <li><a href="#cookbook-openstack-image-attributes-default">cookbook-openstack-image-attributes-default</a></li>
      <li><a href="#cookbook-openstack-image-attributes-glance_api_conf">cookbook-openstack-image-attributes-glance_api_conf</a></li>
      <li><a href="#cookbook-openstack-image-attributes-glance_cache_conf">cookbook-openstack-image-attributes-glance_cache_conf</a></li>
      <li><a href="#cookbook-openstack-image-attributes-glance_registry_conf">cookbook-openstack-image-attributes-glance_registry_conf</a></li>
      <li><a href="#cookbook-openstack-image-attributes-glance_scrubber_conf">cookbook-openstack-image-attributes-glance_scrubber_conf</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-network">cookbook-openstack-network</a>
    <ul>
      <li><a href="#cookbook-openstack-network-readme">cookbook-openstack-network-README</a></li>
      <li><a href="#cookbook-openstack-network-attributes-default">cookbook-openstack-network-attributes-default</a></li>
      <li><a href="#cookbook-openstack-network-attributes-neutron_conf">cookbook-openstack-network-attributes-neutron_conf</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-object-storage">cookbook-openstack-object-storage</a>
    <ul>
      <li><a href="#cookbook-openstack-object-storage-readme">cookbook-openstack-object-storage-README</a></li>
      <li><a href="#cookbook-openstack-object-storage-attributes-default">cookbook-openstack-object-storage-attributes-default</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-ops-database">cookbook-openstack-ops-database</a>
    <ul>
      <li><a href="#cookbook-openstack-ops-database-readme">cookbook-openstack-ops-database-README</a></li>
      <li><a href="#cookbook-openstack-ops-database-attributes-default">cookbook-openstack-ops-database-attributes-default</a></li>
      <li><a href="#cookbook-openstack-ops-database-attributes-mysql">cookbook-openstack-ops-database-attributes-mysql</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-ops-messaging">cookbook-openstack-ops-messaging</a>
    <ul>
      <li><a href="#cookbook-openstack-ops-messaging-readme">cookbook-openstack-ops-messaging-README</a></li>
      <li><a href="#cookbook-openstack-ops-messaging-attributes-default">cookbook-openstack-ops-messaging-attributes-default</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-orchestration">cookbook-openstack-orchestration</a>
    <ul>
      <li><a href="#cookbook-openstack-orchestration-readme">cookbook-openstack-orchestration-README</a></li>
      <li><a href="#cookbook-openstack-orchestration-attributes-default">cookbook-openstack-orchestration-attributes-default</a></li>
      <li><a href="#cookbook-openstack-orchestration-attributes-heat_conf">cookbook-openstack-orchestration-attributes-heat_conf</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-telemetry">cookbook-openstack-telemetry</a>
    <ul>
      <li><a href="#cookbook-openstack-telemetry-readme">cookbook-openstack-telemetry-README</a></li>
      <li><a href="#cookbook-openstack-telemetry-attributes-default">cookbook-openstack-telemetry-attributes-default</a></li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="cookbook-openstack-common">cookbook-openstack-common</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-common-readme">cookbook-openstack-common-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description">Description</h1>

<p>This cookbook provides common setup recipes, helper methods and attributes that
describe an OpenStack deployment as part of the OpenStack reference deployment
Chef for OpenStack.</p>

<p>Please relate to the official OpenStack Configuration Reference for a more detailed documentation on operating and administration of an OpenStack cluster:</p>

<p>http://docs.openstack.org/mitaka/config-reference/index.html</p>

<h1 id="requirements">Requirements</h1>

<ul>
  <li>Chef 12 or higher</li>
  <li>chefdk 0.9.0 for testing (also includes berkshelf for cookbook dependency
resolution)</li>
</ul>

<h1 id="platform">Platform</h1>

<ul>
  <li>ubuntu</li>
  <li>redhat</li>
  <li>centos</li>
</ul>

<h1 id="cookbooks">Cookbooks</h1>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>‘apt’, ‘~&gt; 2.8’</li>
  <li>‘database’, ‘~&gt; 4.0.2’</li>
  <li>‘mariadb’, ‘~&gt; 0.3.1’</li>
  <li>‘mysql’, ‘~&gt; 6.0.13’</li>
  <li>‘yum’, ‘~&gt; 3.5.4’</li>
  <li>‘yum-epel’, ‘~&gt; 0.6.0’</li>
  <li>‘galera’, ‘~&gt; 0.4.1’</li>
</ul>

<h1 id="attributes">Attributes</h1>

<p>Please see the extensive inline documentation in <code class="highlighter-rouge">attributes/*.rb</code> for
descriptions of all the settable attributes for this cookbook.</p>

<p>Note that all attributes are in the <code class="highlighter-rouge">default["openstack"]</code> “namespace”</p>

<h2 id="attributes-to-generate-openstack-service-configuration-files">Attributes to generate OpenStack service configuration files</h2>

<p>Since the mitaka release, we moved to a completely new way to generate all
OpenStack service configuration files. The base template is the
‘openstack-service.conf.erb’ included in the templates of this cookbook. In each
of the service cookbook (e.g. openstack-network, openstack-identity or
openstack-compute), the service configuration file (e.g neutron.conf,
keystone.conf or nova.conf) gets generated directly from attributes set inside of
the cookbook. To merge all the configuration options (including the secrets)
properly, before handing them over as ‘@service_config’ to the mentioned
template above, we use the methods defined in ‘libraries/config_helpers’.</p>

<p>For examples how to use these attributes, please refer to the attribute files
included in the service cookbooks (e.g. attributes/neutron_conf.rb in
openstack-network or attributes/keystone_conf.rb in openstack-identity). The
basic structure of all these attributes always follows this model:</p>

<div class="highlighter-rouge"><pre class="highlight"><code># usual config option that should evventually be saved to the node object
default['openstack'][service]['conf'][section][key][value]
# configuration options like passwords that should not be saved in the node
# object
default['openstack'][service]['conf_secrets'][section][key][value]
</code></pre>
</div>

<h1 id="recipes">Recipes</h1>

<h2 id="openstack-commonclient">openstack-common::client</h2>
<ul>
  <li>Install the common python openstack client package</li>
</ul>

<h2 id="openstack-commondefault">openstack-common::default</h2>
<ul>
  <li>Installs/Configures common recipes</li>
</ul>

<h2 id="openstack-commonlogging">openstack-common::logging</h2>
<ul>
  <li>Installs/Configures common logging</li>
</ul>

<h2 id="openstack-commonsysctl">openstack-common::sysctl</h2>
<ul>
  <li>Iterates over the contents of the <code class="highlighter-rouge">node['openstack']['sysctl']</code> hash and
writes the entries to <code class="highlighter-rouge">/etc/sysctl.d/60-openstack.conf</code>.</li>
</ul>

<h1 id="data-bags">Data Bags</h1>

<p>This cookbook contains Libraries to work with passwords and secrets in
databags. Databags can be unencrypted (for dev) or encrypted (for prod).
In addition to traditionally encrypted data bags they can also be created as
chef-vault items. To read more about chef-vault and how to use it, go to
https://docs.chef.io/chef_vault.html.</p>

<p>Documentation for Attributes for selecting databag format can be found in the
attributes section of this cookbook.</p>

<p>Documentation for format of these Databags can be found in the <a href="https://github.com/openstack/openstack-chef-repo#databags">Openstack Chef
Repo</a> repository.</p>

<h1 id="resources">Resources</h1>

<p>This cookbook provides the openstack_common_database LWRP, which replaces the
old database library function ‘db_create_with_user’.  When this cookbook is
included as dependency, this LWRP can be used to create databases needed by the
OpenStack services.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">depends</span> <span class="s1">'openstack-common'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">openstack_common_database</span> <span class="s1">'compute'</span> <span class="k">do</span>
  <span class="n">service</span> <span class="s1">'compute'</span> <span class="c1"># name_attribute</span>
  <span class="n">user</span> <span class="s1">'nova'</span>
  <span class="n">pass</span> <span class="s1">'supersecret'</span>
<span class="k">end</span>
</code></pre>
</div>

<p>An example of the usage can be seen here https://github.com/stackforge/cookbook-openstack-ops-database/blob/master/recipes/openstack-db.rb.</p>

<h1 id="libraries">Libraries</h1>

<p>This cookbook exposes a set of default library routines:</p>

<ul>
  <li><code class="highlighter-rouge">cli</code> – Used to call openstack CLIs</li>
  <li><code class="highlighter-rouge">endpoint</code> – Used to return a <code class="highlighter-rouge">::URI</code> object representing the named OpenStack
endpoint</li>
  <li><code class="highlighter-rouge">admin_endpoint</code> – Used to return a <code class="highlighter-rouge">::URI</code> object representing the named
OpenStack admin endpoint if one was specified. Otherwise, it will return the
same value as <code class="highlighter-rouge">endpoint</code>.</li>
  <li><code class="highlighter-rouge">internal_endpoint</code> – Used to return a <code class="highlighter-rouge">::URI</code> object representing the named
OpenStack internal endpoint if one was specified. Otherwise, it will return
the same value as <code class="highlighter-rouge">endpoint</code>.</li>
  <li><code class="highlighter-rouge">public_endpoint</code> – Used to return a <code class="highlighter-rouge">::URI</code> object representing the named
OpenStack public endpoint if one was specified. Otherwise, it will return the
same value as <code class="highlighter-rouge">endpoint</code>.</li>
  <li><code class="highlighter-rouge">endpoints</code> – Useful for operating on all OpenStack endpoints</li>
  <li><code class="highlighter-rouge">db</code> – Returns a Hash of information about a named OpenStack database</li>
  <li><code class="highlighter-rouge">db_uri</code> – Returns the SQLAlchemy RFC-1738 DB URI (see:
http://rfc.net/rfc1738.html) for a named OpenStack database</li>
  <li><code class="highlighter-rouge">secret</code> – Returns the value of an encrypted data bag for a named OpenStack
secret key and key-section</li>
  <li><code class="highlighter-rouge">get_password</code> – Ease-of-use helper that returns the decrypted password for a
named database, service or keystone user.</li>
  <li><code class="highlighter-rouge">matchers</code> – A custom matcher(render_config_file) for testing ini format file
section content by with_section_content.</li>
</ul>

<h1 id="examples">Examples</h1>

<p>The following are code examples showing the above library routines in action.
Remember when using the library routines exposed by this library to include
the Openstack routines in your recipe’s <code class="highlighter-rouge">::Chef::Recipe</code> namespace, like so:</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="o">::</span><span class="no">Chef</span><span class="o">::</span><span class="no">Recipe</span>
  <span class="kp">include</span> <span class="o">::</span><span class="no">Openstack</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Example of using the <code class="highlighter-rouge">endpoint</code> routine:</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">nova_api_ep</span> <span class="o">=</span> <span class="n">endpoint</span> <span class="s2">"compute-api"</span>
<span class="o">::</span><span class="no">Chef</span><span class="o">::</span><span class="no">Log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s2">"Using Openstack Compute API endpoint at </span><span class="si">#{</span><span class="n">nova_api_ep</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Note that endpoint URIs may contain variable interpolation markers such</span>
<span class="c1"># as `%(tenant_id)s`, so you may need to decode them. Do so like this:</span>

<span class="nb">require</span> <span class="s2">"uri"</span>

<span class="nb">puts</span> <span class="o">::</span><span class="no">URI</span><span class="p">.</span><span class="nf">decode</span> <span class="n">nova_api_ap</span><span class="p">.</span><span class="nf">to_s</span>
</code></pre>
</div>

<p>Example of using the <code class="highlighter-rouge">get_password</code> and <code class="highlighter-rouge">db_uri</code> routine:</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">db_pass</span> <span class="o">=</span> <span class="n">get_password</span> <span class="s2">"db"</span> <span class="s2">"cinder"</span>
<span class="n">db_user</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s2">"cinder"</span><span class="p">][</span><span class="s2">"db"</span><span class="p">][</span><span class="s2">"user"</span><span class="p">]</span>
<span class="n">sql_connection</span> <span class="o">=</span> <span class="n">db_uri</span> <span class="s2">"volume"</span><span class="p">,</span> <span class="n">db_user</span><span class="p">,</span> <span class="n">db_pass</span>

<span class="n">template</span> <span class="s2">"/etc/cinder/cinder.conf"</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">"cinder.conf.erb"</span>
  <span class="n">owner</span>  <span class="n">node</span><span class="p">[</span><span class="s2">"cinder"</span><span class="p">][</span><span class="s2">"user"</span><span class="p">]</span>
  <span class="n">group</span>  <span class="n">node</span><span class="p">[</span><span class="s2">"cinder"</span><span class="p">][</span><span class="s2">"group"</span><span class="p">]</span>
  <span class="n">mode</span>   <span class="mo">00644</span>
  <span class="n">variables</span><span class="p">(</span>
    <span class="s2">"sql_connection"</span> <span class="o">=&gt;</span> <span class="n">sql_connection</span>
  <span class="p">)</span>
<span class="k">end</span>
</code></pre>
</div>

<h2 id="uri-operations">URI Operations</h2>

<p>Use the <code class="highlighter-rouge">Openstack::uri_from_hash</code> routine to helpfully return a <code class="highlighter-rouge">::URI::Generic</code>
object for a hash that contains any of the following keys:</p>

<ul>
  <li><code class="highlighter-rouge">host</code></li>
  <li><code class="highlighter-rouge">uri</code></li>
  <li><code class="highlighter-rouge">port</code></li>
  <li><code class="highlighter-rouge">path</code></li>
  <li><code class="highlighter-rouge">scheme</code></li>
</ul>

<p>If the <code class="highlighter-rouge">uri</code> key is in the hash, that will be used as the URI, otherwise the URI
will be constructed from the various parts of the hash corresponding to the keys
above.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="c1"># Suppose node hash contains the following subhash in the :identity_service key:</span>
<span class="c1"># {</span>
<span class="c1">#   :host =&gt; 'identity.example.com',</span>
<span class="c1">#   :port =&gt; 5000,</span>
<span class="c1">#   :scheme =&gt; 'https'</span>
<span class="c1"># }</span>
<span class="n">uri</span> <span class="o">=</span> <span class="o">::</span><span class="no">Openstack</span><span class="o">::</span><span class="n">uri_from_hash</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="ss">:identity_service</span><span class="p">])</span>
<span class="c1"># uri.to_s would == "https://identity.example.com:5000"</span>
</code></pre>
</div>

<p>The routine will return nil if neither a <code class="highlighter-rouge">uri</code> or <code class="highlighter-rouge">host</code> key exists in the
supplied hash.</p>

<h2 id="using-the-library-without-prefixing-with-openstack">Using the library without prefixing with ::Openstack</h2>

<p>Don’t like prefixing calls to the library’s routines with <code class="highlighter-rouge">::Openstack</code>? Do this:</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="o">::</span><span class="no">Chef</span><span class="o">::</span><span class="no">Recipe</span>
  <span class="kp">include</span> <span class="o">::</span><span class="no">Openstack</span>
<span class="k">end</span>
</code></pre>
</div>

<p>in your recipe.</p>

<hr />

<h3 id="cookbook-openstack-common-attributes-database">cookbook-openstack-common-attributes-database</h3>

<p><a href="#contents">back to top</a></p>

<p>======================== OpenStack DB Support ================================</p>

<p>This section of node attributes stores information about the database hosts
used in an OpenStack deployment.</p>

<p>There is no ‘scheme’ key. Instead, there is a ‘service_type’ key that should
contain one of ‘sqlite’, ‘mysql’, or ‘postgresql’</p>

<p>The ::Openstack::db(SERVICE_NAME) library routine allows a lookup from any recipe
to this array, returning the host information for the server that contains
the database for SERVICE_NAME, where SERVICE_NAME is one of ‘compute’ (Nova),
‘image’ (Glance), ‘identity’ (Keystone), ‘network’ (Neutron), or ‘volume’ (Cinder)</p>

<p>The ::Openstack::db_connection(SERVICE_NAME, USER, PASSWORD) library routine
returns the SQLAlchemy DB URI for SERVICE_NAME, with the supplied user and password
that a calling service might be using when connecting to the database.</p>

<p>For example, let’s assume that the database that is used by the OpenStack Identity
service (Keystone) is configured as follows:</p>

<p>host: 192.168.0.3
port: 3306
service_type: mysql
db_name: keystone</p>

<p>Further suppose that a node running the OpenStack Identity API service needs to
connect to the above identity database server. It has the following in it’s node
attributes:</p>

<p>node[‘openstack’][‘db’][‘identity’][‘username’] = ‘keystone’</p>

<p>In a ‘keystone’ recipe, you might find the following code:</p>

<p>user = node[‘openstack’][‘db’][‘identity’][‘username’]
pass = get_password ‘db’, ‘keystone’</p>

<p>sql_connection = ::Openstack::db_uri(‘identity’, user, pass)</p>

<p>The sql_connection variable would then be set to “mysql://keystone:password@192.168.0.3:keystone”
and could then be written to the keystone.conf file in a template.</p>

<p>Database Migrations:</p>

<p>node[‘openstack’][‘db’][SERVICE_NAME][‘migrate’]</p>

<p>The above attribute causes database migrations to be executed for the given
service.  There are cases where migrations should not be executed.  For
example when upgrading a zone, and the image or identity database are replicated
across many zones.</p>

<p><strong>**</strong><strong>**</strong><strong>**</strong>** Database Endpoint <strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong>**</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="sx">%w(endpoints bind_service)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">type</span><span class="o">|</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'3306'</span>
<span class="k">end</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'interface'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'enabled_slave'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'slave_host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'slave_port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'3316'</span>
</code></pre>
</div>

<p>If you bind the database to a specific ip-address (you can only choose one
here for mysql, so 127.0.0.1 + external address is not an option), to allow
the services and applications to access it via this one, you probably do not
want to allow the db root user to access it via this external address. In this
case you have the option to allow root access only via localhost, which
will work for mysql databases, since it will use a direct connection via
the socket, so the database does not have not to listen on 127.0.0.1.
Set this to ‘localhost’ for mysql to connect via socket.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'host_for_db_root_user'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Default database attributes</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'server_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-ops-database'</span>
<span class="c1"># Database charset during create database</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'charset'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">mysql: </span><span class="s1">'utf8'</span><span class="p">,</span>
  <span class="s1">'percona-cluster'</span> <span class="o">=&gt;</span> <span class="s1">'utf8'</span><span class="p">,</span>
  <span class="ss">mariadb: </span><span class="s1">'utf8'</span><span class="p">,</span>
  <span class="ss">postgresql: </span><span class="kp">nil</span><span class="p">,</span>
  <span class="ss">pgsql: </span><span class="kp">nil</span><span class="p">,</span>
  <span class="ss">sqlite: </span><span class="kp">nil</span><span class="p">,</span>
  <span class="ss">nosql: </span><span class="kp">nil</span><span class="p">,</span>
  <span class="ss">galera: </span><span class="s1">'utf8'</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Database connection options. Should include starting ‘?’</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'options'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">mysql: </span><span class="s2">"?charset=</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'charset'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
  <span class="s1">'percona-cluster'</span> <span class="o">=&gt;</span> <span class="s2">"?charset=</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'charset'</span><span class="p">][</span><span class="s1">'percona-cluster'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
  <span class="ss">mariadb: </span><span class="s2">"?charset=</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'charset'</span><span class="p">][</span><span class="s1">'mariadb'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
  <span class="ss">postgresql: </span><span class="s1">''</span><span class="p">,</span>
  <span class="ss">sqlite: </span><span class="s1">''</span><span class="p">,</span>
  <span class="ss">nosql: </span><span class="s1">''</span><span class="p">,</span>
  <span class="ss">galera: </span><span class="s2">"?charset=</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'charset'</span><span class="p">][</span><span class="s1">'galera'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span>
<span class="p">}</span>
</code></pre>
</div>

<p>platform and DBMS-specific python client packages</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'python_packages'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">postgresql: </span><span class="p">[</span><span class="s1">'python-psycopg2'</span><span class="p">],</span>
  <span class="ss">sqlite: </span><span class="p">[]</span>
<span class="p">}</span>
<span class="k">case</span> <span class="n">node</span><span class="p">[</span><span class="s1">'platform_family'</span><span class="p">]</span>
<span class="k">when</span> <span class="s1">'rhel'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'mariadb'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'python_packages'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'MySQL-python'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'python_packages'</span><span class="p">][</span><span class="s1">'mariadb'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'MySQL-python'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'python_packages'</span><span class="p">][</span><span class="s1">'percona-cluster'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'MySQL-python'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'python_packages'</span><span class="p">][</span><span class="s1">'galera'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'MySQL-python'</span><span class="p">]</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'mysql'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'python_packages'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'python-mysqldb'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'python_packages'</span><span class="p">][</span><span class="s1">'mariadb'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'python-mysqldb'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'python_packages'</span><span class="p">][</span><span class="s1">'percona-cluster'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'python-mysqldb'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'python_packages'</span><span class="p">][</span><span class="s1">'galera'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'python-mysqldb'</span><span class="p">]</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Database used by the OpenStack services</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'common'</span><span class="p">][</span><span class="s1">'services'</span><span class="p">].</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">service</span><span class="p">,</span> <span class="n">project</span><span class="o">|</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'db_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">project</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="n">project</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'options'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'options'</span><span class="p">]</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'slave_host'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'slave_host'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'slave_port'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'slave_port'</span><span class="p">]</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="k">case</span> <span class="n">service</span>
  <span class="k">when</span> <span class="s1">'dashboard'</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'migrate'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
  <span class="k">when</span> <span class="s1">'identity'</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'migrate'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
  <span class="k">when</span> <span class="s1">'image'</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'migrate'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
  <span class="k">when</span> <span class="s1">'network'</span>
    <span class="c1"># The SQLAlchemy connection string used to connect to the slave database</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'slave_connection'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">''</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>    <span class="c1"># Database reconnection retry times - in event connectivity is lost</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'max_retries'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>    <span class="c1"># Database reconnection interval in seconds - if the initial connection to the database fails</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'retry_interval'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>    <span class="c1"># Minimum number of SQL connections to keep open in a pool</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'min_pool_size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>    <span class="c1"># Maximum number of SQL connections to keep open in a pool</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'max_pool_size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>    <span class="c1"># Timeout in seconds before idle sql connections are reaped</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'idle_timeout'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3600</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>    <span class="c1"># If set, use this value for max_overflow with sqlalchemy</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'max_overflow'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>    <span class="c1"># Verbosity of SQL debugging information. 0=None, 100=Everything</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'connection_debug'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>    <span class="c1"># Add python stack traces to SQL as comment strings</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'connection_trace'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>    <span class="c1"># If set, use this value for pool_timeout with sqlalchemy</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'pool_timeout'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
  <span class="k">when</span> <span class="s1">'telemetry'</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'nosql'</span><span class="p">][</span><span class="s1">'used'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'nosql'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'27017'</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>DB key to the get_password library routine</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'root_user_key'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'mysqlroot'</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-common-attributes-default">cookbook-openstack-common-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'common'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
'</span>
</code></pre>
</div>

<p>OpenStack services and their project names</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'common'</span><span class="p">][</span><span class="s1">'services'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'bare-metal'</span> <span class="o">=&gt;</span> <span class="s1">'ironic'</span><span class="p">,</span>
  <span class="s1">'block-storage'</span> <span class="o">=&gt;</span> <span class="s1">'cinder'</span><span class="p">,</span>
  <span class="s1">'compute'</span> <span class="o">=&gt;</span> <span class="s1">'nova'</span><span class="p">,</span>
  <span class="s1">'compute_api'</span> <span class="o">=&gt;</span> <span class="s1">'nova_api'</span><span class="p">,</span>
  <span class="s1">'dashboard'</span> <span class="o">=&gt;</span> <span class="s1">'horizon'</span><span class="p">,</span>
  <span class="s1">'database'</span> <span class="o">=&gt;</span> <span class="s1">'trove'</span><span class="p">,</span>
  <span class="s1">'identity'</span> <span class="o">=&gt;</span> <span class="s1">'keystone'</span><span class="p">,</span>
  <span class="s1">'image'</span> <span class="o">=&gt;</span> <span class="s1">'glance'</span><span class="p">,</span>
  <span class="s1">'network'</span> <span class="o">=&gt;</span> <span class="s1">'neutron'</span><span class="p">,</span>
  <span class="s1">'object-storage'</span> <span class="o">=&gt;</span> <span class="s1">'swift'</span><span class="p">,</span>
  <span class="s1">'orchestration'</span> <span class="o">=&gt;</span> <span class="s1">'heat'</span><span class="p">,</span>
  <span class="s1">'telemetry'</span> <span class="o">=&gt;</span> <span class="s1">'ceilometer'</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Setting this to True means that database passwords and service user
passwords for Keystone will be easy-to-remember values – they will be
the same value as the key. For instance, if a cookbook calls the
::Openstack::secret routine like so:</p>

<p>pass = secret “passwords”, “nova”</p>

<p>The value of pass will be “nova”</p>

<p>Use data bags for storing passwords
Set this to false in order to get the passwords from attributes like:
node[‘openstack’][‘secret’][key][type]</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'use_databags'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<p>Set databag type
acceptable values ‘encrypted’, ‘standard’, ‘vault’
Set this to ‘standard’ in order to use regular databags.
this is not recommended for anything other than dev/CI
type environments.  Storing real secrets in plaintext = craycray.
In addition to the encrypted data_bags which are an included
feature of the official chef project, you can use ‘vault’ to
encrypt your secrets with the method provided in the chef-vault gem.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'databag_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'encrypted'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'vault_gem_version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'~&gt; 2.3'</span>
</code></pre>
</div>

<p>Default attributes when not using data bags (use_databags = false)</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'common'</span><span class="p">][</span><span class="s1">'services'</span><span class="p">].</span><span class="nf">each_key</span> <span class="k">do</span> <span class="o">|</span><span class="n">service</span><span class="o">|</span>
  <span class="sx">%w(user service db token)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">type</span><span class="o">|</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'secret'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="n">type</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">service</span><span class="si">}</span><span class="s2">-</span><span class="si">#{</span><span class="n">type</span><span class="si">}</span><span class="s2">"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>The type of token signing to use (uuid or pki)</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'strategy'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'pki'</span>
</code></pre>
</div>

<p>Set to true where using self-signed certs (in testing environments)</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'validate_certs'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<p>========================= Encrypted Databag Setup ===========================</p>

<p>The openstack-common cookbook’s default library contains a <code class="highlighter-rouge">secret</code>
routine that looks up the value of encrypted databag values. This routine
uses the secret key file located at the following location to decrypt the
values in the data bag.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'secret'</span><span class="p">][</span><span class="s1">'key_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/chef/openstack_data_bag_secret'</span>
</code></pre>
</div>

<p>The name of the encrypted data bag that stores openstack secrets</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'secret'</span><span class="p">][</span><span class="s1">'secrets_data_bag'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'secrets'</span>
</code></pre>
</div>

<p>The name of the encrypted data bag that stores service user passwords, with
each key in the data bag corresponding to a named OpenStack service, like
“nova”, “cinder”, etc.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'secret'</span><span class="p">][</span><span class="s1">'service_passwords_data_bag'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service_passwords'</span>
</code></pre>
</div>

<p>The name of the encrypted data bag that stores DB passwords, with
each key in the data bag corresponding to a named OpenStack database, like
“nova”, “cinder”, etc.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'secret'</span><span class="p">][</span><span class="s1">'db_passwords_data_bag'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'db_passwords'</span>
</code></pre>
</div>

<p>The name of the encrypted data bag that stores Keystone user passwords, with
each key in the data bag corresponding to a user (Keystone or otherwise).</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'secret'</span><span class="p">][</span><span class="s1">'user_passwords_data_bag'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'user_passwords'</span>
</code></pre>
</div>

<p>========================= Package and Repository Setup ======================</p>

<p>Various Linux distributions provide OpenStack packages and repositories.
The provide some sensible defaults, but feel free to override per your
needs.
The coordinated release of OpenStack codename</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'release'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'mitaka'</span>
</code></pre>
</div>

<p>The Ubuntu Cloud Archive has packages for multiple Ubuntu releases. For
more information, see: https://wiki.ubuntu.com/ServerTeam/CloudArchive.
In the component strings, %codename% will be replaced by the value of
the node[‘lsb’][‘codename’] Ohai value and %release% will be replaced
by the value of node[‘openstack’][‘release’]</p>

<p>Change [‘openstack’][‘apt’][‘update_apt_cache’] to true if you would like
have the cache automaticly updated</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'apt'</span><span class="p">][</span><span class="s1">'update_apt_cache'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'apt'</span><span class="p">][</span><span class="s1">'live_updates_enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'apt'</span><span class="p">][</span><span class="s1">'uri'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http://ubuntu-cloud.archive.canonical.com/ubuntu'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'apt'</span><span class="p">][</span><span class="s1">'components'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'main'</span><span class="p">]</span>
<span class="c1"># For the SRU packaging, use this:</span>
<span class="c1"># default['openstack']['apt']['components'] = [ '%codename%-proposed/%release%', 'main' ]</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'yum'</span><span class="p">][</span><span class="s1">'rdo_enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'yum'</span><span class="p">][</span><span class="s1">'uri'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"http://mirror.centos.org/centos/$releasever/cloud/$basearch/openstack-</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'release'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'yum'</span><span class="p">][</span><span class="s1">'repo-key'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'https://raw.githubusercontent.com/redhat-openstack/rdo-release/master/RPM-GPG-KEY-CentOS-SIG-Cloud'</span>
<span class="c1"># Enforcing GnuPG signature check for RDO repo. Set this to false if you want to disable the check.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'yum'</span><span class="p">][</span><span class="s1">'gpgcheck'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'family'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'inet'</span>
</code></pre>
</div>

<p>Set a default region that other regions are set to - such that changing the region for all services can be done in one place</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'RegionOne'</span>
</code></pre>
</div>

<p>Set a default auth api version that other components use to interact with identity service.
Allowed auth API versions: v2.0 or v3.0. By default, it is set to v2.0.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2.0'</span>
</code></pre>
</div>

<p>Allow configured loggers in logging.conf</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'logging'</span><span class="p">][</span><span class="s1">'loggers'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'root'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'NOTSET'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'devel'</span>
  <span class="p">},</span>
  <span class="s1">'ceilometer'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'DEBUG'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'ceilometer'</span>
  <span class="p">},</span>
  <span class="s1">'cinder'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'DEBUG'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'cinder'</span>
  <span class="p">},</span>
  <span class="s1">'glance'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'DEBUG'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'glance'</span>
  <span class="p">},</span>
  <span class="s1">'horizon'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'DEBUG'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'horizon'</span>
  <span class="p">},</span>
  <span class="s1">'keystone'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'DEBUG'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'keystone'</span>
  <span class="p">},</span>
  <span class="s1">'nova'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'DEBUG'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'nova'</span>
  <span class="p">},</span>
  <span class="s1">'neutron'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'DEBUG'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'neutron'</span>
  <span class="p">},</span>
  <span class="s1">'trove'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'DEBUG'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'trove'</span>
  <span class="p">},</span>
  <span class="s1">'amqplib'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'WARNING'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'stderr'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'amqplib'</span>
  <span class="p">},</span>
  <span class="s1">'sqlalchemy'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'WARNING'</span><span class="p">,</span>
    <span class="c1"># "level' =&gt; 'INFO" logs SQL queries.</span>
    <span class="c1"># "level' =&gt; 'DEBUG" logs SQL queries and results.</span>
    <span class="c1"># "level' =&gt; 'WARNING" logs neither.  (Recommended for production systems.)</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'stderr'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'sqlalchemy'</span>
  <span class="p">},</span>
  <span class="s1">'boto'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'WARNING'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'stderr'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'boto'</span>
  <span class="p">},</span>
  <span class="s1">'suds'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'INFO'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'stderr'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'suds'</span>
  <span class="p">},</span>
  <span class="s1">'eventletwsgi'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'WARNING'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'stderr'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'eventlet.wsgi.server'</span>
  <span class="p">},</span>
  <span class="s1">'nova_api_openstack_wsgi'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'WARNING'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'nova.api.openstack.wsgi'</span>
  <span class="p">},</span>
  <span class="s1">'nova_osapi_compute_wsgi_server'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'WARNING'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'nova.osapi_compute.wsgi.server'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Allow configured formatters in logging.conf</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'logging'</span><span class="p">][</span><span class="s1">'formatters'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'normal'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'format'</span> <span class="o">=&gt;</span> <span class="s1">'%(asctime)s %(levelname)s %(message)s'</span>
  <span class="p">},</span>
  <span class="s1">'normal_with_name'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'format'</span> <span class="o">=&gt;</span> <span class="s1">'[%(name)s]: %(asctime)s %(levelname)s %(message)s'</span>
  <span class="p">},</span>
  <span class="s1">'debug'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'format'</span> <span class="o">=&gt;</span> <span class="s1">'[%(name)s]: %(asctime)s %(levelname)s %(module)s.%(funcName)s %(message)s'</span>
  <span class="p">},</span>
  <span class="s1">'syslog_with_name'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'format'</span> <span class="o">=&gt;</span> <span class="s1">'%(name)s: %(levelname)s %(message)s'</span>
  <span class="p">},</span>
  <span class="s1">'syslog_debug'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'format'</span> <span class="o">=&gt;</span> <span class="s1">'%(name)s: %(levelname)s %(module)s.%(funcName)s %(message)s'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Allow configured logging handlers in logging.conf</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'logging'</span><span class="p">][</span><span class="s1">'handlers'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'stderr'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'args'</span> <span class="o">=&gt;</span> <span class="s1">'(sys.stderr,)'</span><span class="p">,</span>
    <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="s1">'StreamHandler'</span><span class="p">,</span>
    <span class="s1">'formatter'</span> <span class="o">=&gt;</span> <span class="s1">'debug'</span>
  <span class="p">},</span>
  <span class="s1">'devel'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'args'</span> <span class="o">=&gt;</span> <span class="s1">'(sys.stdout,)'</span><span class="p">,</span>
    <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="s1">'StreamHandler'</span><span class="p">,</span>
    <span class="s1">'formatter'</span> <span class="o">=&gt;</span> <span class="s1">'debug'</span><span class="p">,</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'NOTSET'</span>
  <span class="p">},</span>
  <span class="s1">'prod'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'args'</span> <span class="o">=&gt;</span> <span class="s1">'((\'/dev/log\'), handlers.SysLogHandler.LOG_LOCAL0)'</span><span class="p">,</span>
    <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="s1">'handlers.SysLogHandler'</span><span class="p">,</span>
    <span class="s1">'formatter'</span> <span class="o">=&gt;</span> <span class="s1">'syslog_with_name'</span><span class="p">,</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'INFO'</span>
  <span class="p">},</span>
  <span class="s1">'debug'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'args'</span> <span class="o">=&gt;</span> <span class="s1">'((\'/dev/log\'), handlers.SysLogHandler.LOG_LOCAL1)'</span><span class="p">,</span>
    <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="s1">'handlers.SysLogHandler'</span><span class="p">,</span>
    <span class="s1">'formatter'</span> <span class="o">=&gt;</span> <span class="s1">'syslog_debug'</span><span class="p">,</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'DEBUG'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'memcached_servers'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Default sysctl settings</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'sysctl'</span><span class="p">][</span><span class="s1">'net.ipv4.conf.all.rp_filter'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'sysctl'</span><span class="p">][</span><span class="s1">'net.ipv4.conf.default.rp_filter'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">node</span><span class="p">[</span><span class="s1">'platform_family'</span><span class="p">]</span>
<span class="k">when</span> <span class="s1">'rhel'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'common'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'common_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-openstackclient'</span><span class="p">],</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'common'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'common_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-openstackclient'</span><span class="p">],</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s2">"-o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef'"</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<p>The name of the Chef role that installs the Keystone Service API</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity_service_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-identity'</span>
</code></pre>
</div>

<p>The name of the Chef role that sets up the compute worker</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute_worker_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-compute-worker'</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-common-attributes-messaging">cookbook-openstack-common-attributes-messaging</h3>

<p><a href="#contents">back to top</a></p>

<p><strong>**</strong><strong>**</strong><strong>**</strong>** RabbitMQ Endpoint <strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong>**</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="sx">%w(endpoints bind_service)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">type</span><span class="o">|</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'5672'</span>
<span class="k">end</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'interface'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'5672'</span>
</code></pre>
</div>

<p>Services to assign mq attributes for</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">services</span> <span class="o">=</span> <span class="sx">%w(bare-metal block-storage compute database image
              identity telemetry network orchestration)</span>
</code></pre>
</div>

<p>Generic default attributes</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'server_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-ops-messaging'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'rabbit'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'guest'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'vhost'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/'</span>
</code></pre>
</div>

<p>defined in oslo/messaging/_drivers/amqp.py</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'durable_queues'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'auto_delete'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>Default rabbit values (for attribute assignment below)</p>

<p>global switch for handling rabbit ssl</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'use_ssl'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># SSL version to use (valid only if SSL enabled)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_ssl_version'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="c1"># SSL key file (valid only if SSL enabled)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_ssl_keyfile'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="c1"># SSL cert file (valid only if SSL enabled)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_ssl_certfile'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="c1"># SSL certification authority file (valid only if SSL enabled)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_ssl_ca_certs'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="c1"># How long to wait before reconnecting in response to an AMQP consumer cancel notification</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_reconnect_delay'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span>
<span class="c1"># How long to wait before considering a reconnect attempt to have failed.</span>
<span class="c1"># This value should not be longer than rpc_response_timeout</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_reconnect_timeout'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">60</span>
<span class="c1"># global switch for handling rabbit ha</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'ha'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># global switch for number of seconds after which the Rabbit broker is considered down if heartbeat's keep-alive fails (0 disable the heartbeat)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'heartbeat_timeout_threshold'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># global switch for how often times during the heartbeat_timeout_threshold we check the heartbeat</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'heartbeat_rate'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">rabbit_defaults</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">rabbit_max_retries: </span><span class="mi">0</span><span class="p">,</span>
  <span class="ss">rabbit_retry_interval: </span><span class="mi">1</span><span class="p">,</span>
  <span class="ss">userid: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">],</span>
  <span class="ss">vhost: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'vhost'</span><span class="p">],</span>
  <span class="ss">port: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">],</span>
  <span class="ss">host: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">],</span>
  <span class="ss">ha: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'ha'</span><span class="p">],</span>
  <span class="ss">heartbeat_timeout_threshold: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'heartbeat_timeout_threshold'</span><span class="p">],</span>
  <span class="ss">heartbeat_rate: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'heartbeat_rate'</span><span class="p">],</span>
  <span class="ss">use_ssl: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'use_ssl'</span><span class="p">],</span>
  <span class="ss">kombu_ssl_version: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_ssl_version'</span><span class="p">],</span>
  <span class="ss">kombu_ssl_keyfile: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_ssl_keyfile'</span><span class="p">],</span>
  <span class="ss">kombu_ssl_certfile: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_ssl_certfile'</span><span class="p">],</span>
  <span class="ss">kombu_ssl_ca_certs: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_ssl_ca_certs'</span><span class="p">],</span>
  <span class="ss">kombu_reconnect_delay: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_reconnect_delay'</span><span class="p">],</span>
  <span class="ss">kombu_reconnect_timeout: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_reconnect_timeout'</span><span class="p">]</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Assign default mq attributes for every service</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">services</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">svc</span><span class="o">|</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="n">svc</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="n">svc</span><span class="p">][</span><span class="s1">'notification_topic'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'notifications'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="n">svc</span><span class="p">][</span><span class="s1">'durable_queues'</span><span class="p">]</span> <span class="o">=</span>
    <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'durable_queues'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="n">svc</span><span class="p">][</span><span class="s1">'auto_delete'</span><span class="p">]</span> <span class="o">=</span>
    <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'auto_delete'</span><span class="p">]</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="n">rabbit_defaults</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="o">|</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="n">svc</span><span class="p">][</span><span class="s1">'rabbit'</span><span class="p">][</span><span class="n">key</span><span class="p">.</span><span class="nf">to_s</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Overrides and additional attributes for individual services</p>

<p>bare-metal</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rabbit'</span><span class="p">][</span><span class="s1">'notification_topic'</span><span class="p">]</span> <span class="o">=</span>
  <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'notification_topic'</span><span class="p">]</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ironic'</span>
</code></pre>
</div>

<p>block-storage</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'rabbit'</span><span class="p">][</span><span class="s1">'notification_topic'</span><span class="p">]</span> <span class="o">=</span>
  <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'notification_topic'</span><span class="p">]</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder'</span>
</code></pre>
</div>

<p>image</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'notifier_strategy'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'noop'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'notification_topic'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'glance_notifications'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'rabbit'</span><span class="p">][</span><span class="s1">'notification_topic'</span><span class="p">]</span> <span class="o">=</span>
  <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'notification_topic'</span><span class="p">]</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'glance'</span>
</code></pre>
</div>

<p>identity
AMQP topics used for openstack notifications, can be comma-separated values</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'notification_topics'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'notifications'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'identity'</span>
</code></pre>
</div>

<p>network
AMQP topics used for openstack notifications, can be comma-separated values</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'notification_topics'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'notifications'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron'</span>
</code></pre>
</div>

<p>compute</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nova'</span>
</code></pre>
</div>

<p>orchestration</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'heat'</span>
</code></pre>
</div>

<p>telemetry</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ceilometer'</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-bare-metal">cookbook-openstack-bare-metal</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-bare-metal-readme">cookbook-openstack-bare-metal-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="cookbook-openstack-bare-metal-cookbook">cookbook-openstack-bare-metal Cookbook</h1>

<p>This cookbook installs the OpenStack Bare Metal service <strong>Ironic</strong> as part of
the OpenStack reference deployment Chef for OpenStack. Ironic is currently
installed from packages.</p>

<p>https://wiki.openstack.org/wiki/Ironic</p>

<h2 id="requirements-1">Requirements</h2>

<p>Chef 12 or higher required (for Chef environment use).</p>

<h2 id="attributes-1">Attributes</h2>

<p>Please see the extensive inline documentation in <code class="highlighter-rouge">attributes/*.rb</code> for descriptions
of all the settable attributes for this cookbook.</p>

<p>There are also many common attributes shared across the cookbooks that are found in
the cookbook-openstack-common cookbook attribute files.</p>

<p>Note that all attributes are in the <code class="highlighter-rouge">default["openstack"]</code> “namespace”</p>

<h2 id="usage">Usage</h2>
<p>#### cookbook-openstack-bare-metal::default
TODO: Write usage instructions for each cookbook.</p>

<hr />

<h3 id="cookbook-openstack-bare-metal-attributes-default">cookbook-openstack-bare-metal-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
"</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'verbose'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'false'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'debug'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'false'</span>
</code></pre>
</div>

<p>Maximum number of worker threads that can be started
simultaneously by a periodic task. Should be less than RPC
thread pool size. (integer value)</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'conductor'</span><span class="p">][</span><span class="s1">'periodic_max_workers'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
</code></pre>
</div>

<p>The size of the workers greenthread pool. (integer value)</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'conductor'</span><span class="p">][</span><span class="s1">'workers_pool_size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
</code></pre>
</div>

<p>Common rpc definitions</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rpc_thread_pool_size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rpc_conn_pool_size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rpc_response_timeout'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">60</span>
</code></pre>
</div>

<p>The name of the Chef role that knows about the message queue server
that Ironic uses</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rabbit_server_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-ops-messaging'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span>
<span class="k">when</span> <span class="s1">'rabbitmq'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rpc_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'rabbit'</span>
<span class="k">when</span> <span class="s1">'qpid'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rpc_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'qpid'</span>
<span class="k">end</span>
</code></pre>
</div>

<p>The AMQP exchange to connect to if using RabbitMQ or Qpid</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span>  <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span>
</code></pre>
</div>

<p>Logging stuff</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'log_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/ironic'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'LOG_LOCAL1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'config_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'local1'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
</code></pre>
</div>

<p>Keystone settings</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth_strategy'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span>
</code></pre>
</div>

<p>Whether to allow the client to perform insecure SSL (https) requests</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'insecure'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>Keystone PKI signing directories</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'cache_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/ironic/api'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'service_tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'service_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ironic'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'service_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ironic'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ironic'</span>
</code></pre>
</div>

<p>Setup the tftp variables</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'tftp'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># IP address of Ironic compute node's tftp server</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'tftp'</span><span class="p">][</span><span class="s1">'server'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="c1"># Ironic compute node's tftp root path</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'tftp'</span><span class="p">][</span><span class="s1">'root_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/lib/tftpboot'</span>
<span class="c1"># Directory where master tftp images are stored on disk</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'tftp'</span><span class="p">][</span><span class="s1">'master_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'tftp'</span><span class="p">][</span><span class="s1">'root_path'</span><span class="p">]</span><span class="si">}</span><span class="s2">/master_images"</span>
</code></pre>
</div>

<p>rootwrap.conf</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'filters_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/ironic/rootwrap.d,/usr/share/ironic/rootwrap'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'exec_dirs'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/sbin,/usr/sbin,/bin,/usr/bin'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'use_syslog'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'syslog_log_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'syslog'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'syslog_log_level'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ERROR'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform_family</span>
<span class="k">when</span> <span class="s1">'fedora'</span><span class="p">,</span> <span class="s1">'rhel'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'ironic_api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ironic-api'</span><span class="p">],</span>
    <span class="s1">'ironic_api_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ironic-api'</span><span class="p">,</span>
    <span class="s1">'ironic_conductor_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ironic-conductor'</span><span class="p">,</span> <span class="s1">'shellinabox'</span><span class="p">,</span> <span class="s1">'ipmitool'</span><span class="p">],</span>
    <span class="s1">'ironic_conductor_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ironic-conductor'</span><span class="p">,</span>
    <span class="s1">'ironic_common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ironic-common'</span><span class="p">,</span> <span class="s1">'python-ironicclient'</span><span class="p">]</span>
  <span class="p">}</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'ironic_api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ironic-api'</span><span class="p">],</span>
    <span class="s1">'ironic_api_service'</span> <span class="o">=&gt;</span> <span class="s1">'ironic-api'</span><span class="p">,</span>
    <span class="s1">'ironic_conductor_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ironic-conductor'</span><span class="p">,</span> <span class="s1">'shellinabox'</span><span class="p">,</span> <span class="s1">'ipmitool'</span><span class="p">],</span>
    <span class="s1">'ironic_conductor_service'</span> <span class="o">=&gt;</span> <span class="s1">'ironic-conductor'</span><span class="p">,</span>
    <span class="s1">'ironic_common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-ironicclient'</span><span class="p">,</span> <span class="s1">'ironic-common'</span><span class="p">]</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-block-storage">cookbook-openstack-block-storage</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-block-storage-readme">cookbook-openstack-block-storage-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-1">Description</h1>

<p>Installs the OpenStack Block Storage service <strong>Cinder</strong> as part of the OpenStack
reference deployment Chef for OpenStack. The
https://github.com/openstack/openstack-chef-repo contains documentation for
using this cookbook in the context of a full OpenStack deployment. Cinder is
currently installed from packages.</p>

<p>http://cinder.openstack.org</p>

<h1 id="requirements-2">Requirements</h1>

<ul>
  <li>Chef 12 or higher</li>
  <li>chefdk 0.9.0 for testing (also includes berkshelf for cookbook dependency
resolution)</li>
</ul>

<h1 id="platform-1">Platform</h1>

<ul>
  <li>ubuntu</li>
  <li>redhat</li>
  <li>centos</li>
</ul>

<h1 id="cookbooks-1">Cookbooks</h1>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>‘apt’, ‘~&gt; 2.8’</li>
  <li>‘openstack-common’, ‘&gt;= 13.0.0’</li>
  <li>‘openstack-identity’, ‘&gt;= 13.0.0’</li>
  <li>‘openstack-image’, ‘&gt;= 13.0.0’</li>
</ul>

<h1 id="attributes-2">Attributes</h1>

<p>Please see the extensive inline documentation in <code class="highlighter-rouge">attributes/*.rb</code> for
descriptions of all the settable attributes for this cookbook.</p>

<p>Note that all attributes are in the <code class="highlighter-rouge">default['openstack']</code> “namespace”</p>

<p>The usage of attributes to generate the cinder.conf is decribed in the
openstack-common cookbook.</p>

<h1 id="recipes-1">Recipes</h1>

<h2 id="openstack-block-storageapi">openstack-block-storage::api</h2>
<ul>
  <li>Installs the cinder-api and sets up the cinder database</li>
</ul>

<h2 id="openstack-block-storagebackup">openstack-block-storage::backup</h2>
<ul>
  <li>Installs the cinder-backup service</li>
</ul>

<h2 id="openstack-block-storagecinder-common">openstack-block-storage::cinder-common</h2>
<ul>
  <li>Defines the common pieces of repeated code from the other recipes</li>
</ul>

<h2 id="openstack-block-storageclient">openstack-block-storage::client</h2>
<ul>
  <li>Install the cinder client packages</li>
</ul>

<h2 id="openstack-block-storageidentityregistration">openstack-block-storage::identity_registration</h2>
<ul>
  <li>Defines the cinder service/user/endpoints in keystone</li>
</ul>

<h2 id="openstack-block-storagescheduler">openstack-block-storage::scheduler</h2>
<ul>
  <li>Installs the cinder-scheduler service</li>
</ul>

<h2 id="openstack-block-storagevolume">openstack-block-storage::volume</h2>
<ul>
  <li>Installs the cinder-volume service</li>
</ul>

<h2 id="openstack-block-storagevolumedriverlvm">openstack-block-storage::volume_driver_lvm</h2>
<ul>
  <li>Configures lvm as the cinder storage backend</li>
</ul>

<hr />

<h3 id="cookbook-openstack-block-storage-attributes-cinderconf">cookbook-openstack-block-storage-attributes-cinder_conf</h3>

<p><a href="#contents">back to top</a></p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'conf_secrets'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'oslo_messaging_notifications'</span><span class="p">][</span><span class="s1">'driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder.openstack.common.notifier.rpc_notifier'</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_config'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack/logging.conf'</span>
  <span class="k">end</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'rpc_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'auth_strategy'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'volume_group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder-volumes'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'state_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/lib/cinder'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'auth_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'region_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'signing_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/cinder/api'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'oslo_concurrency'</span><span class="p">][</span><span class="s1">'lock_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/lib/cinder/tmp'</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-block-storage-attributes-default">cookbook-openstack-block-storage-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Toggles - These can be overridden at the environment level</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'developer_mode'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span> <span class="c1"># we want secure passwords by default</span>
<span class="c1">########################################################################</span>
</code></pre>
</div>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
'</span>
</code></pre>
</div>

<p>Specify policy.json remote file to import</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'policyfile_url'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Availability zone/region for the OpenStack Block-Storage service</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'scheduler_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-block-storage-scheduler'</span>
</code></pre>
</div>

<p>The name of the Chef role that knows about the message queue server
that Cinder uses</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'rabbit_server_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-ops-messaging'</span>
</code></pre>
</div>

<p>This is the name of the Chef role that will install the Keystone Service API</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'keystone_service_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'service_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'service_tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'service_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'service_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinderv2'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'volumev2'</span>
</code></pre>
</div>

<p>logging attribute</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'LOG_LOCAL2'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'config_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'local2'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'volume'</span><span class="p">][</span><span class="s1">'volume_group_size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">40</span>
<span class="c1"># Type of volume group to create:</span>
<span class="c1"># - 'file' for basic 40g file for testing</span>
<span class="c1"># - 'block_devices' for using block devices, specified in block_devices attribute</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'volume'</span><span class="p">][</span><span class="s1">'create_volume_group_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'file'</span>
<span class="c1"># String of local disk device paths</span>
<span class="c1"># Examples: '/dev/sdx /dev/sdx1' or '/dev/sd[k-m]1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'volume'</span><span class="p">][</span><span class="s1">'block_devices'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform_family</span>
<span class="k">when</span> <span class="s1">'rhel'</span> <span class="c1"># :pragma-foodcritic: ~FC024 - won't fix this</span>
  <span class="c1"># operating system user and group names</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'volume'</span><span class="p">][</span><span class="s1">'iscsi_helper'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'lioadm'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'cinder_common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-cinder'</span><span class="p">],</span>
    <span class="s1">'cinder_api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-cinderclient'</span><span class="p">],</span>
    <span class="s1">'cinder_api_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-cinder-api'</span><span class="p">,</span>
    <span class="s1">'cinder_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-cinderclient'</span><span class="p">],</span>
    <span class="s1">'cinder_volume_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'qemu-img'</span><span class="p">],</span>
    <span class="s1">'cinder_volume_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-cinder-volume'</span><span class="p">,</span>
    <span class="s1">'cinder_scheduler_packages'</span> <span class="o">=&gt;</span> <span class="p">[],</span>
    <span class="s1">'cinder_scheduler_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-cinder-scheduler'</span><span class="p">,</span>
    <span class="s1">'cinder_backup_packages'</span> <span class="o">=&gt;</span> <span class="p">[],</span>
    <span class="s1">'cinder_backup_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-cinder-backup'</span><span class="p">,</span>
    <span class="s1">'cinder_iscsitarget_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'targetcli'</span><span class="p">],</span>
    <span class="s1">'cinder_iscsitarget_service'</span> <span class="o">=&gt;</span> <span class="s1">'target'</span><span class="p">,</span>
    <span class="s1">'cinder_ceph_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-ceph'</span><span class="p">,</span> <span class="s1">'ceph-common'</span><span class="p">],</span>
    <span class="s1">'cinder_nfs_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nfs-utils'</span><span class="p">,</span> <span class="s1">'nfs-utils-lib'</span><span class="p">],</span>
    <span class="s1">'cinder_emc_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'pywbem'</span><span class="p">],</span>
    <span class="s1">'cinder_svc_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'sysfsutils'</span><span class="p">],</span>
    <span class="s1">'cinder_lvm_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'lvm2'</span><span class="p">],</span>
    <span class="s1">'cinder_flashsystem_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'sysfsutils'</span><span class="p">],</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="c1"># operating system user and group names</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'cinder_common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'cinder-common'</span><span class="p">],</span>
    <span class="s1">'cinder_api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'cinder-api'</span><span class="p">,</span> <span class="s1">'python-cinderclient'</span><span class="p">],</span>
    <span class="s1">'cinder_api_service'</span> <span class="o">=&gt;</span> <span class="s1">'cinder-api'</span><span class="p">,</span>
    <span class="s1">'cinder_volume_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'cinder-volume'</span><span class="p">,</span> <span class="s1">'qemu-utils'</span><span class="p">],</span>
    <span class="s1">'cinder_volume_service'</span> <span class="o">=&gt;</span> <span class="s1">'cinder-volume'</span><span class="p">,</span>
    <span class="s1">'cinder_scheduler_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'cinder-scheduler'</span><span class="p">],</span>
    <span class="s1">'cinder_scheduler_service'</span> <span class="o">=&gt;</span> <span class="s1">'cinder-scheduler'</span><span class="p">,</span>
    <span class="s1">'cinder_backup_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'cinder-backup'</span><span class="p">],</span>
    <span class="s1">'cinder_backup_service'</span> <span class="o">=&gt;</span> <span class="s1">'cinder-backup'</span><span class="p">,</span>
    <span class="s1">'cinder_ceph_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-ceph'</span><span class="p">,</span> <span class="s1">'ceph-common'</span><span class="p">],</span>
    <span class="s1">'cinder_iscsitarget_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'tgt'</span><span class="p">],</span>
    <span class="s1">'cinder_iscsitarget_service'</span> <span class="o">=&gt;</span> <span class="s1">'tgt'</span><span class="p">,</span>
    <span class="s1">'cinder_nfs_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nfs-common'</span><span class="p">],</span>
    <span class="s1">'cinder_emc_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-pywbem'</span><span class="p">],</span>
    <span class="s1">'cinder_svc_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'sysfsutils'</span><span class="p">],</span>
    <span class="s1">'cinder_lvm_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'lvm2'</span><span class="p">],</span>
    <span class="s1">'cinder_flashsystem_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'sysfsutils'</span><span class="p">],</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s2">"-o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef'"</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<p><strong>**</strong><strong>**</strong><strong>**</strong>** OpenStack Volume Endpoints <strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong>*****
The OpenStack Volume (Cinder) API endpoint</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="sx">%w(public internal admin)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">ep_type</span><span class="o">|</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'scheme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/v2/%(tenant_id)s'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'8776'</span>
<span class="k">end</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'8776'</span>

<span class="o">=============================</span> <span class="n">rootwrap</span> <span class="no">Configuration</span> <span class="o">===================</span>
<span class="n">use</span> <span class="n">cinder</span> <span class="n">root</span> <span class="n">wrap</span>

<span class="sb">``` ruby
default['openstack']['block-storage']['use_rootwrap'] = true
# rootwrap.conf
default['openstack']['block-storage']['rootwrap']['conf'].tap do |conf|
  conf['DEFAULT']['filters_path'] = '/etc/cinder/rootwrap.d,/usr/share/cinder/rootwrap'
  conf['DEFAULT']['exec_dirs'] = '/sbin,/usr/sbin,/bin,/usr/bin'
  conf['DEFAULT']['use_syslog'] = false
  conf['DEFAULT']['syslog_log_facility'] = 'syslog'
  conf['DEFAULT']['syslog_log_level'] = 'ERROR'
end
</span></code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-client">cookbook-openstack-client</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-client-readme">cookbook-openstack-client-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="openstack-cookbook">Openstack Cookbook</h1>

<p>This is a library cookbook to consume openstack cloud resources.</p>

<h2 id="requirements-3">Requirements</h2>

<ul>
  <li>TBD</li>
</ul>

<h2 id="attributes-3">Attributes</h2>

<p>Attributes are self documented in <code class="highlighter-rouge">attributes/*.rb</code></p>

<h2 id="usage-1">Usage</h2>
<p>#### openstack::default</p>

<p>Installs <a href="http://fog.io">fog</a> gem and enabled LWRPs</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"my_node"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"run_list"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"recipe[openstack]"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h4 id="openstackexampleswift">openstack::_example_swift</h4>

<p>Example usage of swift LWRPs</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"my_node"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"run_list"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"recipe[openstack]"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"recipe[openstack::_example_swift]"</span><span class="p">,</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>If you need a simple swift endpoint to test against, the following blog post will help you set up a <a href="http://blog.phymata.com/2013/02/18/swift-only-with-openstack-devstack-on-the-rackspace-cloud/">single node swift on rackspace cloud</a>.</p>

<hr />

<h3 id="cookbook-openstack-client-attributes-default">cookbook-openstack-client-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Dependencies and versions</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack_client'</span><span class="p">][</span><span class="s1">'fog_version'</span><span class="p">]</span>      <span class="o">=</span> <span class="s1">'~&gt; 1.23.0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack_client'</span><span class="p">][</span><span class="s1">'nokogiri_version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'~&gt; 1.6.2.1'</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-compute">cookbook-openstack-compute</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-compute-readme">cookbook-openstack-compute-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-2">Description</h1>

<p>This cookbook installs the OpenStack Compute service <strong>Nova</strong> as part of the
OpenStack reference deployment Chef for OpenStack. The
https://github.com/openstack/openstack-chef-repo contains documentation for using
this cookbook in the context of a full OpenStack deployment. Nova is currently
installed from packages.</p>

<p>http://docs.openstack.org/mitaka/config-reference/compute.html</p>

<h1 id="requirements-4">Requirements</h1>

<ul>
  <li>Chef 12 or higher</li>
  <li>chefdk 0.9.0 for testing (also includes berkshelf for cookbook dependency
resolution)</li>
</ul>

<h1 id="platform-2">Platform</h1>

<ul>
  <li>ubuntu</li>
  <li>redhat</li>
  <li>centos</li>
</ul>

<h1 id="cookbooks-2">Cookbooks</h1>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>‘ceph’, ‘&gt;= 0.8.1’</li>
  <li>‘openstack-common’, ‘&gt;= 13.0.0’</li>
  <li>‘openstack-identity’, ‘&gt;= 13.0.0’</li>
  <li>‘openstack-image’, ‘&gt;= 13.0.0’</li>
  <li>‘openstack-network’, ‘&gt;= 13.0.0’</li>
  <li>‘python’, ‘~&gt; 1.4.6’</li>
</ul>

<h1 id="attributes-4">Attributes</h1>

<p>Please see the extensive inline documentation in <code class="highlighter-rouge">attributes/*.rb</code> for
descriptions of all the settable attributes for this cookbook.</p>

<p>Note that all attributes are in the <code class="highlighter-rouge">default['openstack']</code> “namespace”</p>

<p>The usage of attributes to generate the node.conf is decribed in the
openstack-common cookbook.</p>

<h1 id="recipes-2">Recipes</h1>

<h2 id="openstack-computeapi-metadata">openstack-compute::api-metadata</h2>
<ul>
  <li>Installs the nova metadata package</li>
</ul>

<h2 id="openstack-computeapi-os-compute">openstack-compute::api-os-compute</h2>
<ul>
  <li>Installs OS API and configures the service and endpoints in keystone</li>
</ul>

<h2 id="openstack-computeclient">openstack-compute::client</h2>
<ul>
  <li>Install the nova client packages</li>
</ul>

<h2 id="openstack-computecompute">openstack-compute::compute</h2>
<ul>
  <li>Installs nova-compute service</li>
</ul>

<h2 id="openstack-computecompute-1">openstack-compute::compute</h2>
<ul>
  <li>Installs nova-conductor service</li>
</ul>

<h2 id="openstack-computeidentityregistration">openstack-compute::identity_registration</h2>
<ul>
  <li>Registers the nova endpoints with keystone</li>
</ul>

<h2 id="openstack-computelibvirt">openstack-compute::libvirt</h2>
<ul>
  <li>Installs libvirt, used by nova compute for management of the virtual machine
environment</li>
</ul>

<h2 id="openstack-computelibvirtrbd">openstack-compute::libvirt_rbd</h2>
<ul>
  <li>Prepares the compute node for interaction with a Ceph cluster for block
storage (RBD)</li>
  <li>Depends on <code class="highlighter-rouge">ceph::_common</code>, <code class="highlighter-rouge">ceph::install</code>, and <code class="highlighter-rouge">ceph::conf</code> for packages and
cluster connectivity (i.e. a proper <code class="highlighter-rouge">/etc/ceph/ceph.conf</code>)</li>
</ul>

<h2 id="openstack-computenova-cert">openstack-compute::nova-cert</h2>
<ul>
  <li>Installs nova-cert service</li>
</ul>

<h2 id="openstack-computenova-common">openstack-compute::nova-common</h2>
<ul>
  <li>Builds the basic nova.conf config file with details of the rabbitmq, mysql,
glance and keystone servers</li>
</ul>

<h2 id="openstack-computenova-setup">openstack-compute::nova-setup</h2>
<ul>
  <li>Sets up the nova networks with <code class="highlighter-rouge">nova-manage</code></li>
</ul>

<h2 id="openstack-computescheduler">openstack-compute::scheduler</h2>
<ul>
  <li>Installs nova scheduler service</li>
</ul>

<h2 id="openstack-computevncproxy">openstack-compute::vncproxy</h2>
<ul>
  <li>Installs and configures the vncproxy service for console access to VMs</li>
</ul>

<h2 id="openstack-computeserialproxy">openstack-compute::serialproxy</h2>
<ul>
  <li>Installs and configures the serialproxy service for serial console access to VMs</li>
</ul>

<hr />

<h3 id="cookbook-openstack-compute-attributes-default">cookbook-openstack-compute-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'enable_monit'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span> <span class="c1"># OS provides packages</span>
<span class="c1">########################################################################</span>
</code></pre>
</div>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
'</span>
</code></pre>
</div>

<p>The name of the Chef role that knows about the message queue server
that Nova uses</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'rabbit_server_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-ops-messaging'</span>
</code></pre>
</div>

<p>Set dbsync command timeout value</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'dbsync_timeout'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3600</span>
</code></pre>
</div>

<p>The name of the Chef role that sets up the Keystone Service API</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'identity_service_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-identity'</span>
</code></pre>
</div>

<p>Disallow non-encrypted connections</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'service_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform_family</span>
<span class="k">when</span> <span class="s1">'rhel'</span><span class="p">,</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nova'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nova'</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Logging stuff</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'LOG_LOCAL1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'config_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'local1'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'floating_cmd'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/usr/local/bin/add_floaters.py'</span>
</code></pre>
</div>

<p>rootwrap.conf</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'filters_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/nova/rootwrap.d,/usr/share/nova/rootwrap'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'exec_dirs'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/sbin,/usr/sbin,/bin,/usr/bin'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'use_syslog'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'False'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'syslog_log_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'syslog'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'syslog_log_level'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ERROR'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'libvirt.LibvirtDriver'</span>
</code></pre>
</div>

<p>libvirtd_opts used in template for /etc/default/libvirt-bin</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'libvirtd_opts'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'-d -l'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'auth_tcp'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'none'</span>
<span class="c1"># libvirt.max_clients (default: 20)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'max_clients'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
<span class="c1"># libvirt.max_workers (default: 20)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'max_workers'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
<span class="c1"># libvirt.max_requests (default: 20)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'max_requests'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
<span class="c1"># libvirt.max_client_requests (default: 5)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'max_client_requests'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'libvirtd'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'unix_sock_rw_perms'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'0770'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'libvirt_inject_key'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="c1"># rbd</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'rbd'</span><span class="p">][</span><span class="s1">'ceph_conf'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/ceph/ceph.conf'</span>
<span class="c1"># use a different backend for volumes, allowed options: rbd</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'volume_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'rbd'</span><span class="p">][</span><span class="s1">'cinder'</span><span class="p">][</span><span class="s1">'pool'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'volumes'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'rbd'</span><span class="p">][</span><span class="s1">'glance'</span><span class="p">][</span><span class="s1">'pool'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'images'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'rbd'</span><span class="p">][</span><span class="s1">'nova'</span><span class="p">][</span><span class="s1">'pool'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'instances'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'rbd'</span><span class="p">][</span><span class="s1">'cinder'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'rbd'</span><span class="p">][</span><span class="s1">'cinder'</span><span class="p">][</span><span class="s1">'secret_uuid'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'00000000-0000-0000-0000-000000000000'</span>
</code></pre>
</div>

<p>Base URL that will be presented to users in links
to the OpenStack Compute API</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'osapi_compute_link_prefix'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="c1"># Base URL that will be presented to users in links</span>
<span class="c1"># to glance resources</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'osapi_glance_link_prefix'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'cpu_allocation_ratio'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span><span class="o">.</span><span class="mi">0</span>
</code></pre>
</div>

<p><code class="highlighter-rouge">start</code> will cause nova-compute to error out if a VM is already running, where
<code class="highlighter-rouge">resume</code> checks to see if it is running first.
requires https://review.openstack.org/#/c/8423/</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'resume_guests_state_on_host_boot'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'ratelimit'</span><span class="p">][</span><span class="s1">'settings'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'generic-post-limit'</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">'verb'</span> <span class="o">=&gt;</span> <span class="s1">'POST'</span><span class="p">,</span> <span class="s1">'uri'</span> <span class="o">=&gt;</span> <span class="s1">'*'</span><span class="p">,</span> <span class="s1">'regex'</span> <span class="o">=&gt;</span> <span class="s1">'.*'</span><span class="p">,</span> <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="s1">'10'</span><span class="p">,</span> <span class="s1">'interval'</span> <span class="o">=&gt;</span> <span class="s1">'MINUTE'</span> <span class="p">},</span>
  <span class="s1">'create-servers-limit'</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">'verb'</span> <span class="o">=&gt;</span> <span class="s1">'POST'</span><span class="p">,</span> <span class="s1">'uri'</span> <span class="o">=&gt;</span> <span class="s1">'*/servers'</span><span class="p">,</span> <span class="s1">'regex'</span> <span class="o">=&gt;</span> <span class="s1">'^/servers'</span><span class="p">,</span> <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="s1">'50'</span><span class="p">,</span> <span class="s1">'interval'</span> <span class="o">=&gt;</span> <span class="s1">'DAY'</span> <span class="p">},</span>
  <span class="s1">'generic-put-limit'</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">'verb'</span> <span class="o">=&gt;</span> <span class="s1">'PUT'</span><span class="p">,</span> <span class="s1">'uri'</span> <span class="o">=&gt;</span> <span class="s1">'*'</span><span class="p">,</span> <span class="s1">'regex'</span> <span class="o">=&gt;</span> <span class="s1">'.*'</span><span class="p">,</span> <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="s1">'10'</span><span class="p">,</span> <span class="s1">'interval'</span> <span class="o">=&gt;</span> <span class="s1">'MINUTE'</span> <span class="p">},</span>
  <span class="s1">'changes-since-limit'</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">'verb'</span> <span class="o">=&gt;</span> <span class="s1">'GET'</span><span class="p">,</span> <span class="s1">'uri'</span> <span class="o">=&gt;</span> <span class="s1">'*changes-since*'</span><span class="p">,</span> <span class="s1">'regex'</span> <span class="o">=&gt;</span> <span class="s1">'.*changes-since.*'</span><span class="p">,</span> <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="s1">'3'</span><span class="p">,</span> <span class="s1">'interval'</span> <span class="o">=&gt;</span> <span class="s1">'MINUTE'</span> <span class="p">},</span>
  <span class="s1">'generic-delete-limit'</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">'verb'</span> <span class="o">=&gt;</span> <span class="s1">'DELETE'</span><span class="p">,</span> <span class="s1">'uri'</span> <span class="o">=&gt;</span> <span class="s1">'*'</span><span class="p">,</span> <span class="s1">'regex'</span> <span class="o">=&gt;</span> <span class="s1">'.*'</span><span class="p">,</span> <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="s1">'100'</span><span class="p">,</span> <span class="s1">'interval'</span> <span class="o">=&gt;</span> <span class="s1">'MINUTE'</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Metering settings</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'metering'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span> <span class="c1">####</span>
</code></pre>
</div>

<p>Notification settings</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'metering'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'notification_drivers'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'nova.openstack.common.notifier.rpc_notifier'</span><span class="p">,</span> <span class="s1">'ceilometer.compute.nova_notifier'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'instance_usage_audit'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'True'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'instance_usage_audit_period'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'hour'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'notify_on_state_change'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'vm_and_task_state'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'notification_topics'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'notifications'</span><span class="p">]</span>
<span class="k">else</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'notification_drivers'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'instance_usage_audit'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'False'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'instance_usage_audit_period'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'month'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'notify_on_state_change'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">''</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'notification_topics'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'notifications'</span><span class="p">]</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Monitor settings</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'compute_available_monitors'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'nova.compute.monitors.all_monitors'</span><span class="p">]</span>
</code></pre>
</div>

<p>Keystone settings</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth_strategy'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span>
</code></pre>
</div>

<p>A PEM encoded Certificate Authority to use when verifying HTTPs connections.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'cafile'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Keystone PKI signing directories</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'cache_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/nova/api'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform_family</span>
<span class="k">when</span> <span class="s1">'rhel'</span> <span class="c1"># :pragma-foodcritic: ~FC024 - won't fix this</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'api_os_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-api'</span><span class="p">],</span>
    <span class="s1">'api_os_compute_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-nova-api'</span><span class="p">,</span>
    <span class="s1">'neutron_python_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-neutronclient'</span><span class="p">,</span> <span class="s1">'pyparsing'</span><span class="p">],</span>
    <span class="s1">'memcache_python_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-memcached'</span><span class="p">],</span>
    <span class="s1">'compute_api_metadata_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-api'</span><span class="p">],</span>
    <span class="s1">'compute_api_metadata_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-nova-metadata-api'</span><span class="p">,</span>
    <span class="s1">'compute_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-novaclient'</span><span class="p">],</span>
    <span class="s1">'compute_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-compute'</span><span class="p">],</span>
    <span class="s1">'qemu_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[],</span>
    <span class="s1">'kvm_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[],</span>
    <span class="s1">'compute_compute_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-nova-compute'</span><span class="p">,</span>
    <span class="s1">'compute_scheduler_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-scheduler'</span><span class="p">],</span>
    <span class="s1">'compute_scheduler_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-nova-scheduler'</span><span class="p">,</span>
    <span class="s1">'compute_conductor_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-conductor'</span><span class="p">],</span>
    <span class="s1">'compute_conductor_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-nova-conductor'</span><span class="p">,</span>
    <span class="s1">'compute_vncproxy_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-novncproxy'</span><span class="p">],</span>
    <span class="s1">'compute_vncproxy_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-nova-novncproxy'</span><span class="p">,</span>
    <span class="s1">'compute_vncproxy_consoleauth_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-console'</span><span class="p">],</span>
    <span class="s1">'compute_vncproxy_consoleauth_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-nova-consoleauth'</span><span class="p">,</span>
    <span class="s1">'compute_serialproxy_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-serialproxy'</span><span class="p">],</span>
    <span class="s1">'compute_serialproxy_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-nova-serialproxy'</span><span class="p">,</span>
    <span class="s1">'libvirt_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'libvirt'</span><span class="p">,</span> <span class="s1">'device-mapper'</span><span class="p">,</span> <span class="s1">'python-libguestfs'</span><span class="p">],</span>
    <span class="s1">'libvirt_service'</span> <span class="o">=&gt;</span> <span class="s1">'libvirtd'</span><span class="p">,</span>
    <span class="s1">'libvirt_ceph_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceph-common'</span><span class="p">],</span>
    <span class="s1">'dbus_service'</span> <span class="o">=&gt;</span> <span class="s1">'messagebus'</span><span class="p">,</span>
    <span class="s1">'compute_cert_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-cert'</span><span class="p">],</span>
    <span class="s1">'compute_cert_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-nova-cert'</span><span class="p">,</span>
    <span class="s1">'mysql_service'</span> <span class="o">=&gt;</span> <span class="s1">'mysqld'</span><span class="p">,</span>
    <span class="s1">'common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-common'</span><span class="p">],</span>
    <span class="s1">'iscsi_helper'</span> <span class="o">=&gt;</span> <span class="s1">'ietadm'</span><span class="p">,</span>
    <span class="s1">'volume_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'sysfsutils'</span><span class="p">,</span> <span class="s1">'sg3_utils'</span><span class="p">,</span> <span class="s1">'device-mapper-multipath'</span><span class="p">],</span>
    <span class="s1">'docker_build_pkgs'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'git'</span><span class="p">,</span> <span class="s1">'python-devel'</span><span class="p">,</span> <span class="s1">'gcc'</span><span class="p">],</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'api_os_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-api-os-compute'</span><span class="p">],</span>
    <span class="s1">'api_os_compute_service'</span> <span class="o">=&gt;</span> <span class="s1">'nova-api-os-compute'</span><span class="p">,</span>
    <span class="s1">'memcache_python_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-memcache'</span><span class="p">],</span>
    <span class="s1">'neutron_python_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-neutronclient'</span><span class="p">,</span> <span class="s1">'python-pyparsing'</span><span class="p">],</span>
    <span class="s1">'compute_api_metadata_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-api-metadata'</span><span class="p">],</span>
    <span class="s1">'compute_api_metadata_service'</span> <span class="o">=&gt;</span> <span class="s1">'nova-api-metadata'</span><span class="p">,</span>
    <span class="s1">'compute_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-novaclient'</span><span class="p">],</span>
    <span class="s1">'compute_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-compute'</span><span class="p">],</span>
    <span class="s1">'qemu_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-compute-qemu'</span><span class="p">],</span>
    <span class="s1">'kvm_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-compute-kvm'</span><span class="p">],</span>
    <span class="s1">'compute_compute_service'</span> <span class="o">=&gt;</span> <span class="s1">'nova-compute'</span><span class="p">,</span>
    <span class="s1">'compute_scheduler_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-scheduler'</span><span class="p">],</span>
    <span class="s1">'compute_scheduler_service'</span> <span class="o">=&gt;</span> <span class="s1">'nova-scheduler'</span><span class="p">,</span>
    <span class="s1">'compute_conductor_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-conductor'</span><span class="p">],</span>
    <span class="s1">'compute_conductor_service'</span> <span class="o">=&gt;</span> <span class="s1">'nova-conductor'</span><span class="p">,</span>
    <span class="c1"># Websockify is needed due to https://bugs.launchpad.net/ubuntu/+source/nova/+bug/1076442</span>
    <span class="s1">'compute_vncproxy_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'novnc'</span><span class="p">,</span> <span class="s1">'websockify'</span><span class="p">,</span> <span class="s1">'nova-novncproxy'</span><span class="p">],</span>
    <span class="s1">'compute_vncproxy_service'</span> <span class="o">=&gt;</span> <span class="s1">'nova-novncproxy'</span><span class="p">,</span>
    <span class="s1">'compute_vncproxy_consoleauth_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-consoleauth'</span><span class="p">],</span>
    <span class="s1">'compute_vncproxy_consoleauth_service'</span> <span class="o">=&gt;</span> <span class="s1">'nova-consoleauth'</span><span class="p">,</span>
    <span class="s1">'compute_serialproxy_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-serialproxy'</span><span class="p">],</span>
    <span class="s1">'compute_serialproxy_service'</span> <span class="o">=&gt;</span> <span class="s1">'nova-serialproxy'</span><span class="p">,</span>
    <span class="s1">'libvirt_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'libvirt-bin'</span><span class="p">,</span> <span class="s1">'python-guestfs'</span><span class="p">],</span>
    <span class="s1">'libvirt_service'</span> <span class="o">=&gt;</span> <span class="s1">'libvirt-bin'</span><span class="p">,</span>
    <span class="s1">'libvirt_ceph_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceph-common'</span><span class="p">],</span>
    <span class="s1">'dbus_service'</span> <span class="o">=&gt;</span> <span class="s1">'dbus'</span><span class="p">,</span>
    <span class="s1">'compute_cert_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-cert'</span><span class="p">],</span>
    <span class="s1">'compute_cert_service'</span> <span class="o">=&gt;</span> <span class="s1">'nova-cert'</span><span class="p">,</span>
    <span class="s1">'mysql_service'</span> <span class="o">=&gt;</span> <span class="s1">'mysql'</span><span class="p">,</span>
    <span class="s1">'common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-common'</span><span class="p">],</span>
    <span class="s1">'iscsi_helper'</span> <span class="o">=&gt;</span> <span class="s1">'tgtadm'</span><span class="p">,</span>
    <span class="s1">'volume_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'sysfsutils'</span><span class="p">,</span> <span class="s1">'sg3-utils'</span><span class="p">,</span> <span class="s1">'multipath-tools'</span><span class="p">],</span>
    <span class="s1">'docker_build_pkgs'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'git'</span><span class="p">,</span> <span class="s1">'python-dev'</span><span class="p">,</span> <span class="s1">'gcc'</span><span class="p">],</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s2">"-o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef'"</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Array of options for <code class="highlighter-rouge">api-paste.ini</code> (e.g. [‘option1=value1’, …])</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'misc_paste'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>NOTE: The metadata api service is enabled via including it’s recipe
NOTE: api-metadata.  By default the api-metadata recipe is included in
NOTE: the os-compute-api role which is included in the
NOTE: os-compute-single-controller role.
For true case, this logic allows the following ironic-related attribtes to be overwritten automatically.
Docker configurations
Docker compute configuration is supported only in Rhel and Ubuntu
This is to be true to make a compute docker type and use nova docker driver as compute driver</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'docker'</span><span class="p">][</span><span class="s1">'enable'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># The nova docker driver that will be configured in a docker type compute</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'docker'</span><span class="p">][</span><span class="s1">'driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'novadocker.virt.docker.driver.DockerDriver'</span>
<span class="c1"># Additional python packages required for nova docker driver build and installation from git source</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'docker'</span><span class="p">][</span><span class="s1">'pip_build_pkgs'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'setuptools'</span><span class="p">,</span> <span class="s1">'pbr'</span><span class="p">]</span>
<span class="c1"># github repository from which nova-docker source will be downloaded</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'docker'</span><span class="p">][</span><span class="s1">'github'</span><span class="p">][</span><span class="s1">'repository'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'https://github.com/stackforge/nova-docker'</span>
<span class="c1"># github branch from which nova-docker source will be downloaded. Default is master</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'docker'</span><span class="p">][</span><span class="s1">'github'</span><span class="p">][</span><span class="s1">'branch'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'master'</span>
<span class="c1"># Relative path to docker filter files in nova-docker source which will be cloned from git repo</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'docker'</span><span class="p">][</span><span class="s1">'filter_source_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/nova/rootwrap.d'</span>
<span class="c1"># Path to docker service sock file</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'docker'</span><span class="p">][</span><span class="s1">'service_sock'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/run/docker.sock'</span>
<span class="c1"># Permission level to be assigned to docker service sock file</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'docker'</span><span class="p">][</span><span class="s1">'service_sock_mode'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">666</span>
<span class="c1"># Docker group which will be created and added with openstack compute user</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'docker'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'docker'</span>
</code></pre>
</div>

<p><strong>**</strong><strong>**</strong><strong>**</strong> OpenStack Compute Endpoints <strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong>
The OpenStack Compute (Nova) XVPvnc endpoint</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="sx">%w(
  compute-xvpvnc compute-novnc
  compute-metadata-api
  compute-vnc compute-api
)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">service</span><span class="o">|</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
  <span class="sx">%w(public internal admin)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">type</span><span class="o">|</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'scheme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http'</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="sx">%w(public internal admin)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">type</span><span class="o">|</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-xvpvnc'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'6081'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-xvpvnc'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/console'</span>
  <span class="c1"># The OpenStack Compute (Nova) Native API endpoint</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-api'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'8774'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-api'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/v2/%(tenant_id)s'</span>
  <span class="c1"># The OpenStack Compute (Nova) novnc endpoint</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-novnc'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'6080'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-novnc'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/vnc_auto.html'</span>
  <span class="c1"># The OpenStack Compute (Nova) metadata API endpoint</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-metadata-api'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'8775'</span>
  <span class="c1"># The OpenStack Compute (Nova) serial proxy endpoint</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-serial-proxy'</span><span class="p">][</span><span class="s1">'scheme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ws'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-serial-proxy'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'6083'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-serial-proxy'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-serial-proxy'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="k">end</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'compute-serial-proxy'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'compute-vnc-proxy'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'compute-serial-console'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'compute-xvpvnc'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'6081'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'compute-vnc'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'6081'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'compute-serial-proxy'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'6081'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'compute-novnc'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'6080'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'compute-metadata-api'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'8775'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'compute-api'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'8774'</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-compute-attributes-novaconf">cookbook-openstack-compute-attributes-nova_conf</h3>

<p><a href="#contents">back to top</a></p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'conf_secrets'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="c1"># [DEFAULT] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/nova'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'state_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/lib/nova'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'compute_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'libvirt.LibvirtDriver'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'auth_version'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'rpc_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'instances_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'state_path'</span><span class="p">]</span><span class="si">}</span><span class="s2">/instances"</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'enabled_apis'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'osapi_compute'</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span> <span class="c1">#= false</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_config'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack/logging.conf'</span>
  <span class="k">end</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'use_neutron'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'true'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'linuxnet_interface_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nova.network.linux_net.LinuxOVSInterfaceDriver'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'firewall_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nova.virt.firewall.NoopFirewallDriver'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'default_floating_pool'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'public'</span> <span class="c1"># not listed</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'dns_server'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'8.8.8.8'</span> <span class="c1"># [] in docs</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [keystone_authtoken]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'signing_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/nova/api'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'auth_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'region_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nova'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [libvirt]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'virt_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'kvm'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'images_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'default'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'images_type'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'lvm'</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'images_volume_group'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'sparse_logical_volumes'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="k">elsif</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'images_type'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'rbd'</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'images_rbd_pool'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'instances'</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'images_rbd_ceph_conf'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/ceph/ceph.conf'</span> <span class="c1"># nil</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'rbd_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder'</span> <span class="c1"># none</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'rbd_secret_uuid'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'rbd'</span><span class="p">][</span><span class="s1">'cinder'</span><span class="p">][</span><span class="s1">'secret_uuid'</span><span class="p">]</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="k">end</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [neutron]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'neutron'</span><span class="p">][</span><span class="s1">'auth_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'neutron'</span><span class="p">][</span><span class="s1">'region_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'neutron'</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'neutron'</span><span class="p">][</span><span class="s1">'tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'neutron'</span><span class="p">][</span><span class="s1">'service_metadata_proxy'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [cinder] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'cinder'</span><span class="p">][</span><span class="s1">'os_region_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [oslo_concurrency] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'oslo_concurrency'</span><span class="p">][</span><span class="s1">'lock_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'state_path'</span><span class="p">]</span><span class="si">}</span><span class="s2">/lock"</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-dashboard">cookbook-openstack-dashboard</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-dashboard-readme">cookbook-openstack-dashboard-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-3">Description</h1>

<p>Installs the OpenStack Dashboard service <strong>Horizon</strong> as part of the OpenStack
reference deployment Chef for OpenStack. The
https://github.com/openstack/openstack-chef-repo contains documentation for using
this cookbook in the context of a full OpenStack deployment. Horizon is
currently installed from packages.</p>

<p>http://docs.openstack.org/mitaka/config-reference/dashboard.html</p>

<h1 id="requirements-5">Requirements</h1>

<ul>
  <li>Chef 12 or higher</li>
  <li>chefdk 0.9.0 for testing (also includes berkshelf for cookbook dependency
resolution)</li>
</ul>

<h1 id="platform-3">Platform</h1>

<ul>
  <li>ubuntu</li>
  <li>redhat</li>
  <li>centos</li>
</ul>

<h1 id="cookbooks-3">Cookbooks</h1>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>‘apache2’, ‘~&gt; 3.1’</li>
  <li>‘openstack-common’, ‘&gt;= 13.0.0’</li>
  <li>‘openstack-identity’, ‘&gt;= 13.0.0’</li>
</ul>

<h1 id="attributes-5">Attributes</h1>

<p>Please see the extensive inline documentation in <code class="highlighter-rouge">attributes/*.rb</code> for
descriptions of all the settable attributes for this cookbook.</p>

<p>Note that all attributes are in the <code class="highlighter-rouge">default['openstack']</code> “namespace”</p>

<h1 id="recipes-3">Recipes</h1>

<h2 id="openstack-dashboardhorizon">openstack-dashboard::horizon</h2>
<ul>
  <li>Sets up the packages needed to run the Horizon dashboard and its dependencies.
Will be included from the <code class="highlighter-rouge">server</code> recipe.</li>
</ul>

<h2 id="openstack-dashboardapache2-server">openstack-dashboard::apache2-server</h2>
<ul>
  <li>Installs the Apache webserver and sets up an <code class="highlighter-rouge">mod_wsgi</code> container to run the
Horizon dashboard. Will be included from the <code class="highlighter-rouge">server</code> recipe.</li>
</ul>

<h2 id="openstack-dashboardserver">openstack-dashboard::server</h2>
<ul>
  <li>Sets up the Horizon dashboard and a webserver of type
<code class="highlighter-rouge">['openstack']['dashboard']['server_type']</code> to run it, default type is
‘apache2’.</li>
</ul>

<hr />

<h3 id="cookbook-openstack-dashboard-attributes-default">cookbook-openstack-dashboard-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
'</span>

<span class="o">******************</span> <span class="no">OpenStack</span> <span class="no">Dashboard</span> <span class="no">Endpoints</span> <span class="o">******************************</span>
<span class="no">The</span> <span class="no">OpenStack</span> <span class="no">Dashboard</span> <span class="n">non</span><span class="o">-</span><span class="no">SSL</span> <span class="n">endpoint</span>

<span class="sb">``` ruby
default['openstack']['bind_service']['dashboard_http']['host'] = '0.0.0.0'
default['openstack']['bind_service']['dashboard_http']['port'] = '80'
</span></code></pre>
</div>

<p>The OpenStack Dashboard SSL endpoint</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'dashboard_https'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'0.0.0.0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'dashboard_https'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'443'</span>
</code></pre>
</div>

<hr />

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'server_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'apache2'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'debug'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>Don’t cache html pages.
NOTE: This setting requires apache 2.4 or greater is used</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'cache_html'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>The Keystone role used by default for users logging into the dashboard</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_default_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'_member_'</span>
</code></pre>
</div>

<p>This is the name of the Chef role that will install the Keystone Service API</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_service_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'server_hostname'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'use_ssl'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="c1"># When using a remote certificate and key, the names of the actual installed certificate</span>
<span class="c1"># and key in the file system are determined by the following two attributes.</span>
<span class="c1"># If you want the name of the installed files to match the name of the files from the URL,</span>
<span class="c1"># they need to be manually set below, if not the conventional horizon.* names will be used.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'cert'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'horizon.pem'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'key'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'horizon.key'</span>
<span class="c1"># Which versions of the SSL/TLS protocol will be accepted in new connections.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'protocol'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'All -SSLv2 -SSLv3'</span>
<span class="c1"># Which ciphers to use with the SSL/TLS protocol.</span>
<span class="c1"># Example: 'RSA:HIGH:MEDIUM:!LOW:!kEDH:!aNULL:!ADH:!eNULL:!EXP:!SSLv2:!SEED:!CAMELLIA:!PSK!RC4:!RC4-MD5:!RC4-SHA'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'ciphers'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>List of hosts/domains the dashboard can serve. This should be changed, a ‘*’
allows everything</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'allowed_hosts'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'*'</span><span class="p">]</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'swift'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'False'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'theme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'default'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'apache'</span><span class="p">][</span><span class="s1">'sites-path'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'apache'</span><span class="p">][</span><span class="s1">'dir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/openstack-dashboard.conf"</span>
</code></pre>
</div>

<p>Allow TRACE method</p>

<p>Set to “extended” to also reflect the request body (only for testing and
diagnostic purposes).</p>

<table>
  <tbody>
    <tr>
      <td>Set to one of:  On</td>
      <td>Off</td>
      <td>extended</td>
    </tr>
  </tbody>
</table>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'traceenable'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'apache'</span><span class="p">][</span><span class="s1">'traceenable'</span><span class="p">]</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'secret_key_content'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl_no_verify'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'True'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl_cacert'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'webroot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/'</span>
</code></pre>
</div>

<p>Dashboard specific database packages
Put common ones here and platform specific ones below.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'db_python_packages'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">mysql: </span><span class="p">[],</span>
  <span class="ss">postgresql: </span><span class="p">[],</span>
  <span class="ss">sqlite: </span><span class="p">[]</span>
<span class="p">}</span>
</code></pre>
</div>

<p>The hash algorithm to use for authentication tokens. This must match the hash
algorithm that the identity (Keystone) server and the auth_token middleware
are using. Allowed values are the algorithms supported by Python’s hashlib
library.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'hash_algorithm'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'md5'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">node</span><span class="p">[</span><span class="s1">'platform_family'</span><span class="p">]</span>
<span class="k">when</span> <span class="s1">'rhel'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'key_group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'root'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'horizon_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'apache'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'horizon_group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'apache'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'secret_key_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/usr/share/openstack-dashboard/openstack_dashboard/local/.secret_key_store'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'cert_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/pki/tls/certs/'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'key_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/pki/tls/private/'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'local_settings_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack-dashboard/local_settings'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'django_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/usr/share/openstack-dashboard'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'login_url'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'webroot'</span><span class="p">]</span><span class="si">}</span><span class="s2">auth/login/"</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'logout_url'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'webroot'</span><span class="p">]</span><span class="si">}</span><span class="s2">auth/logout/"</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'login_redirect_url'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'webroot'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'horizon_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-dashboard'</span><span class="p">],</span>
    <span class="s1">'memcache_python_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-memcached'</span><span class="p">],</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'apache'</span><span class="p">][</span><span class="s1">'sites-path'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'apache'</span><span class="p">][</span><span class="s1">'dir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/sites-available/openstack-dashboard.conf"</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'key_group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ssl-cert'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'horizon_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'horizon'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'horizon_group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'horizon'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'secret_key_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/lib/openstack-dashboard/secret_key'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'cert_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/ssl/certs/'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'key_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/ssl/private/'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'local_settings_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack-dashboard/local_settings.py'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'django_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/usr/share/openstack-dashboard'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'login_url'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'logout_url'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'login_redirect_url'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'memcache_python_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-memcache'</span><span class="p">],</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s2">"-o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef'"</span>
  <span class="p">}</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">][</span><span class="s1">'horizon_packages'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'node-less'</span><span class="p">,</span> <span class="s1">'openstack-dashboard'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'apache'</span><span class="p">][</span><span class="s1">'sites-path'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'apache'</span><span class="p">][</span><span class="s1">'dir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/sites-available/openstack-dashboard.conf"</span>
<span class="k">else</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'key_group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'root'</span>
<span class="k">end</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'dash_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'django_path'</span><span class="p">]</span><span class="si">}</span><span class="s2">/openstack_dashboard"</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'static_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'django_path'</span><span class="p">]</span><span class="si">}</span><span class="s2">/static"</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'stylesheet_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/usr/share/openstack-dashboard/openstack_dashboard/templates/_stylesheets.html'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'wsgi_path'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'dash_path'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">'/wsgi/django.wsgi'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'wsgi_socket_prefix'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'session_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'memcached'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl_offload'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'plugins'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'file_upload_temp_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'error_log'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'openstack-dashboard-error.log'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'access_log'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'openstack-dashboard-access.log'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'help_url'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http://docs.openstack.org'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'csrf_cookie_secure'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'session_cookie_secure'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_multidomain_support'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span>
<span class="k">when</span> <span class="s1">'v2.0'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'identity_api_version'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">.</span><span class="mi">0</span>
<span class="k">when</span> <span class="s1">'v3.0'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'identity_api_version'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="k">end</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'volume_api_version'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_default_domain'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Default'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'console_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'AUTO'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_backend'</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'native'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_backend'</span><span class="p">][</span><span class="s1">'can_edit_user'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_backend'</span><span class="p">][</span><span class="s1">'can_edit_group'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_backend'</span><span class="p">][</span><span class="s1">'can_edit_project'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_backend'</span><span class="p">][</span><span class="s1">'can_edit_domain'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_backend'</span><span class="p">][</span><span class="s1">'can_edit_role'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'horizon'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'openstack_dashboard'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'novaclient'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'cinderclient'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'keystoneclient'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'glanceclient'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'neutronclient'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'heatclient'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'ceilometerclient'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'troveclient'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'swiftclient'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'openstack_auth'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'nose.plugins.manager'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'django'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'password_autocomplete'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'off'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'simple_ip_management'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'neutron'</span><span class="p">][</span><span class="s1">'enable_quotas'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'neutron'</span><span class="p">][</span><span class="s1">'enable_lb'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># Allow for misc sections to be added to the local_settings template</span>
<span class="c1"># For example: {</span>
<span class="c1">#                'CUSTOM_CONFIG_A' =&gt; {</span>
<span class="c1">#                  'variable1': 'value1',</span>
<span class="c1">#                  'variable2': 'value2'</span>
<span class="c1">#                }</span>
<span class="c1">#                'CUSTOM_CONFIG_B' =&gt; {</span>
<span class="c1">#                  'variable1': 'value1',</span>
<span class="c1">#                  'variable2': 'value2'</span>
<span class="c1">#                }</span>
<span class="c1">#              }</span>
<span class="c1"># will generate:</span>
<span class="c1">#  CUSTOM_CONFIG_A = {</span>
<span class="c1">#    'varable1': 'value1',</span>
<span class="c1">#    'varable2': 'value2',</span>
<span class="c1">#  }</span>
<span class="c1">#  CUSTOM_CONFIG_A = {</span>
<span class="c1">#    'varable1': 'value1',</span>
<span class="c1">#    'varable2': 'value2',</span>
<span class="c1">#  }</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'misc_local_settings'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-database">cookbook-openstack-database</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-database-readme">cookbook-openstack-database-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-4">Description</h1>

<p>Installs the OpenStack Database service <strong>Trove</strong> as part of the
OpenStack reference deployment Chef for OpenStack.  Trove is currently
installed from packages.</p>

<p>https://wiki.openstack.org/wiki/Trove</p>

<h1 id="requirements-6">Requirements</h1>

<p>Chef 11</p>

<h2 id="cookbooks-4">Cookbooks</h2>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>openstack-common</li>
  <li>openstack-identity</li>
</ul>

<h1 id="usage-2">Usage</h1>

<h2 id="api">api</h2>
<ul>
  <li>Installs the API service.</li>
</ul>

<h2 id="conductor">conductor</h2>
<ul>
  <li>Installs conductor service.</li>
</ul>

<h2 id="taskmanager">taskmanager</h2>
<ul>
  <li>Installs the taskmanager service.</li>
</ul>

<h2 id="identityregistration">identity_registration</h2>
<ul>
  <li>Registers the endpoints with Keystone.</li>
</ul>

<h1 id="attributes-6">Attributes</h1>

<hr />

<h3 id="cookbook-openstack-database-attributes-default">cookbook-openstack-database-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'verbose'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'debug'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'trove'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'trove'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform</span>
<span class="k">when</span> <span class="s1">'suse'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-trove-api'</span><span class="p">],</span>
    <span class="s1">'api_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-trove-api'</span><span class="p">,</span>
    <span class="s1">'conductor_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-trove-conductor'</span><span class="p">],</span>
    <span class="s1">'conductor_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-trove-conductor'</span><span class="p">,</span>
    <span class="s1">'taskmanager_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-trove-taskmanager'</span><span class="p">],</span>
    <span class="s1">'taskmanager_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-trove-taskmanager'</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'service_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'trove'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'service_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'service_tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'volume_support'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<p>Keystone PKI signing directory</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'cache_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/trove/api'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'nova_proxy_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'nova_proxy_password'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'nova_proxy_tenant'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-data-processing">cookbook-openstack-data-processing</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-data-processing-readme">cookbook-openstack-data-processing-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-5">Description</h1>

<p>This cookbook installs the OpenStack Data Processing service <strong>Sahara</strong> as part of an OpenStack reference deployment Chef for OpenStack.</p>

<p>https://wiki.openstack.org/wiki/Sahara</p>

<hr />

<h2 id="cookbook-openstack-identity">cookbook-openstack-identity</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-identity-readme">cookbook-openstack-identity-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-6">Description</h1>

<p>This cookbook installs the OpenStack Identity Service <strong>Keystone</strong> as part of
the OpenStack reference deployment Chef for OpenStack. The
https://github.com/openstack/openstack-chef-repo contains documentation for
using this cookbook in the context of a full OpenStack deployment. Keystone is
installed from packages, creating the default user, tenant, and roles. It also
registers the identity service and identity endpoint.</p>

<p>http://keystone.openstack.org</p>

<h1 id="requirements-7">Requirements</h1>

<ul>
  <li>Chef 12 or higher</li>
  <li>chefdk 0.9.0 for testing (also includes berkshelf for cookbook dependency
resolution)</li>
</ul>

<h1 id="platform-4">Platform</h1>

<ul>
  <li>ubuntu</li>
  <li>redhat</li>
  <li>centos</li>
</ul>

<h1 id="cookbooks-5">Cookbooks</h1>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>‘apache2’, ‘~&gt; 3.1’</li>
  <li>‘openstack-common’, ‘&gt;= 13.0.0’</li>
</ul>

<h1 id="attributes-7">Attributes</h1>

<p>Please see the extensive inline documentation in <code class="highlighter-rouge">attributes/*.rb</code> for
descriptions of all the settable attributes for this cookbook.</p>

<p>Note that all attributes are in the <code class="highlighter-rouge">default['openstack']</code> “namespace”</p>

<p>The usage of attributes to generate the keystone.conf is decribed in the
openstack-common cookbook.</p>

<h1 id="recipes-4">Recipes</h1>

<h2 id="openstack-identityclient">openstack-identity::client</h2>
<ul>
  <li>Installs the packages require to use keystone client.</li>
</ul>

<h2 id="openstack-identityopenrc">openstack-identity::openrc</h2>
<ul>
  <li>Creates a fully usable openrc file to export the needed environment variables
to use the openstack client.</li>
</ul>

<h2 id="openstack-identityregistration">openstack-identity::registration</h2>
<ul>
  <li>Registers the initial keystone endpoint as well as users, tenants and roles
needed for the initial configuration utilizing the LWRP provided inside of
this cookbook. The recipe is documented in detail with inline comments inside
the recipe.</li>
</ul>

<h2 id="openstack-identityserver-apache">openstack-identity::server-apache</h2>
<ul>
  <li>Installs and configures the OpenStack Identity Service running inside of an
apache webserver. The recipe is documented in detail with inline comments
inside the recipe.</li>
</ul>

<h1 id="resources-1">Resources</h1>

<h2 id="openstackidentityregister">openstack_identity_register</h2>

<h3 id="actions">Actions</h3>

<ul>
  <li>create_ec2_credentials:</li>
  <li>create_endpoint:</li>
  <li>create_role:</li>
  <li>create_service:</li>
  <li>create_tenant:</li>
  <li>create_user:</li>
  <li>grant_role:</li>
</ul>

<h3 id="attribute-parameters">Attribute Parameters</h3>

<ul>
  <li>auth_uri: The uri used to as authentication endpoint for requests</li>
  <li>bootstrap_token: The admin bootstrap_token used for authentication</li>
  <li>service_type: Type of service to create (e.g. ‘identity’ or ‘volume’)</li>
  <li>service_name: The name of the service to create (only for action
:create_service)</li>
  <li>service_description: The description for the service to create (only for
action :create_service)</li>
  <li>endpoint_region: The region to create the endpoint in (only for action
:create_endpoint) Defaults to <code>"RegionOne"</code>.</li>
  <li>endpoint_adminurl: The public url to register for the endpoint (only for
action :create_endpoint)</li>
  <li>endpoint_internalurl:  The internal url to register for the endpoint (only for
action :create_endpoint)</li>
  <li>endpoint_publicurl: The public url to register for the endpoint (only for
action :create_endpoint)</li>
  <li>tenant_name: The name of the tenant to create or create the user in (only for
action :create_tenant and :create_user)</li>
  <li>tenant_description: The description of the tenant to create (only for action
:create_tenant)</li>
  <li>tenant_enabled: Enable or disable tenant to create (only for action
:create_tenant) Defaults to <code>true</code>.</li>
  <li>user_name: The name of the user to create (only for action :create_user)</li>
  <li>user_pass: The passwort of the user to create (only for action :create_user)</li>
  <li>user_enabled: Enable or disable user to create (only for action :create_user)
Defaults to <code>true</code>.</li>
  <li>role_name: The name of the role to create or grant to the user (only for
:create_role and :grant_role)</li>
  <li>admin_tenant_name: The name of the admin tenant (only for
:create_ec2_credentials)</li>
  <li>admin_user: The name of the admin user (only for :create_ec2_credentials)</li>
  <li>admin_pass: The password of the admin user (only for :create_ec2_credentials)</li>
  <li>identity_endpoint: The identity endpoint to use for user and ec2 creation. If
not specified, default endpoint will be used. (only for create_ec2_credentials
and create_user)</li>
</ul>

<h3 id="examples-1">Examples</h3>

<div class="highlighter-rouge"><pre class="highlight"><code># Create 'openstack' tenant
openstack_identity_register "Register 'openstack' Tenant" do
  auth_host "192.168.1.10"
  auth_port "35357"
  auth_protocol "http"
  api_ver "/v2.0"
  auth_token "123456789876"
  tenant_name "openstack"
  tenant_description "Default Tenant"
  tenant_enabled "true" # Not required as this is the default
  action :create_tenant
end

# Create 'admin' user
openstack_identity_register "Register 'admin' User" do
  auth_host "192.168.1.10"
  auth_port "35357"
  auth_protocol "http"
  api_ver "/v2.0"
  auth_token "123456789876"
  tenant_name "openstack"
  user_name "admin"
  user_pass "secrete"
  user_enabled "true" # Not required as this is the default
  action :create_user
end

# Create 'admin' role
openstack_identity_register "Register 'admin' Role" do
  auth_host "192.168.1.10"
  auth_port "35357"
  auth_protocol "http"
  api_ver "/v2.0"
  auth_token "123456789876"
  role_name role_key
  action :create_role
end

# Grant 'admin' role to 'admin' user in the 'openstack' tenant
openstack_identity_register "Grant 'admin' Role to 'admin' User" do
  auth_host "192.168.1.10"
  auth_port "35357"
  auth_protocol "http"
  api_ver "/v2.0"
  auth_token "123456789876"
  tenant_name "openstack"
  user_name "admin"
  role_name "admin"
  action :grant_role
end

# Create 'identity' service
openstack_identity_register "Register Identity Service" do
  auth_host "192.168.1.10"
  auth_port "35357"
  auth_protocol "http"
  api_ver "/v2.0"
  auth_token "123456789876"
  service_name "keystone"
  service_type "identity"
  service_description "Keystone Identity Service"
  action :create_service
end

# Create 'identity' endpoint
openstack_identity_register "Register Identity Endpoint" do
  auth_host "192.168.1.10"
  auth_port "35357"
  auth_protocol "http"
  api_ver "/v2.0"
  auth_token "123456789876"
  service_type "identity"
  endpoint_region "RegionOne"
  endpoint_adminurl "http://192.168.1.10:35357/v2.0"
  endpoint_internalurl "http://192.168.1.10:5001/v2.0"
  endpoint_publicurl "http://1.2.3.4:5001/v2.0"
  action :create_endpoint
end
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-identity-attributes-default">cookbook-openstack-identity-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span>
  <span class="s1">'# This file autogenerated by Chef, changes will be overwritten'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="sx">%w(admin internal public)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">ep_type</span><span class="o">|</span>
  <span class="c1"># host for openstack admin/internal/public identity endpoint</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
  <span class="c1"># scheme for openstack admin/internal/public identity endpoint</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'scheme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http'</span>
  <span class="c1"># path for openstack admin/internal/public identity endpoint</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/v2.0'</span>
<span class="k">end</span>
</code></pre>
</div>

<p>port for openstack public identity endpoint</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'public'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="c1"># port for openstack internal identity endpoint</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'internal'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="c1"># port for openstack admin identity endpoint</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'admin'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">35357</span>
</code></pre>
</div>

<p>address for openstack identity service main endpoint to bind to</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'main'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="c1"># port for openstack identity service main endpoint to bind to</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'main'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="c1"># address for openstack identity service admin endpoint to bind to</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'admin'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="c1"># port for openstack identity service admin endpoint to bind to</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'admin'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">35357</span>
</code></pre>
</div>

<p>identity service catalog backend for service endpoints</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'catalog'</span><span class="p">][</span><span class="s1">'backend'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'sql'</span>
<span class="c1"># identity service token backend for user and service tokens</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'token'</span><span class="p">][</span><span class="s1">'backend'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'sql'</span>
</code></pre>
</div>

<p>identity service startup delay, in seconds</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'start_delay'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
</code></pre>
</div>

<p>Specify a location to retrieve keystone-paste.ini from
which can either be a remote url using http:// or a
local path to a file using file:// which would generally
be a distribution file - if this option is left nil then
the templated version distributed with this cookbook
will be used (keystone-paste.ini.erb)</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'pastefile_url'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>This specify the pipeline of the keystone public API,
all Identity public API requests will be processed by the order of the pipeline.
this value will be used in the templated version of keystone-paste.ini
The last item in this pipeline must be public_service or an equivalent
application. It cannot be a filter.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'pipeline'</span><span class="p">][</span><span class="s1">'public_api'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'sizelimit url_normalize request_id build_auth_context token_auth admin_token_auth json_body ec2_extension user_crud_extension public_service'</span>
<span class="c1"># This specify the pipeline of the keystone admin API,</span>
<span class="c1"># all Identity admin API requests will be processed by the order of the pipeline.</span>
<span class="c1"># this value will be used in the templated version of keystone-paste.ini</span>
<span class="c1"># The last item in this pipeline must be admin_service or an equivalent</span>
<span class="c1"># application. It cannot be a filter.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'pipeline'</span><span class="p">][</span><span class="s1">'admin_api'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'sizelimit url_normalize request_id build_auth_context token_auth admin_token_auth json_body ec2_extension s3_extension crud_extension admin_service'</span>
<span class="c1"># This specify the pipeline of the keystone V3 API,</span>
<span class="c1"># all Identity V3 API requests will be processed by the order of the pipeline.</span>
<span class="c1"># this value will be used in the templated version of keystone-paste.ini</span>
<span class="c1"># The last item in this pipeline must be service_v3 or an equivalent</span>
<span class="c1"># application. It cannot be a filter.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'pipeline'</span><span class="p">][</span><span class="s1">'api_v3'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'sizelimit url_normalize request_id build_auth_context token_auth admin_token_auth json_body ec2_extension_v3 s3_extension simple_cert_extension revoke_extension federation_extension oauth1_extension endpoint_filter_extension service_v3'</span>
</code></pre>
</div>

<p>region to be used for endpoint registration</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
</code></pre>
</div>

<p>enable or disable the usage of syslog</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># syslog log facility to log to in case syslog is used</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'LOG_LOCAL2'</span>
<span class="c1"># syslog config facility in case syslog is used</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'config_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'local2'</span>
</code></pre>
</div>

<p>user to be created and used for identity service</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'admin_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
<span class="c1"># tenant to be created and used for identity service</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'admin_tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'users'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'admin_user'</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'default_tenant'</span> <span class="o">=&gt;</span> <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'admin_tenant_name'</span><span class="p">],</span>
    <span class="s1">'roles'</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="s1">'admin'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'admin'</span><span class="p">],</span>
      <span class="s1">'service'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'admin'</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>specify whether to enable SSL for Keystone API endpoint</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># specify server whether to enforce client certificate requirement</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'cert_required'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># SSL certificate, keyfile and CA certficate file locations</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/keystone/ssl'</span>
<span class="c1"># Protocol for SSL (Apache)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'protocol'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'All -SSLv2 -SSLv3'</span>
<span class="c1"># Which ciphers to use with the SSL/TLS protocol (Apache)</span>
<span class="c1"># Example: 'RSA:HIGH:MEDIUM:!LOW:!kEDH:!aNULL:!ADH:!eNULL:!EXP:!SSLv2:!SEED:!CAMELLIA:!PSK!RC4:!RC4-MD5:!RC4-SHA'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'ciphers'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="c1"># path of the cert file for SSL.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'certfile'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/certs/sslcert.pem"</span>
<span class="c1"># path of the keyfile for SSL.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'keyfile'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/private/sslkey.pem"</span>
<span class="c1"># path of the CA cert file for SSL.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'ca_certs'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/certs/sslca.pem"</span>
<span class="c1"># path of the CA cert files for SSL (Apache)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'ca_certs_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/certs/"</span>
</code></pre>
</div>

<p>Fernet keys. Note this section is only written if
node[‘openstack’][‘auth’][‘strategy’] == ‘fernet’
Fernet keys to read from databags/vaults. This should be changed in the
environment when rotating keys (with the defaults below, the items
‘fernet_key0’ and ‘fernet_key1’ will be read from the databag/vault
‘keystone).
For more information please read:
http://docs.openstack.org/admin-guide-cloud/keystone_fernet_token_faq.html</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'fernet'</span><span class="p">][</span><span class="s1">'keys'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</code></pre>
</div>

<p>The external (REMOTE_USER) auth plugin module. (String value)</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'external'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone.auth.plugins.external.DefaultDomain'</span>
<span class="c1"># Default auth methods. (List value)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'methods'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'external, password, token, oauth1'</span>
</code></pre>
</div>

<p>enable or disable the usage of the token flushing cronjob</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'token_flush_cron'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="c1"># log file location for token flushing cronjob</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'token_flush_cron'</span><span class="p">][</span><span class="s1">'log_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/keystone/token-flush.log'</span>
<span class="c1"># hour to run token flushing cronjob</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'token_flush_cron'</span><span class="p">][</span><span class="s1">'hour'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'*'</span>
<span class="c1"># minute to run token flushing cronjob</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'token_flush_cron'</span><span class="p">][</span><span class="s1">'minute'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'0'</span>
<span class="c1"># day to run token flushing cronjob</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'token_flush_cron'</span><span class="p">][</span><span class="s1">'day'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'*'</span>
<span class="c1"># weekday to run token flushing cronjob</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'token_flush_cron'</span><span class="p">][</span><span class="s1">'weekday'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'*'</span>
</code></pre>
</div>

<p>configuration directory for keystone domain specific options</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'domain_config_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/keystone/domains'</span>
</code></pre>
</div>

<p>PKI signing. Corresponds to the [signing] section of keystone.conf
Note this section is only written if node[‘openstack’][‘auth’][‘strategy’] == ‘pki’</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'signing'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/keystone/ssl'</span>
<span class="c1"># certfile used for keystone pki token signing</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'signing'</span><span class="p">][</span><span class="s1">'certfile'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'signing'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/certs/signing_cert.pem"</span>
<span class="c1"># keyfile used for keystone pki token signing</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'signing'</span><span class="p">][</span><span class="s1">'keyfile'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'signing'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/private/signing_key.pem"</span>
<span class="c1"># certificate authority used for keystone pki token signing</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'signing'</span><span class="p">][</span><span class="s1">'ca_certs'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'signing'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/certs/ca.pem"</span>
</code></pre>
</div>

<p>keystone service user name</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
<span class="c1"># keystone service user group</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
</code></pre>
</div>

<p>platform defaults</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform_family</span>
<span class="k">when</span> <span class="s1">'fedora'</span><span class="p">,</span> <span class="s1">'rhel'</span> <span class="c1"># :pragma-foodcritic: ~FC024 - won't fix this</span>
  <span class="c1"># platform specific package and service name options</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'memcache_python_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-memcached'</span><span class="p">],</span>
    <span class="s1">'keystone_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-keystone'</span><span class="p">],</span>
    <span class="s1">'keystone_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-keystoneclient'</span><span class="p">],</span>
    <span class="s1">'keystone_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-keystone'</span><span class="p">,</span>
    <span class="s1">'keystone_process_name'</span> <span class="o">=&gt;</span> <span class="s1">'keystone-all'</span><span class="p">,</span>
    <span class="s1">'keystone_wsgi_file'</span> <span class="o">=&gt;</span> <span class="s1">'/usr/share/keystone/keystone.wsgi'</span><span class="p">,</span>
    <span class="s1">'package_options'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="c1"># platform specific package and service name options</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'memcache_python_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-memcache'</span><span class="p">],</span>
    <span class="s1">'keystone_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'keystone'</span><span class="p">],</span>
    <span class="s1">'keystone_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-keystoneclient'</span><span class="p">],</span>
    <span class="s1">'keystone_service'</span> <span class="o">=&gt;</span> <span class="s1">'keystone'</span><span class="p">,</span>
    <span class="s1">'keystone_process_name'</span> <span class="o">=&gt;</span> <span class="s1">'keystone-all'</span><span class="p">,</span>
    <span class="s1">'keystone_wsgi_file'</span> <span class="o">=&gt;</span> <span class="s1">'/usr/share/keystone/wsgi.py'</span><span class="p">,</span>
    <span class="s1">'package_options'</span> <span class="o">=&gt;</span> <span class="s2">"-o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef'"</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<p>array of bare options for openrc (e.g. ‘option=value’)</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'misc_openrc'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>openrc path</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'openrc'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/root'</span>
<span class="c1"># openrc path mode</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'openrc'</span><span class="p">][</span><span class="s1">'path_mode'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'0700'</span>
<span class="c1"># openrc file name</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'openrc'</span><span class="p">][</span><span class="s1">'file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'openrc'</span>
<span class="c1"># openrc file mode</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'openrc'</span><span class="p">][</span><span class="s1">'file_mode'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'0600'</span>
<span class="c1"># openrc file owner</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'openrc'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'root'</span>
<span class="c1"># openrc file group</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'openrc'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'root'</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-identity-attributes-keystoneconf">cookbook-openstack-identity-attributes-keystone_conf</h3>

<p><a href="#contents">back to top</a></p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'conf_secrets'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="c1"># [DEFAULT]</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span>
    <span class="c1"># [DEFAULT] option in keystone.conf to read additional logging.conf</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_config_append'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack/logging.conf'</span>
  <span class="k">else</span>
    <span class="c1"># [DEFAULT] option in keystone.conf to set keystone log dir</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/keystone'</span>
  <span class="k">end</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'notification_driver'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'messaging'</span>
    <span class="c1"># [DEFAULT] option in keystone.conf to define mq notification topics</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'notification_topics'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'notifications'</span>
  <span class="k">end</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'rpc_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [assignment] option in keystone.conf to set driver</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'assignment'</span><span class="p">][</span><span class="s1">'driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone.assignment.backends.sql.Assignment'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [auth] option in keystone.conf to set auth plugins</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'external'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone.auth.plugins.external.DefaultDomain'</span>
  <span class="c1"># [auth] option in keystone.conf to set auth methods</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'methods'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'external, password, token, oauth1'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [catalog] option in keystone.conf to set catalog driver</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'catalog'</span><span class="p">][</span><span class="s1">'driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone.catalog.backends.sql.Catalog'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [identity] option in keystone.conf to enable domain_specific drivers</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'domain_specific_drivers_enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [policy] option in keystone.conf to set policy backend driver</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'policy'</span><span class="p">][</span><span class="s1">'driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone.policy.backends.sql.Policy'</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-image">cookbook-openstack-image</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-image-readme">cookbook-openstack-image-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-7">Description</h1>

<p>This cookbook installs the OpenStack Image service <strong>Glance</strong> as part of an
OpenStack reference deployment Chef for OpenStack. The
https://github.com/openstack/openstack-chef-repo contains documentation for using
this cookbook in the context of a full OpenStack deployment. Glance is installed
from packages, optionally populating the repository with default images.</p>

<p>http://docs.openstack.org/mitaka/config-reference/image-service.html</p>

<h1 id="requirements-8">Requirements</h1>

<ul>
  <li>Chef 12 or higher</li>
  <li>chefdk 0.9.0 for testing (also includes berkshelf for cookbook dependency
resolution)</li>
</ul>

<h1 id="platform-5">Platform</h1>

<ul>
  <li>ubuntu</li>
  <li>redhat</li>
  <li>centos</li>
</ul>

<h1 id="cookbooks-6">Cookbooks</h1>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>‘openstack-common’, ‘&gt;= 13.0.0’</li>
  <li>‘openstack-identity’, ‘&gt;= 13.0.0’</li>
</ul>

<h1 id="attributes-8">Attributes</h1>

<p>Please see the extensive inline documentation in <code class="highlighter-rouge">attributes/*.rb</code> for
descriptions of all the settable attributes for this cookbook.</p>

<p>Note that all attributes are in the <code class="highlighter-rouge">default['openstack']</code> “namespace”</p>

<p>The usage of attributes to generate the glance-api.conf glance-registry.conf is
decribed in the openstack-common cookbook.</p>

<h1 id="recipes-5">Recipes</h1>

<h2 id="openstack-imageapi">openstack-image::api</h2>
<ul>
  <li>Installs the glance-api server</li>
</ul>

<h2 id="openstack-imageclient">openstack-image::client</h2>
<ul>
  <li>Install the glance client packages</li>
</ul>

<h2 id="openstack-imageidentityrregistration">openstack-image::identityr_registration</h2>
<ul>
  <li>Registers the API endpoint and glance service Keystone user</li>
</ul>

<h2 id="openstack-imageregistry">openstack-image::registry</h2>
<ul>
  <li>Installs the glance-registry server</li>
</ul>

<h2 id="openstack-imageimage-upload">openstack-image::image-upload</h2>
<ul>
  <li>Upload image to glance. If you want to upload image during openstack
installation, you need to add this recipe or the os-image role to the run list
in a certain role and ensure before this recipe or the os-image role glance api
and glance registry recipes have been executed.</li>
</ul>

<h1 id="glance-backend">Glance Backend</h1>

<p>The Glance cookbook currently supports file, swift, and Rackspace Cloud Files
(swift API compliant) backing stores.  NOTE: changing the storage location from
cloudfiles to swift (and vice versa) requires that you manually export and
import your stored images.</p>

<p>To enable these features set the following in the default attributes section in
your environment:</p>

<h2 id="files">Files</h2>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="s2">"openstack"</span><span class="err">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"api"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"default_store"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"upload_images"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"cirros"</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h2 id="swift">Swift</h2>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="s2">"openstack"</span><span class="err">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"api"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"default_store"</span><span class="p">:</span><span class="w"> </span><span class="s2">"swift"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"upload_images"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"cirros"</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h1 id="providers">Providers</h1>

<h2 id="image">image</h2>

<p>Action: <code class="highlighter-rouge">:upload</code></p>

<ul>
  <li><code class="highlighter-rouge">:image_url</code>: Location of the image to be loaded into Glance.</li>
  <li><code class="highlighter-rouge">:image_name</code>: A name for the image.</li>
  <li><code class="highlighter-rouge">:image_type</code>: <code class="highlighter-rouge">unknown</code>, <code class="highlighter-rouge">qcow</code>, <code class="highlighter-rouge">ami</code>, <code class="highlighter-rouge">vhd</code>, <code class="highlighter-rouge">vmdk</code>, <code class="highlighter-rouge">vdi</code>, <code class="highlighter-rouge">iso</code>, <code class="highlighter-rouge">raw</code>.
Defaults of <code class="highlighter-rouge">unknown</code> will use file extension ‘.gz’, ‘.tgz’ = ami, ‘.qcow2’,
‘.img’ = qcow.</li>
  <li><code class="highlighter-rouge">:identity_user</code>: Username of the Keystone admin user.</li>
  <li><code class="highlighter-rouge">:identity_pass</code>: Password for the Keystone admin user.</li>
  <li><code class="highlighter-rouge">:identity_tenant</code>: Name of the Keystone admin user’s tenant.</li>
  <li><code class="highlighter-rouge">:identity_uri</code>: URI of the Identity API endpoint.</li>
</ul>

<p>For testing this provider with ChefSpec, a custom matcher was added to
<code class="highlighter-rouge">libraries/matchers.rb</code>.</p>

<hr />

<h3 id="cookbook-openstack-image-attributes-default">cookbook-openstack-image-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
'</span>
</code></pre>
</div>

<p>SSL Options
Enable SSL for glance api and registry bind endpoints.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># Enable SSL for glance api bind endpoint.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span>
<span class="c1"># Enable SSL for glance registry bind endpoint.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'registry'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span>
<span class="c1"># Base directory for SSL certficate and key</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/glance/ssl'</span>
<span class="c1"># Specify server whether SSL certificate is required</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'cert_required'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'verbose'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'False'</span>
</code></pre>
</div>

<p>This is the name of the Chef role that will install the Keystone Service API</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'identity_service_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-identity'</span>
</code></pre>
</div>

<p>Gets set in the Image Endpoint when registering with Keystone</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
</code></pre>
</div>

<p>The name of the Chef role that knows about the message queue server
that Glance uses</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'rabbit_server_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-ops-messaging'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'service_tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'service_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'glance'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'service_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
</code></pre>
</div>

<p>Supported values for the ‘container_format’ image attribute</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'container_formats'</span><span class="p">]</span> <span class="o">=</span> <span class="sx">%w(ami ari aki bare ovf ova docker dockerref)</span>
</code></pre>
</div>

<p>Supported values for the ‘disk_format’ image attribute
Whether to use any of the default caching pipelines from the paste configuration file</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'caching'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'cache_management'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>Directory for the Image Cache</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'cache'</span><span class="p">][</span><span class="s1">'dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/lib/glance/image-cache/'</span>
<span class="c1"># Number of seconds until an incomplete image is considered stalled an</span>
</code></pre>
</div>

<p>Number of seconds to leave invalid images around before they are eligible to be reaped</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'cache'</span><span class="p">][</span><span class="s1">'grace_period'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3600</span>
</code></pre>
</div>

<p>Default Image Locations</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'upload_images'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'cirros'</span><span class="p">]</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'upload_image'</span><span class="p">][</span><span class="s1">'precise'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http://cloud-images.ubuntu.com/precise/current/precise-server-cloudimg-amd64-disk1.img'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'upload_image'</span><span class="p">][</span><span class="s1">'oneiric'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http://cloud-images.ubuntu.com/oneiric/current/oneiric-server-cloudimg-amd64-disk1.img'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'upload_image'</span><span class="p">][</span><span class="s1">'natty'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http://cloud-images.ubuntu.com/natty/current/natty-server-cloudimg-amd64-disk1.img'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'upload_image'</span><span class="p">][</span><span class="s1">'cirros'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http://download.cirros-cloud.net/0.3.4/cirros-0.3.4-x86_64-disk.img'</span>
<span class="c1"># more images available at https://github.com/rackerjoe/oz-image-build</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'upload_image'</span><span class="p">][</span><span class="s1">'centos'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud.qcow2'</span>
<span class="c1"># To override image type</span>
<span class="c1"># The following disk format types are supported: qcow vhd vmdk vdi iso raw</span>
<span class="c1"># Bare container format will be used.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'upload_image_type'</span><span class="p">][</span><span class="s1">'cirros'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'qcow'</span>
</code></pre>
</div>

<p>logging attribute</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'LOG_LOCAL2'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'config_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'local2'</span>
</code></pre>
</div>

<p>vmware attributes</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'vmware'</span><span class="p">][</span><span class="s1">'secret_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'openstack_vmware_secret_name'</span>
</code></pre>
</div>

<p>cron output redirection</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'cron'</span><span class="p">][</span><span class="s1">'redirection'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'&gt; /dev/null 2&gt;&amp;1'</span>
</code></pre>
</div>

<p>platform-specific settings</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform_family</span>
<span class="k">when</span> <span class="s1">'rhel'</span> <span class="c1"># :pragma-foodcritic: ~FC024 - won't fix this</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'glance'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'glance'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'image_packages'</span> <span class="o">=&gt;</span> <span class="sx">%w(openstack-glance cronie python-glanceclient)</span><span class="p">,</span>
    <span class="s1">'image_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-glanceclient'</span><span class="p">],</span>
    <span class="s1">'ceph_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-ceph'</span><span class="p">],</span>
    <span class="s1">'swift_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-swift'</span><span class="p">],</span>
    <span class="s1">'image_api_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-glance-api'</span><span class="p">,</span>
    <span class="s1">'image_registry_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-glance-registry'</span><span class="p">,</span>
    <span class="s1">'image_api_process_name'</span> <span class="o">=&gt;</span> <span class="s1">'glance-api'</span><span class="p">,</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
<span class="k">when</span> <span class="s1">'suse'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'openstack-glance'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'openstack-glance'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'image_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-glance'</span><span class="p">,</span> <span class="s1">'python-glanceclient'</span><span class="p">],</span>
    <span class="s1">'image_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-glanceclient'</span><span class="p">],</span>
    <span class="s1">'ceph_packages'</span> <span class="o">=&gt;</span> <span class="p">[],</span>
    <span class="s1">'swift_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-swift'</span><span class="p">],</span>
    <span class="s1">'image_api_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-glance-api'</span><span class="p">,</span>
    <span class="s1">'image_registry_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-glance-registry'</span><span class="p">,</span>
    <span class="s1">'image_api_process_name'</span> <span class="o">=&gt;</span> <span class="s1">'glance-api'</span><span class="p">,</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'glance'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'glance'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'image_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'glance'</span><span class="p">],</span>
    <span class="s1">'image_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-glanceclient'</span><span class="p">],</span>
    <span class="s1">'ceph_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-ceph'</span><span class="p">],</span>
    <span class="s1">'swift_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-swift'</span><span class="p">],</span>
    <span class="s1">'image_api_service'</span> <span class="o">=&gt;</span> <span class="s1">'glance-api'</span><span class="p">,</span>
    <span class="s1">'image_registry_service'</span> <span class="o">=&gt;</span> <span class="s1">'glance-registry'</span><span class="p">,</span>
    <span class="s1">'image_registry_process_name'</span> <span class="o">=&gt;</span> <span class="s1">'glance-registry'</span><span class="p">,</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s2">"-o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef'"</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<p><strong>**</strong><strong>**</strong><strong>**</strong>** OpenStack Image Endpoints <strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong>
The OpenStack Image (Glance) endpoints</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="sx">%w(public internal admin)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">ep_type</span><span class="o">|</span>
  <span class="sx">%w(image_api image_registry)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">service</span><span class="o">|</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'scheme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http'</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'image_api'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">''</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'image_api'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9292</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'image_registry'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/v2'</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'image_registry'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9191</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'image_registry'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'image_registry'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9191</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'image_api'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'image_api'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9292</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-image-attributes-glanceapiconf">cookbook-openstack-image-attributes-glance_api_conf</h3>

<p><a href="#contents">back to top</a></p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image_api'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="c1"># [DEFAULT] section</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_config'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack/logging.conf'</span>
  <span class="k">else</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/glance/api.log'</span>
  <span class="k">end</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'rpc_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [glance_store] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'glance_store'</span><span class="p">][</span><span class="s1">'default_store'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'file'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [paste_deploy] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'paste_deploy'</span><span class="p">][</span><span class="s1">'flavor'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [keystone_authtoken] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'auth_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'region_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'glance'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'signing_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/glance/api'</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-image-attributes-glancecacheconf">cookbook-openstack-image-attributes-glance_cache_conf</h3>

<p><a href="#contents">back to top</a></p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image-cache'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="c1"># [DEFAULT] section</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_config'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack/logging.conf'</span>
  <span class="k">else</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/glance/image-cache.log'</span>
  <span class="k">end</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'image_cache_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/lib/glance/image-cache/'</span> <span class="c1"># none in docs</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-image-attributes-glanceregistryconf">cookbook-openstack-image-attributes-glance_registry_conf</h3>

<p><a href="#contents">back to top</a></p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image_registry'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="c1"># [DEFAULT] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'rpc_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_config'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack/logging.conf'</span>
  <span class="k">else</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/glance/registry.log'</span>
  <span class="k">end</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [paste_deploy] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'paste_deploy'</span><span class="p">][</span><span class="s1">'flavor'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1">#  [keystone_authtoken] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'auth_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'region_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'glance'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'signing_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/glance/registry'</span> <span class="c1"># none in docs</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-image-attributes-glancescrubberconf">cookbook-openstack-image-attributes-glance_scrubber_conf</h3>

<p><a href="#contents">back to top</a></p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image-scrubber'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="c1"># [DEFAULT] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'verbose'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_config'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack/logging.conf'</span>
  <span class="k">else</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/glance/scrubber.log'</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-network">cookbook-openstack-network</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-network-readme">cookbook-openstack-network-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-8">Description</h1>

<p>This cookbook installs the OpenStack Network service <strong>Neutron</strong> as part of a
Chef reference deployment of OpenStack. The
https://github.com/openstack/openstack-chef-repo contains documentation for using this cookbook in the context of a full OpenStack deployment.</p>

<p>More information about the OpenStack Network service is available
<a href="http://docs.openstack.org/mitaka/config-reference/networking.html">here</a></p>

<h1 id="usage-3">Usage</h1>

<p>OpenStack Network’s design is modular, with plugins available that handle L2 and
L3 networking for various hardware vendors and standards.</p>

<h1 id="requirements-9">Requirements</h1>

<ul>
  <li>Chef 12 or higher</li>
  <li>chefdk 0.9.0 for testing (also includes berkshelf for cookbook dependency
resolution)</li>
</ul>

<h1 id="platform-6">Platform</h1>

<ul>
  <li>ubuntu</li>
  <li>redhat</li>
  <li>centos</li>
</ul>

<h1 id="cookbooks-7">Cookbooks</h1>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>‘openstack-common’, ‘&gt;= 13.0.0’</li>
  <li>‘openstack-identity’, ‘&gt;= 13.0.0’</li>
</ul>

<h1 id="attributes-9">Attributes</h1>

<p>Please see the extensive inline documentation in <code class="highlighter-rouge">attributes/*.rb</code> for
descriptions of all the settable attributes for this cookbook.</p>

<p>Note that all attributes are in the <code class="highlighter-rouge">default['openstack']</code> “namespace”</p>

<p>The usage of attributes to generate the neutron.conf is described in the
openstack-common cookbook.</p>

<h1 id="recipes-6">Recipes</h1>

<h2 id="openstack-networkclient">openstack-network::client</h2>
<ul>
  <li>Install the network client packages</li>
</ul>

<h2 id="openstack-networkdbmigration">openstack-network::db_migration</h2>
<ul>
  <li>Migrates the neutron database</li>
</ul>

<h2 id="openstack-networkdefault">openstack-network::default</h2>
<ul>
  <li>Configures common pieces needed for all neutron services and create the
neutron.conf</li>
</ul>

<h2 id="openstack-networkdhcpagent">openstack-network::dhcp_agent</h2>
<ul>
  <li>Installs the DHCP agent</li>
</ul>

<p>The configuration for neutron-dhcp-agent is generated from the attributes in
using the same template as for the neutron.conf</p>

<div class="highlighter-rouge"><pre class="highlight"><code>node['openstack']['network_dhcp']['conf']
</code></pre>
</div>

<h2 id="openstack-networkfwaas">openstack-network::fwaas</h2>
<p><strong>This is a ‘work in progress’ recipe and is currently not tested</strong>
- Installs the Firewall as a Service</p>

<h2 id="openstack-networkidentityregistration">openstack-network::identity_registration</h2>
<ul>
  <li>Registers the OpenStack Network API endpoint and service user with Keystone</li>
</ul>

<h2 id="openstack-networkl3agent">openstack-network::l3_agent</h2>
<ul>
  <li>Installs the L3 agent</li>
</ul>

<p>The configuration for neutron-l3-agent is generated from the attributes in using
the same template as for the neutron.conf</p>

<div class="highlighter-rouge"><pre class="highlight"><code>node['openstack']['network_l3']['conf']
</code></pre>
</div>

<h2 id="openstack-networklbaas">openstack-network::lbaas</h2>
<ul>
  <li>Installs the Loadbalancer as a Service</li>
</ul>

<p>The configuration for neutron-lbaas-agent is generated from the attributes in
using the same template as for the neutron.conf</p>

<div class="highlighter-rouge"><pre class="highlight"><code>node['openstack']['network_lbaas']['conf']
</code></pre>
</div>

<h2 id="openstack-networkmetadataagent">openstack-network::metadata_agent</h2>
<ul>
  <li>Installs the metadata agent</li>
</ul>

<p>The configuration for neutron-metadata-agent is generated from the attributes in
using the same template as for the neutron.conf</p>

<div class="highlighter-rouge"><pre class="highlight"><code>node['openstack']['network_metadata']['conf']
</code></pre>
</div>

<h2 id="openstack-networkmeteringagent">openstack-network::metering_agent</h2>
<ul>
  <li>Installs the metering agent</li>
</ul>

<p>The configuration for neutron-metadata-agent is generated from the attributes in
using the same template as for the neutron.conf</p>

<div class="highlighter-rouge"><pre class="highlight"><code>node['openstack']['network_metering']['conf']
</code></pre>
</div>

<h2 id="openstack-networkml2coreplugin">openstack-network::ml2_core_plugin</h2>
<ul>
  <li>Configure the ml2_core_plugin</li>
</ul>

<h2 id="openstack-networkml2linuxbridge">openstack-network::ml2_linuxbridge</h2>
<ul>
  <li>Configure the ml2 linuxbridge plugin</li>
</ul>

<h2 id="openstack-networkml2openvswitch">openstack-network::ml2_openvswitch</h2>
<ul>
  <li>Configure the ml2 openvswitch plugin</li>
</ul>

<h2 id="openstack-networkopenvswitch">openstack-network::openvswitch</h2>
<ul>
  <li>Installs openvswitch</li>
</ul>

<h2 id="openstack-networkopenvswitchagent">openstack-network::openvswitch_agent</h2>
<ul>
  <li>Installs the openvswitch agent</li>
</ul>

<h2 id="openstack-networkpluginconfig">openstack-network::plugin_config</h2>
<ul>
  <li>Generates all the needed plugin configurations directly from the attributes
in:</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>node['openstack']['network']['plugins'][myplugin]
</code></pre>
</div>

<p>The final configuration file is generated exactly like all OpenStack service
configuration files (e.g. neutron.conf), but the attribute mentioned above
allows you additionally to define the file name and patch with:</p>

<div class="highlighter-rouge"><pre class="highlight"><code># this will also generate the path recursively if not already existent
node['openstack']['network']['plugins'][myplugin]['path']
# this defines the filename for the plugin config (e.g. ml2_conf.ini)
node['openstack']['network']['plugins'][myplugin]['filename']
</code></pre>
</div>
<p>In the examples above, the variable ‘myplugin’ can be used to generate multiple
plugin configurations with different configs and filenames. Please refer to the
recipe openstack-network::ml2_openvswitch for an full example on the usage of
this attributes.</p>

<h2 id="openstack-networkserver">openstack-network::server</h2>
<ul>
  <li>Installs the openstack-network API server (currently aka neutron-server)</li>
</ul>

<h2 id="openstack-networkvpnaas">openstack-network::vpnaas</h2>
<ul>
  <li>Installs the VPN as a Service</li>
</ul>

<p>The configuration for neutron-vpn-agent is generated from the attributes in
using the same template as for the neutron.conf</p>

<div class="highlighter-rouge"><pre class="highlight"><code>node['openstack']['network_vpnaas']['conf']
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-network-attributes-default">cookbook-openstack-network-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Set the endpoints for the network service to allow all other cookbooks to
access and use them</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="sx">%w(public internal admin)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">ep_type</span><span class="o">|</span>
  <span class="c1"># openstack identity service endpoints (used by users and services)</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'scheme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">''</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9696</span>
  <span class="c1"># web-service (e.g. apache) listen address (can be different from openstack</span>
  <span class="c1"># network endpoints)</span>
<span class="k">end</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9696</span>
</code></pre>
</div>

<p>trigger the usage of syslog (will include the proper recipe to create a log
config)</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># Name of the plugin to load</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'identity-api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2.0'</span>
<span class="c1"># Set dbsync command timeout value</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'dbsync_timeout'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3600</span>
<span class="c1"># Specify policy.json remote filwe to import</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'policyfile_url'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="c1"># Gets set in the Network Endpoint when registering with Keystone</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'service_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'service_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'network'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'description'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'OpenStack Networking service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'rabbit_server_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'rabbitmq-server'</span>
<span class="c1"># Keystone PKI signing directory.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'cache_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/neutron/api'</span>
<span class="c1"># The bridging interface driver.</span>
<span class="c1"># This is used by the L3, DHCP and LBaaS agents.</span>
<span class="c1"># Options are:</span>
<span class="c1">#</span>
<span class="c1">#   - neutron.agent.linux.interface.OVSInterfaceDriver</span>
<span class="c1">#   - neutron.agent.linux.interface.BridgeInterfaceDriver</span>
<span class="c1">#</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'interface_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron.agent.linux.interface.OVSInterfaceDriver'</span>
<span class="c1"># The agent can use other DHCP drivers.  Dnsmasq is the simplest and requires</span>
<span class="c1"># no additional setup of the DHCP server.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'dhcp_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron.agent.linux.dhcp.Dnsmasq'</span>
<span class="c1"># Version for connection to nova</span>
<span class="c1"># TODO: (MRV) Need to allow for this in Common.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'nova'</span><span class="p">][</span><span class="s1">'url_version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/v2'</span>
</code></pre>
</div>

<p>============================= rootwrap Configuration ===================
use neutron root wrap</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'use_rootwrap'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="c1"># rootwrap.conf</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'filters_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/neutron/rootwrap.d,/usr/share/neutron/rootwrap'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'exec_dirs'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/sbin,/usr/sbin,/bin,/usr/bin'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'use_syslog'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'syslog_log_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'syslog'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'syslog_log_level'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ERROR'</span>
<span class="k">end</span>
</code></pre>
</div>

<p>============================= dnsmasq Configuration ===================
TODO: (jklare) this should be refactored and probably pull in the some dnsmasq
cookbook to do the proper configuration
the version of dnsmasq for centos 6.5 is two revs behind where the dhcp-agent needs
to run properly. This is a version that allows and starts the dhcp-agent correctly.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'dnsmasq'</span><span class="p">][</span><span class="s1">'rpm_version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'2.65-1.el6.rfx.x86_64'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'dnsmasq'</span><span class="p">][</span><span class="s1">'rpm_source'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"http://pkgs.repoforge.org/dnsmasq/dnsmasq-</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'dnsmasq'</span><span class="p">][</span><span class="s1">'rpm_version'</span><span class="p">]</span><span class="si">}</span><span class="s2">.rpm"</span>
<span class="c1"># Upstream resolver to use</span>
<span class="c1"># This will be used by dnsmasq to resolve recursively</span>
<span class="c1"># but will not be used if the tenant specifies a dns</span>
<span class="c1"># server in their subnet</span>
<span class="c1">#</span>
<span class="c1"># Defaults are spread out across multiple, presumably</span>
<span class="c1"># reliable, upstream providers</span>
<span class="c1">#</span>
<span class="c1"># 8.8.8.8 is Google</span>
<span class="c1"># 209.244.0.3 is Level3</span>
<span class="c1">#</span>
<span class="c1"># May be a comma separated list of servers</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'dnsmasq'</span><span class="p">][</span><span class="s1">'upstream_dns_servers'</span><span class="p">]</span> <span class="o">=</span> <span class="sx">%w(8.8.8.8 209.244.0.3)</span>
</code></pre>
</div>

<p>============================= DHCP Agent Configuration ===================</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_dhcp'</span><span class="p">][</span><span class="s1">'config_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/neutron/dhcp_agent.ini'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_dhcp'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'interface_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron.agent.linux.interface.OVSInterfaceDriver'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'dnsmasq_config_file '</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/neutron/dnsmasq.conf'</span>
<span class="k">end</span>
</code></pre>
</div>

<p>============================= L3 Agent Configuration =====================</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_l3'</span><span class="p">][</span><span class="s1">'external_network_bridge_interface'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'eth1'</span>
</code></pre>
</div>

<p>Customize the l3 config file path</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_l3'</span><span class="p">][</span><span class="s1">'config_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/neutron/l3_agent.ini'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_l3'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'interface_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron.agent.linux.interface.OVSInterfaceDriver'</span>
  <span class="c1"># Name of bridge used for external network traffic. This should be set to</span>
  <span class="c1"># empty value for the linux bridge. When external_network_bridge is empty or nil,</span>
  <span class="c1"># creation of external bridge will be skipped in the recipe.</span>
  <span class="c1"># Interface to use for external bridge.</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'external_network_bridge'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'br-ex'</span>
<span class="k">end</span>
</code></pre>
</div>

<p>============================= Metadata Agent Configuration ===============</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_metadata'</span><span class="p">][</span><span class="s1">'config_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/neutron/metadata_agent.ini'</span>
<span class="c1"># The name of the secret databag containing the metadata secret</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_metadata'</span><span class="p">][</span><span class="s1">'secret_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron_metadata_secret'</span>
<span class="n">node</span><span class="p">.</span><span class="nf">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_metadata'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre>
</div>

<p>============================= Metering Agent Configuration ===============</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_metering'</span><span class="p">][</span><span class="s1">'config_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/neutron/metering_agent.ini'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_metering'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'interface_driver'</span><span class="p">]</span> <span class="o">=</span>
    <span class="s1">'neutron.agent.linux.interface.OVSInterfaceDriver'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'driver'</span><span class="p">]</span> <span class="o">=</span>
    <span class="s1">'neutron.services.metering.drivers.iptables.iptables_driver.IptablesMeteringDriver'</span>
<span class="k">end</span>
</code></pre>
</div>

<p>============================= VPN Agent Configuration ====================
vpn_device_driver_packages in platform-specific settings is used to get driver dependencies installed, default is openswan
vpn_device_driver_services in platform-specific settings is used to enable services required by vpn drivers, default is ipsec
Set to true to enable vpnaas</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_vpnaas'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># Custom the vpnaas config file path</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_vpnaas'</span><span class="p">][</span><span class="s1">'config_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/neutron/vpn_agent.ini'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_vpnaas'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="c1"># VPN device drivers which vpn agent will use</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'interface_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron.agent.linux.interface.OVSInterfaceDriver'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'vpnagent'</span><span class="p">][</span><span class="s1">'vpn_device_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron_vpnaas.services.vpn.device_drivers.ipsec.OpenSwanDriver'</span>
  <span class="c1"># Status check interval for ipsec vpn</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'ipsec'</span><span class="p">][</span><span class="s1">'ipsec_status_check_interval'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">60</span>
  <span class="c1"># default_config_area settings is used to set the area where default StrongSwan configuration files are located</span>
  <span class="k">case</span> <span class="n">platform_family</span>
  <span class="k">when</span> <span class="s1">'fedora'</span><span class="p">,</span> <span class="s1">'rhel'</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'strongswan'</span><span class="p">][</span><span class="s1">'default_config_area'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/usr/share/strongswan/templates/config/strongswan.d'</span>
  <span class="k">when</span> <span class="s1">'debian'</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'strongswan'</span><span class="p">][</span><span class="s1">'default_config_area'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/strongswan.d'</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>============================= LBaaS Agent Configuration ==================
Set to true to enable lbaas</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_lbaas'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># Custom the lbaas config file path</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_lbaas'</span><span class="p">][</span><span class="s1">'config_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/neutron/lbaas_agent.ini'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_lbaas'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'periodic_interval'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'ovs_use_veth'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'interface_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron.agent.linux.interface.OVSInterfaceDriver'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'device_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron_lbaas.services.loadbalancer.drivers.haproxy.namespace_driver.HaproxyNSDriver'</span>
  <span class="k">case</span> <span class="n">platform_family</span>
  <span class="k">when</span> <span class="s1">'fedora'</span><span class="p">,</span> <span class="s1">'rhel'</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'haproxy'</span><span class="p">][</span><span class="s1">'user_group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nobody'</span>
  <span class="k">when</span> <span class="s1">'debian'</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'haproxy'</span><span class="p">][</span><span class="s1">'user_group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nogroup'</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>============================= FWaaS Configuration ==================
TODO(jklare) : check why the package is installed and if the configuration
works at all (if so, this needs refactoring parallel to the lbaas and vpnaas
recipes and attributes)
Set to True to enable firewall service</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_fwaas'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># Firewall service driver with linux iptables</span>
<span class="c1"># default['openstack']['network']['fwaas']['driver'] = 'neutron_fwaas.services.firewall.drivers.linux.iptables_fwaas.IptablesFwaasDriver'</span>
<span class="c1"># Custom the fwaas config file path</span>
<span class="c1"># default['openstack']['network']['fwaas']['config_file'] = '/etc/neutron/fwaas_driver.ini'</span>

<span class="o">=============================</span> <span class="n">platform</span><span class="o">-</span><span class="n">specific</span> <span class="n">settings</span> <span class="o">===========</span>

<span class="sb">``` ruby
default['openstack']['network']['platform'].tap do |platform|
  platform['user'] = 'neutron'
  platform['group'] = 'neutron'
  platform['vpn_device_driver_packages'] =
    %w(openswan)
  platform['neutron_dhcp_agent_service'] =
    'neutron-dhcp-agent'
  platform['neutron_l3_agent_service'] =
    'neutron-l3-agent'
  platform['neutron_vpn_agent_service'] =
    'neutron-vpn-agent'
  platform['vpn_device_driver_services'] =
    %w(ipsec)
  platform['neutron_lb_agent_service'] =
    'neutron-lbaas-agent'
  platform['neutron_metadata_agent_service'] =
    'neutron-metadata-agent'
  platform['neutron_metering_agent_service'] =
    'neutron-metering-agent'
  platform['neutron_server_service'] =
    'neutron-server'
  platform['neutron_lbaas_python_dependencies'] =
    %w(python-neutron-lbaas)
  platform['neutron_vpnaas_python_dependencies'] =
    %w(python-neutron-vpnaas)
  case platform_family
  when 'fedora', 'rhel' # :pragma-foodcritic: ~FC024 - won't fix this
    platform['neutron_packages'] =
      %w(openstack-neutron openstack-neutron-ml2 iproute)
    platform['neutron_client_packages'] =
      %w(python-neutronclient)
    platform['neutron_dhcp_packages'] =
      %w(openstack-neutron iproute)
    platform['neutron_l3_packages'] =
      %w(openstack-neutron iproute radvd keepalived)
    platform['neutron_plugin_package'] =
      'neutron-plugin-ml2'
    # openstack-neutron-fwaas
    platform['neutron_vpnaas_packages'] =
      %w(openstack-neutron-vpnaas iproute)
    platform['neutron_lbaas_packages'] =
      %w(openstack-neutron-lbaas haproxy iproute)
    platform['neutron_openvswitch_packages'] =
      %w(openvswitch)
    platform['neutron_openvswitch_agent_packages'] =
      %w(openstack-neutron-openvswitch iproute)
    platform['neutron_linuxbridge_agent_packages'] =
      %w(openstack-neutron-linuxbridge iproute)
    platform['neutron_linuxbridge_agent_service'] =
      %w(neutron-plugin-linuxbridge-agent)
    platform['neutron_metadata_agent_packages'] =
      %w()
    platform['neutron_metering_agent_packages'] =
      %w(openstack-neutron-metering-agent)
    platform['neutron_server_packages'] =
      %w()
    platform['neutron_openvswitch_service'] =
      'openvswitch'
    platform['neutron_openvswitch_agent_service'] =
      'neutron-openvswitch-agent'
    platform['package_overrides'] =
      ''
  when 'debian'
    platform['neutron_packages'] =
      %w(neutron-common python-pyparsing python-cliff)
    platform['neutron_client_packages'] =
      %w(python-neutronclient python-pyparsing)
    platform['neutron_dhcp_packages'] =
      %w(neutron-dhcp-agent)
    platform['neutron_l3_packages'] =
      %w(neutron-l3-agent radvd keepalived)
    # python-neutron-fwaas
    platform['neutron_vpnaas_packages'] =
      %w(python-neutron-vpnaas neutron-vpn-agent)
    platform['neutron_lbaas_packages'] =
      %w(python-neutron-lbaas neutron-lbaas-agent haproxy)
    platform['neutron_openvswitch_packages'] =
      %w(openvswitch-switch openvswitch-datapath-dkms bridge-utils)
    platform['neutron_openvswitch_build_packages'] =
      %w(
        build-essential pkg-config fakeroot
        libssl-dev openssl debhelper
        autoconf dkms python-all
        python-qt4 python-zopeinterface
        python-twisted-conch
      )
    platform['neutron_openvswitch_agent_packages'] =
      %w(neutron-openvswitch-agent)
    platform['neutron_linuxbridge_agent_packages'] =
      %w(neutron-plugin-linuxbridge neutron-plugin-linuxbridge-agent)
    platform['neutron_linuxbridge_agent_service'] =
      'neutron-plugin-linuxbridge-agent'
    platform['neutron_metadata_agent_packages'] =
      %w(neutron-metadata-agent)
    platform['neutron_metering_agent_packages'] =
      %w(neutron-metering-agent)
    platform['neutron_server_packages'] =
      %w(neutron-server)
    platform['neutron_openvswitch_service'] =
      'openvswitch-switch'
    platform['neutron_openvswitch_agent_service'] =
      'neutron-openvswitch-agent'
    platform['package_overrides'] =
      "-o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef'"
  end
end
</span></code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-network-attributes-neutronconf">cookbook-openstack-network-attributes-neutron_conf</h3>

<p><a href="#contents">back to top</a></p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'conf_secrets'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="c1"># [DEFAULT] section</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_config_append'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack/logging.conf'</span>
  <span class="k">else</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/neutron'</span>
  <span class="k">end</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'core_plugin'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ml2'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'rpc_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [agent] section</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'use_rootwrap'</span><span class="p">]</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'agent'</span><span class="p">][</span><span class="s1">'root_helper'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'sudo neutron-rootwrap /etc/neutron/rootwrap.conf'</span>
  <span class="k">end</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [keystone_authtoken] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'auth_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'region_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [nova] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'nova'</span><span class="p">][</span><span class="s1">'auth_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'nova'</span><span class="p">][</span><span class="s1">'region_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'nova'</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nova'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'nova'</span><span class="p">][</span><span class="s1">'tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [oslo_concurrency] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'oslo_concurrency'</span><span class="p">][</span><span class="s1">'lock_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/lib/neutron/lock'</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-object-storage">cookbook-openstack-object-storage</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-object-storage-readme">cookbook-openstack-object-storage-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-9">Description</h1>

<p>Installs the OpenStack Object Storage service <strong>Swift</strong> as part of the OpenStack reference deployment Chef for OpenStack. The http://github.com/openstack/chef-openstack-repo contains documentation for using this cookbook in the context of a full OpenStack deployment. Swift is currently installed from packages.</p>

<p>https://wiki.openstack.org/wiki/Swift</p>

<h1 id="requirements-10">Requirements</h1>

<h2 id="clients">Clients</h2>

<ul>
  <li>CentOS &gt;= 7</li>
  <li>Ubuntu &gt;= 14.04</li>
</ul>

<h2 id="chef">Chef</h2>

<ul>
  <li>12</li>
</ul>

<h2 id="dependent-cookbooks">Dependent Cookbooks</h2>

<ul>
  <li>openstack-common</li>
  <li>openstack-identity</li>
  <li>memcached</li>
  <li>statsd</li>
</ul>

<h1 id="roles">Roles</h1>

<ul>
  <li>swift-account-server - storage node for account data</li>
  <li>swift-container-server - storage node for container data</li>
  <li>swift-management-server - responsible for ring generation</li>
  <li>swift-object-server - storage node for object server</li>
  <li>swift-proxy-server - proxy for swift storage nodes</li>
  <li>swift-setup - server responsible for generating initial settings</li>
</ul>

<p>The swift-management-server role performs the following functions:</p>

<ul>
  <li>proxy node that knows super admin password</li>
  <li>ring repository and ring building workstation</li>
  <li>generally always has the swift-setup role too</li>
  <li>there can only be <em>one</em> swift-management-server</li>
</ul>

<p>There <em>must</em> be a node with the the swift-management-server role to act
as the ring repository.</p>

<p>In small environments, it is likely that all storage machines will
have all-in-one roles, with a load balancer ahead of it</p>

<p>In larger environments, where it is cost effective to split the proxy
and storage layer, storage nodes will carry
swift-{account,container,object}-server roles, and there will be
dedicated hosts with the swift-proxy-server role.</p>

<p>In really really huge environments, it’s possible that the storage
node will be split into swift-{container,account}-server nodes and
swift-object-server nodes.</p>

<h1 id="recipes-7">Recipes</h1>

<h2 id="client">client</h2>
<ul>
  <li>Install the swift client packages</li>
</ul>

<h1 id="attributes-10">Attributes</h1>

<p>There are other attributes that must be set depending on authmode.
For “swauth”, the following attributes are used:</p>

<ul>
  <li><code class="highlighter-rouge">default[:swift][:authkey]</code> - swauth super admin key if using swauth (defaults to test)</li>
</ul>

<p>The following secrets can be defined in the databag defined in Common [‘openstack’][‘secret’][‘secrets_data_bag’]</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="w">        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"swift_hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1a7c0568fa84"</span><span class="w">
          </span><span class="s2">"swift_authkey"</span><span class="err">:</span><span class="w"> </span><span class="s2">"keY4all"</span><span class="w">
          </span><span class="s2">"dispersion_auth_user"</span><span class="err">:</span><span class="w"> </span><span class="s2">"ops:dispersion"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"dispersion_auth_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dispersionpass"</span><span class="w">
        </span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>In addition, because swift is typically deployed as a cluster
there are some attributes used to find interfaces and ip addresses
on storage nodes:</p>

<ul>
  <li><code class="highlighter-rouge">default[:swift][:git_builder_ip]</code> - the IP address of the management server which other cluster members will use as their git pull target for ring updates (defaults to 127.0.0.1)</li>
  <li><code class="highlighter-rouge">default[:swift][:network][:proxy-bind-ip]</code> - the IP address to bind to
on the proxy servers (defaults to 0.0.0.0 for all addresses)</li>
  <li><code class="highlighter-rouge">default[:swift][:network][:proxy-bind-port]</code> - the port to bind to
on the proxy servers (defaults to 8080)</li>
  <li><code class="highlighter-rouge">default[:swift][:network][:account-bind-ip]</code> - the IP address to bind to
on the account servers (defaults to 0.0.0.0 for all addresses)</li>
  <li><code class="highlighter-rouge">default[:swift][:network][:account-bind-port]</code> - the port to bind to
on the account servers (defaults to 6002)</li>
  <li><code class="highlighter-rouge">default[:swift][:network][:container-bind-ip]</code> - the IP address to bind to
on the container servers (defaults to 0.0.0.0 for all addresses)</li>
  <li><code class="highlighter-rouge">default[:swift][:network][:container-bind-port]</code> - the port to bind to
on the container servers (defaults to 6002)</li>
  <li><code class="highlighter-rouge">default[:swift][:network][:object-bind-ip]</code> - the IP address to bind to
on the object servers (defaults to 0.0.0.0 for all addresses)</li>
  <li><code class="highlighter-rouge">default[:swift][:network][:object-bind-port]</code> - the port to bind to
on the container servers (defaults to 6002)</li>
  <li><code class="highlighter-rouge">default[:swift][:network][:object-cidr]</code> - the CIDR network for your object
servers in order to build the ring (defaults to 10.0.0.0/24)</li>
</ul>

<h1 id="proxy-plugins">Proxy Plugins</h1>

<h2 id="formpost">Formpost</h2>

<ul>
  <li><code class="highlighter-rouge">default[:swift][:formpost][:enabled]</code> - optionally enable the formpost proxy plugin (defaults to false)</li>
</ul>

<h2 id="tempurl">TempURL</h2>

<ul>
  <li><code class="highlighter-rouge">default[:swift][:tempurl][:enabled]</code> - optionally enable the tempurl proxy plugin (defaults to false)</li>
  <li><code class="highlighter-rouge">default[:swift][:tempurl][:incoming_remove_headers]</code> - The headers to remove from incoming requests (defaults to x-timestamp)</li>
  <li><code class="highlighter-rouge">default[:swift][:tempurl][:incoming_allow_headers]</code> - The headers allowed as exceptions to incoming_remove_headers (defaults to empty string)</li>
  <li><code class="highlighter-rouge">default[:swift][:tempurl][:incoming_allow_headers]</code> - The headers allowed as exceptions to incoming_remove_headers (defaults to empty string)</li>
  <li><code class="highlighter-rouge">default[:swift][:tempurl][:outgoing_remove_headers]</code> - The headers to remove from outgoing responses (defaults to x-object-meta-*)</li>
  <li><code class="highlighter-rouge">default[:swift][:tempurl][:outgoing_allow_headers]</code> - The headers allowed as exceptions to outgoing_remove_headers (defaults x-object-meta-public-*)</li>
</ul>

<h2 id="domain-remap">Domain Remap</h2>

<ul>
  <li><code class="highlighter-rouge">default[:swift][:domain_remap][:enabled]</code> - optionally enable the domain remap proxy plugin (defaults to false)</li>
  <li><code class="highlighter-rouge">default[:swift][:domain_remap][:storage_domain]</code> - The domain remap reseller domain (defaults to example.com)</li>
  <li><code class="highlighter-rouge">default[:swift][:domain_remap][:root_path]</code> - The domain remap root path (defaults to v1)</li>
  <li><code class="highlighter-rouge">default[:swift][:domain_remap][:reseller_prefixes]</code> - The domain remap reseller prefixes (defaults to AUTH)</li>
</ul>

<h2 id="staticweb">Staticweb</h2>

<ul>
  <li><code class="highlighter-rouge">default[:swift][:staticweb][:enabled]</code> - optionally enable the staticweb proxy plugin (defaults to false)</li>
  <li><code class="highlighter-rouge">default[:swift][:staticweb][:cache_timeout]</code> - Seconds to cache container x-container-meta-web-* header values (defaults to 300)</li>
</ul>

<h1 id="examples-2">Examples</h1>

<h2 id="example-environment">Example environment</h2>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"default_attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"swift"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"swift_hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"107c0568ea84"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"authmode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"swauth"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"authkey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"auto_rebuild_rings"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nt">"git_builder_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.0.0.10"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"swauth"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://10.0.0.10:8080/v1/"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"swift"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"chef_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"environment"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"json_class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Chef::Environment"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>This sets up defaults for a swauth-based cluster with the storage
network on 10.0.0.0/24.</p>

<h2 id="standalone-storage-server">Standalone Storage Server</h2>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"swift-object-server"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"json_class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Chef::Role"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"run_list"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"recipe[swift::object-server]"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A storage server role."</span><span class="p">,</span><span class="w">
  </span><span class="nt">"chef_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"role"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h2 id="standalone-proxy-server">Standalone Proxy Server</h2>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="w">  </span><span class="s2">"run_list"</span><span class="err">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"role[swift-proxy-server]"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span></code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-object-storage-attributes-default">cookbook-openstack-object-storage-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'service_tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'service_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'swift'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'service_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
</code></pre>
</div>

<p>Default swift user</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'swift'</span>
<span class="c1"># Default swift group</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'swift'</span>
<span class="c1"># Default region</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
</code></pre>
</div>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
"</span>
</code></pre>
</div>

<hr />
<p>node/ring settings
——————–</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'state'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c1"># Hour to run swift_auditor on storage nodes</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'audit_hour'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'5'</span>
<span class="c1">#  Eval-able expression that lists</span>
<span class="c1">#   candidate disk nodes for disk probing.  The result should be a hash</span>
<span class="c1">#   with keys being the device name (without the leading "/dev/") and a</span>
<span class="c1">#   hash block of any extra info associated with the device.  For</span>
<span class="c1">#   example: { "sdc" =&gt; { "model": "Hitachi 7K3000" }}.  Largely,</span>
<span class="c1">#   though, if you are going to make a list of valid devices, you</span>
<span class="c1">#   probably know all the valid devices, and don't need to pass any</span>
<span class="c1">#   metadata about them, so { "sdc" =&gt; {}} is probably enough.  Example</span>
<span class="c1">#   expression: Hash[('a'..'f').to_a.collect{|x| [ "sd{x}", {} ]}]</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'disk_enum_expr'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'node[:block_device]'</span>
<span class="c1"># Flag to rebuild rings</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'auto_rebuild_rings'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># ip for git builder</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'git_builder_ip'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="c1"># How many server changes require before a rebalance is done</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'wait_for'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre>
</div>

<p>swift_hash_path_suffix and swift_hash_path_prefix are used as part of the
the hashing algorithm when determining data placement in the cluster.
These values should remain secret and MUST NOT change
once a cluster has been deployed.
Deprecated in juno, use swift_hash_path_prefix</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swift_hash'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="c1"># A value of nil will get the hash from the get_password library method in common</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swift_hash_path_prefix'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swift_hash'</span><span class="p">]</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swift_hash_path_suffix'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>The swift-constraints section sets the basic constraints on data
saved in the swift cluster. These constraints are automatically
published by the proxy server in responses to /info requests.
max_file_size is the largest “normal” object that can be saved in
the cluster. This is also the limit on the size of each segment of
a “large” object when using the large object manifest support.
This value is set in bytes. Setting it to lower than 1MiB will cause
some tests to fail. It is STRONGLY recommended to leave this value at
the default (5 * 2**30 + 2).</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'max_file_size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5368709122</span>
<span class="c1"># max_meta_name_length is the max number of bytes in the utf8 encoding</span>
<span class="c1"># of the name portion of a metadata header.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'max_meta_name_length'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">128</span>
<span class="c1"># max_meta_value_length is the max number of bytes in the utf8 encoding</span>
<span class="c1"># of a metadata value</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'max_meta_value_length'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">256</span>
<span class="c1"># max_meta_count is the max number of metadata keys that can be stored</span>
<span class="c1"># on a single account, container, or object</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'max_meta_count'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">90</span>
<span class="c1"># max_meta_overall_size is the max number of bytes in the utf8 encoding</span>
<span class="c1"># of the metadata (keys + values)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'max_meta_overall_size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4096</span>
<span class="c1"># max_header_size is the max number of bytes in the utf8 encoding of each</span>
<span class="c1"># header. Using 8192 as default because eventlet use 8192 as max size of</span>
<span class="c1"># header line. This value may need to be increased when using identity</span>
<span class="c1"># v3 API tokens including more than 7 catalog entries.</span>
<span class="c1"># See also include_service_catalog in proxy-server.conf-sample</span>
<span class="c1"># (documented in overview_auth.rst)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'max_header_size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8192</span>
<span class="c1"># max_object_name_length is the max number of bytes in the utf8 encoding</span>
<span class="c1"># of an object name</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'max_object_name_length'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="c1"># container_listing_limit is the default (and max) number of items</span>
<span class="c1"># returned for a container listing request</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container_listing_limit'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="c1"># account_listing_limit is the default (and max) number of items returned</span>
<span class="c1"># for an account listing request</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'account_listing_limit'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="c1"># max_account_name_length is the max number of bytes in the utf8 encoding</span>
<span class="c1"># of an account name</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'max_account_name_length'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">256</span>
<span class="c1"># max_container_name_length is the max number of bytes in the utf8 encoding</span>
<span class="c1"># of a container name</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'max_container_name_length'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">256</span>
</code></pre>
</div>

<p>Use the openstack-common cookbook databags with the
following keys:
secret tokens
“swift_hash_path_prefix”
“swift_hash_path_suffix”
“swift_authkey”
“dispersion_auth_key”
“dispersion_auth_user”
The follow swift specific databag support is DEPRECATED.
we support an optional secret databag where we will retrieve the
following attributes overriding any default attributes here</p>

<p>{
“swift_hash”: “107c0568ea84”
“swift_authkey”: “keW4all”
“dispersion_auth_user”: “test:test”,
“dispersion_auth_key”: “test”
}</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swift_secret_databag_name'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<hr />
<p>roles
——————–</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'setup_chef_role'</span><span class="p">]</span>             <span class="o">=</span> <span class="s1">'os-object-storage-setup'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'management_server_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-object-storage-management'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'proxy_server_chef_role'</span><span class="p">]</span>      <span class="o">=</span> <span class="s1">'os-object-storage-proxy'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'object_server_chef_role'</span><span class="p">]</span>     <span class="o">=</span> <span class="s1">'os-object-storage-object'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'account_server_chef_role'</span><span class="p">]</span>    <span class="o">=</span> <span class="s1">'os-object-storage-account'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container_server_chef_role'</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">'os-object-storage-container'</span>
</code></pre>
</div>

<hr />
<p>authentication
——————–
Authenitcation mode, either keystone or swauth</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'authmode'</span><span class="p">]</span>              <span class="o">=</span> <span class="s1">'keystone'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'authkey'</span><span class="p">]</span>               <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swift_url'</span><span class="p">]</span>             <span class="o">=</span> <span class="s1">'http://127.0.0.1:8080/v1/'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swauth_url'</span><span class="p">]</span>            <span class="o">=</span> <span class="s1">'http://127.0.0.1:8080/v1/'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'auth_url'</span><span class="p">]</span>              <span class="o">=</span> <span class="s1">'http://127.0.0.1:8080/auth/v1.0'</span>
<span class="c1"># Keystone version</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span>
<span class="c1"># Keystone PKI signing directory</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'cache_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/swift/api'</span>
</code></pre>
</div>

<hr />
<p>dispersion settings
———————</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'dispersion'</span><span class="p">][</span><span class="s1">'auth_user'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'dispersion'</span><span class="p">][</span><span class="s1">'auth_key'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>settings for the swift ring - these default settings are
a safe setting for testing but part_power should be set to
26 in production to allow a swift cluster with 50,000 spindles</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'ring'</span><span class="p">][</span><span class="s1">'part_power'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">18</span>
<span class="c1"># The minimum number of hours before swift is allowed to migrate a partition</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'ring'</span><span class="p">][</span><span class="s1">'min_part_hours'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1"># How many replicas swift should retain</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'ring'</span><span class="p">][</span><span class="s1">'replicas'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="c1"># Zone, will look like "z1" on swift-ring-builder command line</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'ring'</span><span class="p">][</span><span class="s1">'zone'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'1'</span>
<span class="c1"># Region, will look like "r1" on swift-ring-builder command line</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'ring'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'1'</span>
</code></pre>
</div>

<hr />
<p>statistics
——————
Current statsd cookbook is not supported on rhel platforms</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="n">platform_family?</span><span class="p">(</span><span class="s1">'debian'</span><span class="p">)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'sample_rate'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre>
</div>

<p>there are two ways to discover your graphite server ip for
statsd to periodically publish to.  You can directly set
the ip below, or leave it set to nil and supply chef with
the role name of your graphite server and the interface
name to retrieve the appropriate internal ip address from</p>

<p>if no servers with the role below can be found then
127.0.0.1 will be used</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'graphing_ip'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'graphing_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'graphite-role'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'graphing_interface'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'eth0'</span>
</code></pre>
</div>

<p>how frequently to run chef instantiated /usr/local/bin/swift_statsd_publish.py
which publishes dispersion and recon statistics (in minutes)</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'report_frequency'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
</code></pre>
</div>

<p>enable or disable specific portions of generated report</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'enable_dispersion_report'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'enable_recon_report'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'enable_disk_report'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<p>settings for statsd which should be configured to use the local
statsd daemon that chef will install if statistics are enabled</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'statsd_host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'statsd_port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'8125'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'statsd_prefix'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'openstack.swift'</span>
</code></pre>
</div>

<p>paths to the recon cache files</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'recon_account_cache'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/swift/account.recon'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'recon_container_cache'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/swift/container.recon'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'recon_object_cache'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/swift/object.recon'</span>
</code></pre>
</div>

<hr />
<p>network settings
——————
the cidr configuration items are unimportant for a single server
configuration, but in a multi-server setup, the cidr should match
the interface appropriate to that service as they are used to
resolve the appropriate addresses to use for internode
communication
Deprecated in Juno, use Common attributes instead
proxy servers</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'proxy-bind-ip'</span><span class="p">]</span>            <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'proxy-bind-port'</span><span class="p">]</span>          <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'proxy-cidr'</span><span class="p">]</span>               <span class="o">=</span> <span class="s1">'127.0.0.0/8'</span>
</code></pre>
</div>

<p>account servers</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'account-bind-ip'</span><span class="p">]</span>          <span class="o">=</span> <span class="s1">'0.0.0.0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'account-bind-port'</span><span class="p">]</span>        <span class="o">=</span> <span class="s1">'6002'</span>
</code></pre>
</div>

<p>container servers</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'container-bind-ip'</span><span class="p">]</span>        <span class="o">=</span> <span class="s1">'0.0.0.0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'container-bind-port'</span><span class="p">]</span>      <span class="o">=</span> <span class="s1">'6001'</span>
</code></pre>
</div>

<p>object servers</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'object-bind-ip'</span><span class="p">]</span>           <span class="o">=</span> <span class="s1">'0.0.0.0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'object-bind-port'</span><span class="p">]</span>         <span class="o">=</span> <span class="s1">'6000'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'object-cidr'</span><span class="p">]</span>              <span class="o">=</span> <span class="s1">'127.0.0.0/8'</span>
</code></pre>
</div>

<hr />
<p>sysctl
——————
set sysctl properties for time waits</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'sysctl'</span><span class="p">][</span><span class="s1">'net.ipv4.tcp_tw_recycle'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'sysctl'</span><span class="p">][</span><span class="s1">'net.ipv4.tcp_tw_reuse'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'sysctl'</span><span class="p">][</span><span class="s1">'net.ipv4.tcp_syncookies'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre>
</div>

<p>N.B. conntrack_max may also need to be adjusted if
server is running a stateful firewall
——————
disk search
——————
disk_test_filter is an array of predicates to test against disks to
determine if a disk should be formatted and configured for swift.
Each predicate is evaluated in turn, and a false from the predicate
will result in the disk not being considered as a candidate for
formatting.
Each rule gets evaluated with “candidate” set to the device name
without the leading “/dev/”) and info set to the node hash value.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'disk_test_filter'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s1">'candidate =~ /(sd|hd|xvd|vd)(?!a$)[a-z]+/'</span><span class="p">,</span>
  <span class="s2">"File.exist?('/dev/' + candidate)"</span><span class="p">,</span>
  <span class="s2">"not system('/sbin/parted /dev/' + candidate + ' -s print | grep linux-swap')"</span><span class="p">,</span>
  <span class="s2">"not info.has_key?('removable') or info['removable'] == 0.to_s"</span><span class="p">]</span>
</code></pre>
</div>

<hr />
<p>template overrides
——————-
account-server
Use an integer to override the number of pre-forked processes that will
accept connections.  Zero means no fork. Should default to the number of
effective cpu cores in the system.  It’s worth noting that individual
workers will # use many eventlet co-routines to service multiple concurrent
requests.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'account-server'</span><span class="p">][</span><span class="s1">'workers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'auto'</span>
</code></pre>
</div>

<p>Maximum number of clients one worker can process simultaneously (it will
actually accept(2) N + 1). Setting this to one (1) will only handle one request
at a time, without accepting another request concurrently.  The default is 1024.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'account-server'</span><span class="p">][</span><span class="s1">'max_clients'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1024</span>
</code></pre>
</div>

<p>Parent directory or where devices are mounted. Default is /srv/node</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'account-server'</span><span class="p">][</span><span class="s1">'devices'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/srv/node'</span>
</code></pre>
</div>

<p>Whether or not check if the devices are mounted to prevent accidentally writing to
the root device. The default is set to true.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'account-server'</span><span class="p">][</span><span class="s1">'mount_check'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<p>proxy-server
Use an integer to override the number of pre-forked processes that will
accept connections.  Zero means no fork. Should default to the number of
effective cpu cores in the system.  It’s worth noting that individual
workers will # use many eventlet co-routines to service multiple concurrent
requests.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'proxy-server'</span><span class="p">][</span><span class="s1">'workers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'auto'</span>
</code></pre>
</div>

<p>Maximum number of clients one worker can process simultaneously (it will
actually accept(2) N + 1). Setting this to one (1) will only handle one request
at a time, without accepting another request concurrently.  The default is 1024.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'proxy-server'</span><span class="p">][</span><span class="s1">'max_clients'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1024</span>
</code></pre>
</div>

<p>Request timeout to external services. The default is 10 seconds.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'proxy-server'</span><span class="p">][</span><span class="s1">'node_timeout'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
</code></pre>
</div>

<p>enable or disable formpost</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'formpost'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>enable or disable tempurl</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'tempurl'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>The headers to remove from incoming requests. Simply a whitespace delimited
list of header names and names can optionally end with ‘*’ to indicate a
prefix match. incoming_allow_headers is a list of exceptions to these
removals.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'tempurl'</span><span class="p">][</span><span class="s1">'incoming_remove_headers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'x-timestamp'</span>
</code></pre>
</div>

<p>The headers allowed as exceptions to incoming_remove_headers. Simply a
whitespace delimited list of header names and names can optionally end with
‘*’ to indicate a prefix match.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'tempurl'</span><span class="p">][</span><span class="s1">'incoming_allow_headers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">''</span>
</code></pre>
</div>

<p>The headers to remove from outgoing responses. Simply a whitespace delimited
list of header names and names can optionally end with ‘*’ to indicate a
prefix match. outgoing_allow_headers is a list of exceptions to these
removals.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'tempurl'</span><span class="p">][</span><span class="s1">'outgoing_remove_headers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'x-object-meta-*'</span>
</code></pre>
</div>

<p>The headers allowed as exceptions to outgoing_remove_headers. Simply a
whitespace delimited list of header names and names can optionally end with
‘*’ to indicate a prefix match.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'tempurl'</span><span class="p">][</span><span class="s1">'outgoing_allow_headers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'x-object-meta-public-*'</span>
</code></pre>
</div>

<p>enable or disable domain_remap</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'domain_remap'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>enable domain log name</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'domain_remap'</span><span class="p">][</span><span class="s1">'log_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'domain_remap'</span>
</code></pre>
</div>

<p>domain remap log facilty</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'domain_remap'</span><span class="p">][</span><span class="s1">'log_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'LOG_LOCAL0'</span>
</code></pre>
</div>

<p>domain remap log level</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'domain_remap'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
</code></pre>
</div>

<p>domain remap log headers</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'domain_remap'</span><span class="p">][</span><span class="s1">'log_headers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'False'</span>
</code></pre>
</div>

<p>domain remap reseller domain</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'domain_remap'</span><span class="p">][</span><span class="s1">'storage_domain'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'example.com'</span>
</code></pre>
</div>

<p>domain remap root path</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'domain_remap'</span><span class="p">][</span><span class="s1">'path_root'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v1'</span>
</code></pre>
</div>

<p>domain remap reseller prefixes</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'domain_remap'</span><span class="p">][</span><span class="s1">'reseller_prefixes'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'AUTH'</span>
</code></pre>
</div>

<p>whether or not to enable staticweb in the swift proxy</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'staticweb'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>Seconds to cache container x-container-meta-web-* header values.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'staticweb'</span><span class="p">][</span><span class="s1">'cache_timeout'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
</code></pre>
</div>

<p>staticweb logging options</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'staticweb'</span><span class="p">][</span><span class="s1">'log_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'LOG_LOCAL0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'staticweb'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'staticweb'</span><span class="p">][</span><span class="s1">'access_log_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'staticweb'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'staticweb'</span><span class="p">][</span><span class="s1">'access_log_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'LOG_LOCAL0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'staticweb'</span><span class="p">][</span><span class="s1">'access_log_level'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'staticweb'</span><span class="p">][</span><span class="s1">'log_headers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'False'</span>
</code></pre>
</div>

<p>container-server
Use an integer to override the number of pre-forked processes that will
accept connections.  Zero means no fork. Should default to the number of
effective cpu cores in the system.  It’s worth noting that individual
workers will # use many eventlet co-routines to service multiple concurrent
requests.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'workers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'auto'</span>
</code></pre>
</div>

<p>Maximum number of clients one worker can process simultaneously (it will
actually accept(2) N + 1). Setting this to one (1) will only handle one request
at a time, without accepting another request concurrently.  The default is 1024.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'max_clients'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1024</span>
</code></pre>
</div>

<p>Parent directory or where devices are mounted. Default is /srv/node</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'devices'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/srv/node'</span>
</code></pre>
</div>

<p>Whether or not check if the devices are mounted to prevent accidentally writing to
the root device. The default is set to true.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'mount_check'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<p>Override this with an allowed list of your various swift clusters if you wish
to enable container sync for your end-users between clusters.  This should
be an array of fqdn hostnames for the cluster end-points that your end-users
would access in the format of [‘host1’, ‘host2’, ‘host3’]</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'allowed_sync_hosts'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre>
</div>

<p>container-sync logging settings</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'container-sync'</span><span class="p">][</span><span class="s1">'log_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'container-sync'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'container-sync'</span><span class="p">][</span><span class="s1">'log_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'LOG_LOCAL0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'container-sync'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
</code></pre>
</div>

<p>If you need to use an HTTP Proxy, set it here; defaults to no proxy.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'container-sync'</span><span class="p">][</span><span class="s1">'sync_proxy'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Will sync, at most, each container once per interval (in seconds)</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'container-sync'</span><span class="p">][</span><span class="s1">'interval'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
</code></pre>
</div>

<p>Maximum amount of time to spend syncing each container per pass (in seconds)</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'container-sync'</span><span class="p">][</span><span class="s1">'container_time'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">60</span>
</code></pre>
</div>

<p>object-server
Use an integer to override the number of pre-forked processes that will
accept connections.  Zero means no fork. Should default to the number of
effective cpu cores in the system.  It’s worth noting that individual
workers will # use many eventlet co-routines to service multiple concurrent
requests.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'object-server'</span><span class="p">][</span><span class="s1">'workers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'auto'</span>
</code></pre>
</div>

<p>Maximum number of clients one worker can process simultaneously (it will
actually accept(2) N + 1). Setting this to one (1) will only handle one request
at a time, without accepting another request concurrently.  The default is 1024.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'object-server'</span><span class="p">][</span><span class="s1">'max_clients'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1024</span>
</code></pre>
</div>

<p>Parent directory or where devices are mounted. Default is /srv/node</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'object-server'</span><span class="p">][</span><span class="s1">'devices'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/srv/node'</span>
</code></pre>
</div>

<p>Whether or not check if the devices are mounted to prevent accidentally writing to
the root device. The default is set to true.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'object-server'</span><span class="p">][</span><span class="s1">'mount_check'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<p>Time in seconds to wait between replication passes. The default is 30.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'object-server'</span><span class="p">][</span><span class="s1">'replicator'</span><span class="p">][</span><span class="s1">'run_pause'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>
</code></pre>
</div>

<p>Time elapsed in seconds before an object can be reclaimed. The default is
604800 seconds.</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'object-server'</span><span class="p">][</span><span class="s1">'replicator'</span><span class="p">][</span><span class="s1">'reclaim_age'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">604800</span>
</code></pre>
</div>

<hr />
<p>swauth source
—————–
Versions of swauth in Ubuntu Cloud Archive PPA can be outdated. This
allows us to chose to install directly from a tagged branch of
gholt’s repository.
values:  package, git</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swauth_source'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'package'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swauth_repository'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'https://github.com/gholt/swauth.git'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swauth_version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'1.0.8'</span>
</code></pre>
</div>

<hr />
<p>packages
——————
Leveling between distros</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform_family</span>
<span class="k">when</span> <span class="s1">'rhel'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'disk_format'</span> <span class="o">=&gt;</span> <span class="s1">'ext4'</span><span class="p">,</span>
    <span class="s1">'proxy_packages'</span> <span class="o">=&gt;</span> <span class="sx">%w(openstack-swift-proxy sudo cronie python-memcached)</span><span class="p">,</span>
    <span class="s1">'object_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-swift-object'</span><span class="p">,</span> <span class="s1">'sudo'</span><span class="p">,</span> <span class="s1">'cronie'</span><span class="p">],</span>
    <span class="s1">'container_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-swift-container'</span><span class="p">,</span> <span class="s1">'sudo'</span><span class="p">,</span> <span class="s1">'cronie'</span><span class="p">],</span>
    <span class="s1">'account_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-swift-account'</span><span class="p">,</span> <span class="s1">'sudo'</span><span class="p">,</span> <span class="s1">'cronie'</span><span class="p">],</span>
    <span class="s1">'swift_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-swift'</span><span class="p">,</span> <span class="s1">'sudo'</span><span class="p">,</span> <span class="s1">'cronie'</span><span class="p">],</span>
    <span class="s1">'swift_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-swiftclient'</span><span class="p">],</span>
    <span class="s1">'swauth_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-swauth'</span><span class="p">,</span> <span class="s1">'sudo'</span><span class="p">,</span> <span class="s1">'cronie'</span><span class="p">],</span>
    <span class="s1">'rsync_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'rsync'</span><span class="p">],</span>
    <span class="s1">'git_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'xinetd'</span><span class="p">,</span> <span class="s1">'git'</span><span class="p">,</span> <span class="s1">'git-daemon'</span><span class="p">],</span>
    <span class="s1">'service_prefix'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-'</span><span class="p">,</span>
    <span class="s1">'service_suffix'</span> <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,</span>
    <span class="s1">'git_dir'</span> <span class="o">=&gt;</span> <span class="s1">'/var/lib/git'</span><span class="p">,</span>
    <span class="s1">'git_service'</span> <span class="o">=&gt;</span> <span class="s1">'git'</span><span class="p">,</span>
    <span class="s1">'override_options'</span> <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,</span>
    <span class="s1">'swift_statsd_publish'</span> <span class="o">=&gt;</span> <span class="s1">'/usr/bin/swift-statsd-publish.py'</span>
  <span class="p">}</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'disk_format'</span> <span class="o">=&gt;</span> <span class="s1">'xfs'</span><span class="p">,</span>
    <span class="s1">'proxy_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'swift-proxy'</span><span class="p">,</span> <span class="s1">'python-memcache'</span><span class="p">],</span>
    <span class="s1">'object_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'swift-object'</span><span class="p">],</span>
    <span class="s1">'container_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'swift-container'</span><span class="p">],</span>
    <span class="s1">'account_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'swift-account'</span><span class="p">,</span> <span class="s1">'python-swiftclient'</span><span class="p">],</span>
    <span class="s1">'swift_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'swift'</span><span class="p">],</span>
    <span class="s1">'swift_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-swiftclient'</span><span class="p">],</span>
    <span class="s1">'swauth_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'swauth'</span><span class="p">],</span>
    <span class="s1">'rsync_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'rsync'</span><span class="p">],</span>
    <span class="s1">'git_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'git-daemon-sysvinit'</span><span class="p">],</span>
    <span class="s1">'service_prefix'</span> <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,</span>
    <span class="s1">'service_suffix'</span> <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,</span>
    <span class="s1">'git_dir'</span> <span class="o">=&gt;</span> <span class="s1">'/var/cache/git'</span><span class="p">,</span>
    <span class="s1">'git_service'</span> <span class="o">=&gt;</span> <span class="s1">'git-daemon'</span><span class="p">,</span>
    <span class="s1">'override_options'</span> <span class="o">=&gt;</span> <span class="s2">"-o Dpkg::Options:='--force-confold' -o Dpkg::Option:='--force-confdef'"</span><span class="p">,</span>
    <span class="s1">'swift_statsd_publish'</span> <span class="o">=&gt;</span> <span class="s1">'/usr/local/bin/swift-statsd-publish.py'</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-ops-database">cookbook-openstack-ops-database</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-ops-database-readme">cookbook-openstack-ops-database-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-10">Description</h1>

<p>This cookbook provides a reference example of database configuration for the OpenStack deployment provided by Chef for OpenStack. It currently supports MySQL and PostgreSQL.</p>

<h1 id="requirements-11">Requirements</h1>

<p>Chef 11 with Ruby 1.9.x required.</p>

<h1 id="platforms">Platforms</h1>

<ul>
  <li>Ubuntu-14.04</li>
  <li>SLES 11 SP3</li>
  <li>RHEL/CentOS 7.0</li>
</ul>

<h1 id="cookbooks-8">Cookbooks</h1>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>database</li>
  <li>openstack-common</li>
  <li>mysql</li>
  <li>mysql2_chef_gem</li>
  <li>postgresql</li>
</ul>

<h1 id="usage-4">Usage</h1>

<p>The usage of this cookbook is optional, you may choose to set up your own databases without using this cookbook. If you choose to do so, you will need to do the following:</p>

<ul>
  <li>create the schema specified by the <code class="highlighter-rouge">openstack-db</code> recipe.</li>
  <li>create and upload encrypted data bags into your chef environment, as
specified by <code class="highlighter-rouge">#get_password</code> in the <code class="highlighter-rouge">openstack-db</code> recipe.</li>
</ul>

<h1 id="resourcesproviders">Resources/Providers</h1>

<p>None</p>

<h1 id="templates">Templates</h1>

<p>None</p>

<h1 id="recipes-8">Recipes</h1>

<h2 id="client-1">client</h2>

<ul>
  <li>database client configuration, selected by attributes</li>
</ul>

<h2 id="server">server</h2>

<ul>
  <li>database server configuration, selected by attributes</li>
</ul>

<h2 id="mysql-client">mysql-client</h2>

<ul>
  <li>calls mysql::ruby and mysql::client and installs the mysql client python packages</li>
</ul>

<h2 id="mysql-server">mysql-server</h2>

<ul>
  <li>configures the mysql server for OpenStack</li>
</ul>

<h2 id="postgresql-client">postgresql-client</h2>

<ul>
  <li>calls postgresql::ruby and postgresql::client and installs the postgresql client python packages</li>
</ul>

<h2 id="postgresql-server">postgresql-server</h2>

<ul>
  <li>configures the PostgreSQL server for OpenStack</li>
</ul>

<h2 id="openstack-db">openstack-db</h2>

<ul>
  <li>creates necessary tables, users, and grants for OpenStack</li>
</ul>

<h1 id="attributes-11">Attributes</h1>

<p>The following attributes are defined in attributes/database.rb of the common cookbook, but are documented here due to their relevance:</p>

<ul>
  <li><code class="highlighter-rouge">openstack["endpoints"]["db"]["host"]</code> - The IP address to bind the database service to</li>
  <li><code class="highlighter-rouge">openstack["endpoints"]["db"]["scheme"]</code> - Unused at this time</li>
  <li><code class="highlighter-rouge">openstack["endpoints"]["db"]["port"]</code> - The port to bind the database service to</li>
  <li><code class="highlighter-rouge">openstack["endpoints"]["db"]["path"]</code> - Unused at this time</li>
  <li><code class="highlighter-rouge">openstack["endpoints"]["db"]["bind_interface"]</code> - The interface name to bind the database service to</li>
  <li><code class="highlighter-rouge">openstack["db"]["root_user_key"]</code> - The key used to retrieve the root user password; the key is both the name of the data-bag item and
name of the key containing the password value within the data-bag item. This is defined in Common.</li>
</ul>

<p>If the value of the “bind_interface” attribute is non-nil, then the database service will be bound to the first IP address on that interface.  If the value of the “bind_interface” attribute is nil, then the database service will be bound to the IP address specified in the host attribute.</p>

<p>See the attributes mysql.rb file for the mysql specific attributes that are available.</p>

<p>For more information see: http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html</p>

<hr />

<h3 id="cookbook-openstack-ops-database-attributes-default">cookbook-openstack-ops-database-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
'</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-ops-database-attributes-mysql">cookbook-openstack-ops-database-attributes-mysql</h3>

<p><a href="#contents">back to top</a></p>

<p>MySql attributes that we use the mysql cookbook defaults:
Data directory</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'data_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>MySql attributes that we select defaults for:
Version, support 5.5 and above</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'5.5'</span>
<span class="c1"># Service name</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'service_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'default'</span>
<span class="c1"># Storage engine, base OpenStack requires the InnoDB flavor</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'default-storage-engine'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'InnoDB'</span>
<span class="c1"># InnoDB lock mode for generating auto-increment values</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'innodb_autoinc_lock_mode'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'1'</span>
<span class="c1"># InnoDB give each table its own file</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'innodb_file_per_table'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'OFF'</span>
<span class="c1"># InnoDB thread concurrency</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'innodb_thread_concurrency'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'0'</span>
<span class="c1"># InnoDB commit concurrency</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'innodb_commit_concurrency'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'0'</span>
<span class="c1"># InnoDB number of read io threads</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'innodb_read_io_threads'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'4'</span>
<span class="c1"># InnoDB number of commit transactions to flush log</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'innodb_flush_log_at_trx_commit'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'1'</span>
<span class="c1"># InnoDB memory buffer for caching table data and indexes</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'innodb_buffer_pool_size'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'134217728'</span>
<span class="c1"># InnoDB size of each log file in a log group</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'innodb_log_file_size'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'5242880'</span>
<span class="c1"># InnoDB size of buffer for logs</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'innodb_log_buffer_size'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'8388608'</span>
<span class="c1"># Skip name resolution</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'skip-name-resolve'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># Character set</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'character-set-server'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'latin1'</span>
<span class="c1"># Memory allocated for caching query results</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'query_cache_size'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'0'</span>
<span class="c1"># Maximum number of connections</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'max_connections'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'151'</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-ops-messaging">cookbook-openstack-ops-messaging</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-ops-messaging-readme">cookbook-openstack-ops-messaging-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-11">Description</h1>

<p>This cookbook provides shared message queue configuration for the OpenStack deployment provided by Chef for OpenStack. The http://github.com/mattray/chef-openstack-repo contains documentation for using this cookbook in the context of a full OpenStack deployment. It currently supports RabbitMQ and will soon other queues.</p>

<h1 id="requirements-12">Requirements</h1>

<p>Chef 11 with Ruby 1.9.x required.</p>

<h1 id="platforms-1">Platforms</h1>

<ul>
  <li>Ubuntu-14.04</li>
</ul>

<h1 id="cookbooks-9">Cookbooks</h1>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>openstack-common</li>
  <li>rabbitmq</li>
</ul>

<h1 id="usage-5">Usage</h1>

<p>The usage of this cookbook is optional, you may choose to set up your own messaging service without using this cookbook. If you choose to do so, you will need to provide all of the attributes listed under the <a href="#attributes">Attributes</a>.</p>

<h1 id="resourcesproviders-1">Resources/Providers</h1>

<p>None</p>

<h1 id="templates-1">Templates</h1>

<p>None</p>

<h1 id="recipes-9">Recipes</h1>

<h2 id="server-1">server</h2>

<ul>
  <li>message queue server configuration, selected by attributes</li>
</ul>

<h2 id="rabbitmq-server">rabbitmq-server</h2>

<ul>
  <li>configures the RabbitMQ server for OpenStack</li>
</ul>

<h1 id="attributes-12">Attributes</h1>

<ul>
  <li><code class="highlighter-rouge">openstack["mq"]["cluster"]</code> - whether or not to cluster rabbit, defaults to ‘false’</li>
</ul>

<p>The following attributes are defined in attributes/messaging.rb of the common cookbook, but are documented here due to their relevance:</p>

<ul>
  <li><code class="highlighter-rouge">openstack["endpoints"]["mq"]["host"]</code> - The IP address to bind the rabbit service to</li>
  <li><code class="highlighter-rouge">openstack["endpoints"]["mq"]["scheme"]</code> - Unused at this time</li>
  <li><code class="highlighter-rouge">openstack["endpoints"]["mq"]["port"]</code> - The port to bind the rabbit service to</li>
  <li><code class="highlighter-rouge">openstack["endpoints"]["mq"]["path"]</code> - Unused at this time</li>
  <li><code class="highlighter-rouge">openstack["endpoints"]["mq"]["bind_interface"]</code> - The interface name to bind the rabbit service to</li>
  <li><code class="highlighter-rouge">openstack["mq"]["rabbitmq"]["use_ssl"]</code> - Enables/disables SSL for RabbitMQ, the default is false.</li>
</ul>

<p>If the value of the “bind_interface” attribute is non-nil, then the rabbit service will be bound to the first IP address on that interface.  If the value of the “bind_interface” attribute is nil, then the rabbit service will be bound to the IP address specified in the host attribute.</p>

<hr />

<h3 id="cookbook-openstack-ops-messaging-attributes-default">cookbook-openstack-ops-messaging-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'cluster'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>Allow cluster_disk_nodes to be optionally set based upon a node role search.
If set to false, mq cluster nodes can be added on-the-fly using the cluster command.
see https://www.rabbitmq.com/clustering.html</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'search_for_cluster_disk_nodes'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">if</span> <span class="n">platform_family?</span><span class="p">(</span><span class="s1">'debian'</span><span class="p">,</span> <span class="s1">'suse'</span><span class="p">)</span>
  <span class="n">override</span><span class="p">[</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'use_distro_version'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-orchestration">cookbook-openstack-orchestration</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-orchestration-readme">cookbook-openstack-orchestration-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-12">Description</h1>

<p>This cookbook installs the OpenStack Heat service <strong>Heat</strong> as part of an
OpenStack reference deployment Chef for OpenStack.</p>

<p>https://wiki.openstack.org/wiki/Heat</p>

<h1 id="requirements-13">Requirements</h1>

<ul>
  <li>Chef 12 or higher</li>
  <li>chefdk 0.9.0 for testing (also includes berkshelf for cookbook dependency
resolution)</li>
</ul>

<h1 id="platform-7">Platform</h1>

<ul>
  <li>ubuntu</li>
  <li>redhat</li>
  <li>centos</li>
</ul>

<h1 id="cookbooks-10">Cookbooks</h1>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>‘openstack-common’, ‘&gt;= 13.0.0’</li>
  <li>‘openstack-identity’, ‘&gt;= 13.0.0’</li>
</ul>

<h1 id="attributes-13">Attributes</h1>

<p>Please see the extensive inline documentation in <code class="highlighter-rouge">attributes/*.rb</code> for
descriptions of all the settable attributes for this cookbook.</p>

<p>Note that all attributes are in the <code class="highlighter-rouge">default['openstack']</code> “namespace”</p>

<p>The usage of attributes to generate the heat.conf is decribed in the
openstack-common cookbook.</p>

<h1 id="recipes-10">Recipes</h1>

<h2 id="openstack-orchestrationapi-cloudwatch">openstack-orchestration::api-cloudwatch</h2>
<ul>
  <li>Configure and start heat-api-cloudwatch service</li>
</ul>

<h2 id="openstack-orchestrationapi-cfn">openstack-orchestration::api-cfn</h2>
<ul>
  <li>Configure and start heat-api-cfn service</li>
</ul>

<h2 id="openstack-orchestrationapi">openstack-orchestration::api</h2>
<ul>
  <li>Configure and start heat-api service</li>
</ul>

<h2 id="openstack-orchestrationclient">openstack-orchestration::client</h2>
<ul>
  <li>Install the heat client packages</li>
</ul>

<h2 id="openstack-orchestrationcommon">openstack-orchestration::common</h2>
<ul>
  <li>Installs the heat packages and setup configuration for Heat.</li>
</ul>

<h2 id="openstack-orchestrationengine">openstack-orchestration::engine</h2>
<ul>
  <li>Setup the heat database and start heat-engine service</li>
</ul>

<h2 id="openstack-orchestrationidentityregistration">openstack-orchestration::identity_registration</h2>
<ul>
  <li>Registers the Heat API endpoint, heat service and user</li>
</ul>

<hr />

<h3 id="cookbook-openstack-orchestration-attributes-default">cookbook-openstack-orchestration-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="sx">%w(public internal admin)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">ep_type</span><span class="o">|</span>
  <span class="c1"># openstack orchestration-api service endpoints (used by users and services)</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api'</span><span class="p">][</span><span class="s1">'scheme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/v1/%(tenant_id)s'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8004</span>
  <span class="c1"># openstack orchestration-api-cfn service endpoints (used by users and services)</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api-cfn'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api-cfn'</span><span class="p">][</span><span class="s1">'scheme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api-cfn'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/v1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api-cfn'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8000</span>
  <span class="c1"># openstack orchestration-api-cloudwatch service endpoints (used by users and services)</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api-cloudwatch'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api-cloudwatch'</span><span class="p">][</span><span class="s1">'scheme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api-cloudwatch'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/v1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api-cloudwatch'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8003</span>
<span class="k">end</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'orchestration-api'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'orchestration-api'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8004</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'orchestration-api-cfn'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'orchestration-api-cfn'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'orchestration-api-cloudwatch'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'orchestration-api-cloudwatch'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8003</span>
</code></pre>
</div>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'
# This file was autogenerated by Chef
# Do not edit, changes will be overwritten
'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span>
</code></pre>
</div>

<p>This is the name of the Chef role that will install the Keystone Service API</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'identity_service_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-identity'</span>
</code></pre>
</div>

<p>The name of the Chef role that knows about the message queue server
that Heat uses</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'rabbit_server_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-ops-messaging'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'service_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'ec2authtoken'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2.0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span>
</code></pre>
</div>

<p>platform-specific settings</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform_family</span>
<span class="k">when</span> <span class="s1">'rhel'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'heat'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'heat'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'heat_common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-heat-common'</span><span class="p">],</span>
    <span class="s1">'heat_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-heatclient'</span><span class="p">],</span>
    <span class="s1">'heat_api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-heat-api'</span><span class="p">,</span> <span class="s1">'python-heatclient'</span><span class="p">],</span>
    <span class="s1">'heat_api_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-heat-api'</span><span class="p">,</span>
    <span class="s1">'heat_api_cfn_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-heat-api-cfn'</span><span class="p">,</span> <span class="s1">'python-heatclient'</span><span class="p">],</span>
    <span class="s1">'heat_api_cfn_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-heat-api-cfn'</span><span class="p">,</span>
    <span class="s1">'heat_api_cloudwatch_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-heat-api-cloudwatch'</span><span class="p">,</span> <span class="s1">'python-heatclient'</span><span class="p">],</span>
    <span class="s1">'heat_api_cloudwatch_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-heat-api-cloudwatch'</span><span class="p">,</span>
    <span class="s1">'heat_engine_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-heat-engine'</span><span class="p">],</span>
    <span class="s1">'heat_engine_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-heat-engine'</span><span class="p">,</span>
    <span class="s1">'heat_api_process_name'</span> <span class="o">=&gt;</span> <span class="s1">'heat-api'</span><span class="p">,</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'heat'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'heat'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'heat_common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'heat-common'</span><span class="p">],</span>
    <span class="s1">'heat_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-heatclient'</span><span class="p">],</span>
    <span class="s1">'heat_api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'heat-api'</span><span class="p">,</span> <span class="s1">'python-heatclient'</span><span class="p">],</span>
    <span class="s1">'heat_api_service'</span> <span class="o">=&gt;</span> <span class="s1">'heat-api'</span><span class="p">,</span>
    <span class="s1">'heat_api_cfn_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'heat-api-cfn'</span><span class="p">,</span> <span class="s1">'python-heatclient'</span><span class="p">],</span>
    <span class="s1">'heat_api_cfn_service'</span> <span class="o">=&gt;</span> <span class="s1">'heat-api-cfn'</span><span class="p">,</span>
    <span class="s1">'heat_api_cloudwatch_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'heat-api-cloudwatch'</span><span class="p">,</span> <span class="s1">'python-heatclient'</span><span class="p">],</span>
    <span class="s1">'heat_api_cloudwatch_service'</span> <span class="o">=&gt;</span> <span class="s1">'heat-api-cloudwatch'</span><span class="p">,</span>
    <span class="s1">'heat_engine_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'heat-engine'</span><span class="p">],</span>
    <span class="s1">'heat_engine_service'</span> <span class="o">=&gt;</span> <span class="s1">'heat-engine'</span><span class="p">,</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s2">"-o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef'"</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-orchestration-attributes-heatconf">cookbook-openstack-orchestration-attributes-heat_conf</h3>

<p><a href="#contents">back to top</a></p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/heat'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'oslo_messaging_notifications'</span><span class="p">][</span><span class="s1">'driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'heat.openstack.common.notifier.rpc_notifier'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'auth_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'heat'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'trustee'</span><span class="p">][</span><span class="s1">'auth_plugin'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'trustee'</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'heat'</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-telemetry">cookbook-openstack-telemetry</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-telemetry-readme">cookbook-openstack-telemetry-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-13">Description</h1>

<p>Installs the OpenStack Metering service <strong>Ceilometer</strong> as part of the OpenStack
reference deployment Chef for OpenStack.  Ceilometer is currently installed
from packages.</p>

<p>https://wiki.openstack.org/wiki/Ceilometer</p>

<h1 id="requirements-14">Requirements</h1>

<h2 id="cookbooks-11">Cookbooks</h2>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>openstack-common</li>
  <li>openstack-identity</li>
  <li>openstack-compute</li>
</ul>

<h1 id="usage-6">Usage</h1>

<h2 id="agent-central">agent-central</h2>
<ul>
  <li>Installs agent central service.</li>
</ul>

<h2 id="agent-compute">agent-compute</h2>
<ul>
  <li>Installs agent compute service.</li>
</ul>

<h2 id="agent-notification">agent-notification</h2>
<ul>
  <li>Installs agent notification service.</li>
</ul>

<h2 id="alarm-evaluator">alarm-evaluator</h2>
<ul>
  <li>Installs alarm evaluator service.</li>
</ul>

<h2 id="alarm-notifier">alarm-notifier</h2>
<ul>
  <li>Installs alarm notifier service.</li>
</ul>

<h2 id="api-1">api</h2>
<ul>
  <li>Installs API service.</li>
</ul>

<h2 id="client-2">client</h2>
<ul>
  <li>Install the client packages</li>
</ul>

<h2 id="collector">collector</h2>
<ul>
  <li>Installs collector package and service. If the NoSQL database is used for metering service, ceilometer-dbsync will not be executed.</li>
</ul>

<h2 id="common">common</h2>
<ul>
  <li>Common metering configuration.</li>
</ul>

<h2 id="identityregistration-1">identity_registration</h2>
<ul>
  <li>Registers the endpoints, tenant and user for metering service with Keystone.</li>
</ul>

<h1 id="attributes-14">Attributes</h1>

<ul>
  <li><code class="highlighter-rouge">openstack['telemetry']['api']['auth']['version']</code> - Select v2.0 or v3.0. Default v2.0. The auth API version used to interact with identity service.</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['sample_source']</code> -  The source name of emitted samples, default value is openstack.</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['api']['auth']['memcached_servers']</code> - A list of memcached server(s) to use for caching</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['api']['auth']['memcache_security_strategy']</code> - Whether token data should be authenticated or authenticated and encrypted. Acceptable values are MAC or ENCRYPT</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['api']['auth']['memcache_secret_key']</code> - This string is used for key derivation</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['api']['auth']['hash_algorithms']</code> - Hash algorithms to use for hashing PKI tokens</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['api']['auth']['cafile']</code> - A PEM encoded Certificate Authority to use when verifying HTTPs connections</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['api']['auth']['insecure']</code> - Set whether to verify HTTPS connections</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['service-credentials']['cafile']</code> - A PEM encoded Certificate Authority to use when verifying HTTPs connections (for service polling authentication)</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['service-credentials']['insecure']</code> - Set whether to verify HTTPS connections (for service polling authentication)</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['dbsync_timeout']</code> - Set dbsync command timeout value</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['database']['time_to_live']</code> - Set a time_to_live parameter (ttl) for samples. Set -1 for no expiry</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['notification']['store_events']</code> - Set a store_events parameter for notification service</li>
</ul>

<p>The following attributes are defined in attributes/default.rb of the common cookbook, but are documented here due to their relevance:</p>

<ul>
  <li><code class="highlighter-rouge">openstack['endpoints']['telemetry-api-bind']['host']</code> - The IP address to bind the api service to</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['telemetry-api-bind']['port']</code> - The port to bind the api service to</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['telemetry-api-bind']['bind_interface']</code> - The interface name to bind the api service to</li>
</ul>

<p>If the value of the ‘bind_interface’ attribute is non-nil, then the telemetry service will be bound to the first IP address on that interface.  If the value of the ‘bind_interface’ attribute is nil, then the telemetry service will be bound to the IP address specifie</p>

<hr />

<h3 id="cookbook-openstack-telemetry-attributes-default">cookbook-openstack-telemetry-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>The name of the Chef role that knows about the message queue server
that Nova uses</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'rabbit_server_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-ops-messaging'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'conf_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/ceilometer'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">]</span> <span class="o">=</span> <span class="o">::</span><span class="no">File</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'conf_dir'</span><span class="p">],</span> <span class="s1">'ceilometer.conf'</span><span class="p">)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'periodic_interval'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">600</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'verbose'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'true'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'debug'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'false'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'cache_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/ceilometer/api'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span>
</code></pre>
</div>

<p>A list of memcached server(s) to use for caching</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'memcached_servers'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Whether token data should be authenticated or authenticated and encrypted. Acceptable values are MAC or ENCRYPT</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'memcache_security_strategy'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>This string is used for key derivation</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'memcache_secret_key'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Hash algorithms to use for hashing PKI tokens</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'hash_algorithms'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'md5'</span>
</code></pre>
</div>

<p>A PEM encoded Certificate Authority to use when verifying HTTPs connections</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'cafile'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Verify HTTPS connections</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'insecure'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ceilometer'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ceilometer'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'service_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ceilometer'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'service_tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'service_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
</code></pre>
</div>

<p>A PEM encoded Certificate Authority to use when verifying HTTPs connections (for service polling authentication)</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'service-credentials'</span><span class="p">][</span><span class="s1">'cafile'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Verify HTTPS connections (for service polling authentication)</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'service-credentials'</span><span class="p">][</span><span class="s1">'insecure'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'sample_source'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'openstack'</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'dbsync_timeout'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3600</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'driver'</span><span class="p">]</span>
<span class="k">when</span> <span class="s1">'libvirt.LibvirtDriver'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'hypervisor_inspector'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'libvirt'</span>
<span class="k">when</span> <span class="s1">'vmwareapi.VMwareESXDriver'</span><span class="p">,</span> <span class="s1">'vmwareapi.VMwareVCDriver'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'hypervisor_inspector'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'vsphere'</span>
<span class="k">else</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'hypervisor_inspector'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="k">end</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform_family</span>
<span class="k">when</span> <span class="s1">'suse'</span> <span class="c1"># :pragma-foodcritic: ~FC024 - won't fix this</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer'</span><span class="p">],</span>
    <span class="s1">'agent_central_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-agent-central'</span><span class="p">],</span>
    <span class="s1">'agent_central_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-agent-central'</span><span class="p">,</span>
    <span class="s1">'agent_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-agent-compute'</span><span class="p">],</span>
    <span class="s1">'agent_compute_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-agent-compute'</span><span class="p">,</span>
    <span class="s1">'agent_notification_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-agent-notification'</span><span class="p">],</span>
    <span class="s1">'agent_notification_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-agent-notification'</span><span class="p">,</span>
    <span class="s1">'alarm_evaluator_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-alarm-evaluator'</span><span class="p">],</span>
    <span class="s1">'alarm_evaluator_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-alarm-evaluator'</span><span class="p">,</span>
    <span class="s1">'alarm_notifier_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-alarm-notifier'</span><span class="p">],</span>
    <span class="s1">'alarm_notifier_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-alarm-notifier'</span><span class="p">,</span>
    <span class="s1">'api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-api'</span><span class="p">],</span>
    <span class="s1">'api_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-api'</span><span class="p">,</span>
    <span class="s1">'client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-ceilometerclient'</span><span class="p">],</span>
    <span class="s1">'collector_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-collector'</span><span class="p">],</span>
    <span class="s1">'collector_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-collector'</span><span class="p">,</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">when</span> <span class="s1">'fedora'</span><span class="p">,</span> <span class="s1">'rhel'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-common'</span><span class="p">],</span>
    <span class="s1">'agent_central_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-central'</span><span class="p">],</span>
    <span class="s1">'agent_central_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-central'</span><span class="p">,</span>
    <span class="s1">'agent_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-compute'</span><span class="p">],</span>
    <span class="s1">'agent_compute_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-compute'</span><span class="p">,</span>
    <span class="s1">'agent_notification_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-collector'</span><span class="p">],</span>
    <span class="s1">'agent_notification_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-notification'</span><span class="p">,</span>
    <span class="s1">'alarm_evaluator_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-alarm'</span><span class="p">],</span>
    <span class="s1">'alarm_evaluator_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-alarm-evaluator'</span><span class="p">,</span>
    <span class="s1">'alarm_notifier_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-alarm'</span><span class="p">],</span>
    <span class="s1">'alarm_notifier_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-alarm-notifier'</span><span class="p">,</span>
    <span class="s1">'api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-api'</span><span class="p">],</span>
    <span class="s1">'api_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-api'</span><span class="p">,</span>
    <span class="s1">'client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-ceilometerclient'</span><span class="p">],</span>
    <span class="s1">'collector_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-collector'</span><span class="p">],</span>
    <span class="s1">'collector_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-collector'</span><span class="p">,</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
</code></pre>
</div>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceilometer-common'</span><span class="p">],</span>
    <span class="s1">'agent_central_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceilometer-agent-central'</span><span class="p">],</span>
    <span class="s1">'agent_central_service'</span> <span class="o">=&gt;</span> <span class="s1">'ceilometer-agent-central'</span><span class="p">,</span>
    <span class="s1">'agent_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceilometer-agent-compute'</span><span class="p">],</span>
    <span class="s1">'agent_compute_service'</span> <span class="o">=&gt;</span> <span class="s1">'ceilometer-agent-compute'</span><span class="p">,</span>
    <span class="s1">'agent_notification_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceilometer-agent-notification'</span><span class="p">],</span>
    <span class="s1">'agent_notification_service'</span> <span class="o">=&gt;</span> <span class="s1">'ceilometer-agent-notification'</span><span class="p">,</span>
    <span class="s1">'alarm_evaluator_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceilometer-alarm-evaluator'</span><span class="p">],</span>
    <span class="s1">'alarm_evaluator_service'</span> <span class="o">=&gt;</span> <span class="s1">'ceilometer-alarm-evaluator'</span><span class="p">,</span>
    <span class="s1">'alarm_notifier_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceilometer-alarm-notifier'</span><span class="p">],</span>
    <span class="s1">'alarm_notifier_service'</span> <span class="o">=&gt;</span> <span class="s1">'ceilometer-alarm-notifier'</span><span class="p">,</span>
    <span class="s1">'api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceilometer-api'</span><span class="p">],</span>
    <span class="s1">'api_service'</span> <span class="o">=&gt;</span> <span class="s1">'ceilometer-api'</span><span class="p">,</span>
    <span class="s1">'client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-ceilometerclient'</span><span class="p">],</span>
    <span class="s1">'collector_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceilometer-collector'</span><span class="p">,</span> <span class="s1">'python-mysqldb'</span><span class="p">],</span>
    <span class="s1">'collector_service'</span> <span class="o">=&gt;</span> <span class="s1">'ceilometer-collector'</span><span class="p">,</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s2">"-o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef'"</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<p>The time to live value for samples which is specified in seconds, override to -1 if no data expiry is required</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'time_to_live'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1800</span>
</code></pre>
</div>

<p>Decide whether to store events in notification service or not</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'notification'</span><span class="p">][</span><span class="s1">'store_events'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

    
  </div>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Cookbook OpenStack Documentation</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Cookbook OpenStack Documentation</li>
          <li><a href="mailto:vanderwl@us.ibm.com">vanderwl@us.ibm.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/kramvan1">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">kramvan1</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/MarkRVanderwiel">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

              <span class="username">MarkRVanderwiel</span>
            </a>
          </li>
          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">Documentation for OpenStack cookbooks generated from the source ReadMe and attribute files. 
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
