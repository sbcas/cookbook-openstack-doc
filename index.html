<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Cookbook OpenStack Documentation</title>
  <meta name="description" content="Documentation for OpenStack cookbooks generated from the source ReadMe and attribute files. 
">

  <link rel="stylesheet" href="http://kramvan1.github.io/cookbook-openstack-doc/css/main.css">
  <link rel="canonical" href="http://www.openstack.orghttp://kramvan1.github.io/cookbook-openstack-doc/">
  <link rel="alternate" type="application/rss+xml" title="Cookbook OpenStack Documentation" href="http://www.openstack.orghttp://kramvan1.github.io/cookbook-openstack-doc/feed.xml" />
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="http://kramvan1.github.io/cookbook-openstack-doc/">Cookbook OpenStack Documentation</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="home">
  <h1 class="page-heading">Overview</h1>

  <p>The OpenStack cookbook projects are a group of integrated <a href="https://www.chef.io">Chef</a> cookbooks 
  that allow quick and easy deployments of <a href="https://www.openstack.org">Openstack</a>. For more information
  see:</p>
  <ul>
    <li><a href="https://wiki.openstack.org/wiki/Chef">OpenStack Cookbook wiki</a></li>
    <li><a href="http://governance.openstack.org/reference/projects/chefopenstack.html">OpenStack Cookbook projects</a></li>
  </ul>
  
  <p><a href="https://github.com/kramvan1/cookbook-openstack-doc">Link to source for this project.</a></p>
  
  <h1 class="page-heading">Attribute Information</h1>

  <div class="page">
    
    <h1 id="openstack-cookbook-attributes">OpenStack Cookbook Attributes</h1>

<h2 id="contents">Contents</h2>

<ul>
  <li><a href="#cookbook-openstack-common">cookbook-openstack-common</a>
    <ul>
      <li><a href="#cookbook-openstack-common-readme">cookbook-openstack-common-README</a></li>
      <li><a href="#cookbook-openstack-common-attributes-database">cookbook-openstack-common-attributes-database</a></li>
      <li><a href="#cookbook-openstack-common-attributes-default">cookbook-openstack-common-attributes-default</a></li>
      <li><a href="#cookbook-openstack-common-attributes-messaging">cookbook-openstack-common-attributes-messaging</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-bare-metal">cookbook-openstack-bare-metal</a>
    <ul>
      <li><a href="#cookbook-openstack-bare-metal-readme">cookbook-openstack-bare-metal-README</a></li>
      <li><a href="#cookbook-openstack-bare-metal-attributes-default">cookbook-openstack-bare-metal-attributes-default</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-block-storage">cookbook-openstack-block-storage</a>
    <ul>
      <li><a href="#cookbook-openstack-block-storage-readme">cookbook-openstack-block-storage-README</a></li>
      <li><a href="#cookbook-openstack-block-storage-attributes-cinder_conf">cookbook-openstack-block-storage-attributes-cinder_conf</a></li>
      <li><a href="#cookbook-openstack-block-storage-attributes-default">cookbook-openstack-block-storage-attributes-default</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-client">cookbook-openstack-client</a>
    <ul>
      <li><a href="#cookbook-openstack-client-readme">cookbook-openstack-client-README</a></li>
      <li><a href="#cookbook-openstack-client-attributes-default">cookbook-openstack-client-attributes-default</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-compute">cookbook-openstack-compute</a>
    <ul>
      <li><a href="#cookbook-openstack-compute-readme">cookbook-openstack-compute-README</a></li>
      <li><a href="#cookbook-openstack-compute-attributes-default">cookbook-openstack-compute-attributes-default</a></li>
      <li><a href="#cookbook-openstack-compute-attributes-nova_conf">cookbook-openstack-compute-attributes-nova_conf</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-dashboard">cookbook-openstack-dashboard</a>
    <ul>
      <li><a href="#cookbook-openstack-dashboard-readme">cookbook-openstack-dashboard-README</a></li>
      <li><a href="#cookbook-openstack-dashboard-attributes-default">cookbook-openstack-dashboard-attributes-default</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-database">cookbook-openstack-database</a>
    <ul>
      <li><a href="#cookbook-openstack-database-readme">cookbook-openstack-database-README</a></li>
      <li><a href="#cookbook-openstack-database-attributes-default">cookbook-openstack-database-attributes-default</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-data-processing">cookbook-openstack-data-processing</a>
    <ul>
      <li><a href="#cookbook-openstack-data-processing-readme">cookbook-openstack-data-processing-README</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-identity">cookbook-openstack-identity</a>
    <ul>
      <li><a href="#cookbook-openstack-identity-readme">cookbook-openstack-identity-README</a></li>
      <li><a href="#cookbook-openstack-identity-attributes-default">cookbook-openstack-identity-attributes-default</a></li>
      <li><a href="#cookbook-openstack-identity-attributes-keystone_conf">cookbook-openstack-identity-attributes-keystone_conf</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-image">cookbook-openstack-image</a>
    <ul>
      <li><a href="#cookbook-openstack-image-readme">cookbook-openstack-image-README</a></li>
      <li><a href="#cookbook-openstack-image-attributes-default">cookbook-openstack-image-attributes-default</a></li>
      <li><a href="#cookbook-openstack-image-attributes-glance_api_conf">cookbook-openstack-image-attributes-glance_api_conf</a></li>
      <li><a href="#cookbook-openstack-image-attributes-glance_cache_conf">cookbook-openstack-image-attributes-glance_cache_conf</a></li>
      <li><a href="#cookbook-openstack-image-attributes-glance_registry_conf">cookbook-openstack-image-attributes-glance_registry_conf</a></li>
      <li><a href="#cookbook-openstack-image-attributes-glance_scrubber_conf">cookbook-openstack-image-attributes-glance_scrubber_conf</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-network">cookbook-openstack-network</a>
    <ul>
      <li><a href="#cookbook-openstack-network-readme">cookbook-openstack-network-README</a></li>
      <li><a href="#cookbook-openstack-network-attributes-default">cookbook-openstack-network-attributes-default</a></li>
      <li><a href="#cookbook-openstack-network-attributes-neutron_conf">cookbook-openstack-network-attributes-neutron_conf</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-object-storage">cookbook-openstack-object-storage</a>
    <ul>
      <li><a href="#cookbook-openstack-object-storage-readme">cookbook-openstack-object-storage-README</a></li>
      <li><a href="#cookbook-openstack-object-storage-attributes-default">cookbook-openstack-object-storage-attributes-default</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-ops-database">cookbook-openstack-ops-database</a>
    <ul>
      <li><a href="#cookbook-openstack-ops-database-readme">cookbook-openstack-ops-database-README</a></li>
      <li><a href="#cookbook-openstack-ops-database-attributes-default">cookbook-openstack-ops-database-attributes-default</a></li>
      <li><a href="#cookbook-openstack-ops-database-attributes-mysql">cookbook-openstack-ops-database-attributes-mysql</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-ops-messaging">cookbook-openstack-ops-messaging</a>
    <ul>
      <li><a href="#cookbook-openstack-ops-messaging-readme">cookbook-openstack-ops-messaging-README</a></li>
      <li><a href="#cookbook-openstack-ops-messaging-attributes-default">cookbook-openstack-ops-messaging-attributes-default</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-orchestration">cookbook-openstack-orchestration</a>
    <ul>
      <li><a href="#cookbook-openstack-orchestration-readme">cookbook-openstack-orchestration-README</a></li>
      <li><a href="#cookbook-openstack-orchestration-attributes-default">cookbook-openstack-orchestration-attributes-default</a></li>
      <li><a href="#cookbook-openstack-orchestration-attributes-heat_conf">cookbook-openstack-orchestration-attributes-heat_conf</a></li>
    </ul>
  </li>
  <li><a href="#cookbook-openstack-telemetry">cookbook-openstack-telemetry</a>
    <ul>
      <li><a href="#cookbook-openstack-telemetry-readme">cookbook-openstack-telemetry-README</a></li>
      <li><a href="#cookbook-openstack-telemetry-attributes-default">cookbook-openstack-telemetry-attributes-default</a></li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="cookbook-openstack-common">cookbook-openstack-common</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-common-readme">cookbook-openstack-common-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description">Description</h1>

<p>This cookbook provides common setup recipes, helper methods and attributes that describe an OpenStack deployment as part of the OpenStack reference deployment Chef for OpenStack.</p>

<h1 id="requirements">Requirements</h1>

<ul>
  <li>Chef 0.10.0 or higher required (for Chef environment use).</li>
</ul>

<h2 id="cookbooks">Cookbooks</h2>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>apt</li>
  <li>database</li>
  <li>yum</li>
  <li>yum-epel</li>
</ul>

<h1 id="attributes">Attributes</h1>

<p>Please see the extensive inline documentation in <code class="highlighter-rouge">attributes/*.rb</code> for descriptions
of all the settable attributes for this cookbook.</p>

<p>Note that all attributes are in the <code class="highlighter-rouge">default["openstack"]</code> “namespace”</p>

<ul>
  <li><code class="highlighter-rouge">openstack['api']['auth']['version']</code> - Select v2.0 or v3.0. Default v2.0. The default auth API version used by other components to interact with identity service.</li>
</ul>

<h2 id="default">default</h2>

<p>Support multiple network types. Default network type is “nova” with the other option supported being “neutron”.
The attribute is in the <code class="highlighter-rouge">default["openstack"]["compute"]["network"]["service_type"]</code>.</p>

<h1 id="recipes">Recipes</h1>

<h2 id="client">client</h2>

<p>Install the common python openstack client package</p>

<h2 id="default-1">default</h2>

<p>Installs/Configures common recipes</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s2">"run_list"</span><span class="err">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"recipe[openstack-common]"</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
</div>

<h2 id="logging">logging</h2>

<p>Installs/Configures common logging</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s2">"run_list"</span><span class="err">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"recipe[openstack-common::logging]"</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
</div>

<h2 id="setendpointsbyinterface">set_endpoints_by_interface</h2>

<p>Iterates over the contents of the <code class="highlighter-rouge">node['openstack']['endpoints']</code> hash and
finds any occurrence of <code class="highlighter-rouge">bind_interface</code> to set the IP address
(<code class="highlighter-rouge">node['openstack']['endpoints']['identity']['bind_interface'] = 'eth0'</code> for
example, overriding <code class="highlighter-rouge">node['openstack']['endpoints']['identity']['host']</code>). If
<code class="highlighter-rouge">bind_interface</code> isn’t set, the value of <code class="highlighter-rouge">host</code> is not modified.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s2">"run_list"</span><span class="err">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"recipe[openstack-common::set_endpoints_by_interface]"</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
</div>

<h2 id="openrc">openrc</h2>

<p>Creates an /root/openrc file. This requires the identity attributes for
admin_user and admin_tenant_name, or for the identity_service_chef_role
to be used on the identity server node.</p>

<h2 id="sysctl">sysctl</h2>

<p>Iterates over the contents of the <code class="highlighter-rouge">node['openstack']['sysctl']</code> hash and writes
the entries to <code class="highlighter-rouge">/etc/sysctl.d/60-openstack.conf</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s2">"run_list"</span><span class="err">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"recipe[openstack-common::sysctl]"</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
</div>

<h1 id="data-bags">Data Bags</h1>

<p>This cookbook containes Libraries to work with passwords and secrets in databags.   Databags can be unencrypted ( for dev ) or encrypted ( for prod ). In addition to traditionally encrypted data bags they can also be created as chef-vault items. To read more about chef-vault and how to use it, go to https://docs.getchef.com/chef_vault.html.</p>

<p>Documentation for Attributes for selecting databag format can be found in the attributes section of this cookbook.</p>

<p>Documentation for format of these Databags can be found in the <a href="https://github.com/openstack/openstack-chef-repo#databags">Openstack Chef Repo</a> repository.</p>

<h1 id="lwrps">LWRPs</h1>

<p>This cookbook provides the openstack_common_database LWRP, which replaces the old database library function ‘db_create_with_user’.
When this coobook is included as dependency, this LWRP can be used to create databases needed by the openstack services.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">depends</span> <span class="s1">'openstack-common'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">openstack_common_database</span> <span class="s1">'compute'</span> <span class="k">do</span>
  <span class="n">service</span> <span class="s1">'compute'</span> <span class="c1"># name_attribute</span>
  <span class="n">user</span> <span class="s1">'nova'</span>
  <span class="n">pass</span> <span class="s1">'supersecret'</span>
<span class="k">end</span>
</code></pre>
</div>

<p>An example of the usage can be seen here https://github.com/stackforge/cookbook-openstack-ops-database/blob/master/recipes/openstack-db.rb.</p>

<h1 id="libraries">Libraries</h1>

<p>This cookbook exposes a set of default library routines:</p>

<ul>
  <li><code class="highlighter-rouge">cli</code> – Used to call openstack CLIs</li>
  <li><code class="highlighter-rouge">endpoint</code> – Used to return a <code class="highlighter-rouge">::URI</code> object representing the named OpenStack endpoint</li>
  <li><code class="highlighter-rouge">admin_endpoint</code> – Used to return a <code class="highlighter-rouge">::URI</code> object representing the named OpenStack admin endpoint if one was specified. Otherwise, it will return the same value as <code class="highlighter-rouge">endpoint</code>.</li>
  <li><code class="highlighter-rouge">internal_endpoint</code> – Used to return a <code class="highlighter-rouge">::URI</code> object representing the named OpenStack internal endpoint if one was specified. Otherwise, it will return the same value as <code class="highlighter-rouge">endpoint</code>.</li>
  <li><code class="highlighter-rouge">public_endpoint</code> – Used to return a <code class="highlighter-rouge">::URI</code> object representing the named OpenStack public endpoint if one was specified. Otherwise, it will return the same value as <code class="highlighter-rouge">endpoint</code>.</li>
  <li><code class="highlighter-rouge">endpoints</code> – Useful for operating on all OpenStack endpoints</li>
  <li><code class="highlighter-rouge">db</code> – Returns a Hash of information about a named OpenStack database</li>
  <li><code class="highlighter-rouge">db_uri</code> – Returns the SQLAlchemy RFC-1738 DB URI (see: http://rfc.net/rfc1738.html) for a named OpenStack database</li>
  <li><code class="highlighter-rouge">secret</code> – Returns the value of an encrypted data bag for a named OpenStack secret key and key-section</li>
  <li><code class="highlighter-rouge">get_password</code> – Ease-of-use helper that returns the decrypted password for a named database, service or keystone user.</li>
  <li><code class="highlighter-rouge">matchers</code> – A custom matcher(render_config_file) for testing ini format file section content by with_section_content.</li>
</ul>

<h2 id="usage">Usage</h2>

<p>The following are code examples showing the above library routines in action.
Remember when using the library routines exposed by this library to include
the Openstack routines in your recipe’s <code class="highlighter-rouge">::Chef::Recipe</code> namespace, like so:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="o">::</span><span class="no">Chef</span><span class="o">::</span><span class="no">Recipe</span>
  <span class="kp">include</span> <span class="o">::</span><span class="no">Openstack</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Example of using the <code class="highlighter-rouge">endpoint</code> routine:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">nova_api_ep</span> <span class="o">=</span> <span class="n">endpoint</span> <span class="s2">"compute-api"</span>
<span class="o">::</span><span class="no">Chef</span><span class="o">::</span><span class="no">Log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s2">"Using Openstack Compute API endpoint at </span><span class="si">#{</span><span class="n">nova_api_ep</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Note that endpoint URIs may contain variable interpolation markers such</span>
<span class="c1"># as `%(tenant_id)s`, so you may need to decode them. Do so like this:</span>

<span class="nb">require</span> <span class="s2">"uri"</span>

<span class="nb">puts</span> <span class="o">::</span><span class="no">URI</span><span class="p">.</span><span class="nf">decode</span> <span class="n">nova_api_ap</span><span class="p">.</span><span class="nf">to_s</span>
</code></pre>
</div>

<p>Example of using the <code class="highlighter-rouge">get_password</code> and <code class="highlighter-rouge">db_uri</code> routine:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">db_pass</span> <span class="o">=</span> <span class="n">get_password</span> <span class="s2">"db"</span> <span class="s2">"cinder"</span>
<span class="n">db_user</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s2">"cinder"</span><span class="p">][</span><span class="s2">"db"</span><span class="p">][</span><span class="s2">"user"</span><span class="p">]</span>
<span class="n">sql_connection</span> <span class="o">=</span> <span class="n">db_uri</span> <span class="s2">"volume"</span><span class="p">,</span> <span class="n">db_user</span><span class="p">,</span> <span class="n">db_pass</span>

<span class="n">template</span> <span class="s2">"/etc/cinder/cinder.conf"</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">"cinder.conf.erb"</span>
  <span class="n">owner</span>  <span class="n">node</span><span class="p">[</span><span class="s2">"cinder"</span><span class="p">][</span><span class="s2">"user"</span><span class="p">]</span>
  <span class="n">group</span>  <span class="n">node</span><span class="p">[</span><span class="s2">"cinder"</span><span class="p">][</span><span class="s2">"group"</span><span class="p">]</span>
  <span class="n">mode</span>   <span class="mo">00644</span>
  <span class="n">variables</span><span class="p">(</span>
    <span class="s2">"sql_connection"</span> <span class="o">=&gt;</span> <span class="n">sql_connection</span>
  <span class="p">)</span>
<span class="k">end</span>
</code></pre>
</div>

<h2 id="uri-operations">URI Operations</h2>

<p>Use the <code class="highlighter-rouge">Openstack::uri_from_hash</code> routine to helpfully return a <code class="highlighter-rouge">::URI::Generic</code>
object for a hash that contains any of the following keys:</p>

<ul>
  <li><code class="highlighter-rouge">host</code></li>
  <li><code class="highlighter-rouge">uri</code></li>
  <li><code class="highlighter-rouge">port</code></li>
  <li><code class="highlighter-rouge">path</code></li>
  <li><code class="highlighter-rouge">scheme</code></li>
</ul>

<p>If the <code class="highlighter-rouge">uri</code> key is in the hash, that will be used as the URI, otherwise the URI will be
constructed from the various parts of the hash corresponding to the keys above.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1"># Suppose node hash contains the following subhash in the :identity_service key:</span>
<span class="c1"># {</span>
<span class="c1">#   :host =&gt; 'identity.example.com',</span>
<span class="c1">#   :port =&gt; 5000,</span>
<span class="c1">#   :scheme =&gt; 'https'</span>
<span class="c1"># }</span>
<span class="n">uri</span> <span class="o">=</span> <span class="o">::</span><span class="no">Openstack</span><span class="o">::</span><span class="n">uri_from_hash</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="ss">:identity_service</span><span class="p">])</span>
<span class="c1"># uri.to_s would == "https://identity.example.com:5000"</span>
</code></pre>
</div>

<p>The routine will return nil if neither a <code class="highlighter-rouge">uri</code> or <code class="highlighter-rouge">host</code> key exists in the supplied hash.</p>

<h2 id="using-the-library-without-prefixing-with-openstack">Using the library without prefixing with ::Openstack</h2>

<p>Don’t like prefixing calls to the library’s routines with <code class="highlighter-rouge">::Openstack</code>? Do this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="o">::</span><span class="no">Chef</span><span class="o">::</span><span class="no">Recipe</span>
  <span class="kp">include</span> <span class="o">::</span><span class="no">Openstack</span>
<span class="k">end</span>
</code></pre>
</div>

<p>in your recipe.</p>

<hr />

<h3 id="cookbook-openstack-common-attributes-database">cookbook-openstack-common-attributes-database</h3>

<p><a href="#contents">back to top</a></p>

<p>======================== OpenStack DB Support ================================</p>

<p>This section of node attributes stores information about the database hosts
used in an OpenStack deployment.</p>

<p>There is no ‘scheme’ key. Instead, there is a ‘service_type’ key that should
contain one of ‘sqlite’, ‘mysql’, or ‘postgresql’</p>

<p>The ::Openstack::db(SERVICE_NAME) library routine allows a lookup from any recipe
to this array, returning the host information for the server that contains
the database for SERVICE_NAME, where SERVICE_NAME is one of ‘compute’ (Nova),
‘image’ (Glance), ‘identity’ (Keystone), ‘network’ (Neutron), or ‘volume’ (Cinder)</p>

<p>The ::Openstack::db_connection(SERVICE_NAME, USER, PASSWORD) library routine
returns the SQLAlchemy DB URI for SERVICE_NAME, with the supplied user and password
that a calling service might be using when connecting to the database.</p>

<p>For example, let’s assume that the database that is used by the OpenStack Identity
service (Keystone) is configured as follows:</p>

<p>host: 192.168.0.3
port: 3306
service_type: mysql
db_name: keystone</p>

<p>Further suppose that a node running the OpenStack Identity API service needs to
connect to the above identity database server. It has the following in it’s node
attributes:</p>

<p>node[‘openstack’][‘db’][‘identity’][‘username’] = ‘keystone’</p>

<p>In a ‘keystone’ recipe, you might find the following code:</p>

<p>user = node[‘openstack’][‘db’][‘identity’][‘username’]
pass = get_password ‘db’, ‘keystone’</p>

<p>sql_connection = ::Openstack::db_uri(‘identity’, user, pass)</p>

<p>The sql_connection variable would then be set to “mysql://keystone:password@192.168.0.3:keystone”
and could then be written to the keystone.conf file in a template.</p>

<p>Database Migrations:</p>

<p>node[‘openstack’][‘db’][SERVICE_NAME][‘migrate’]</p>

<p>The above attribute causes database migrations to be executed for the given
service.  There are cases where migrations should not be executed.  For
example when upgrading a zone, and the image or identity database are replicated
across many zones.</p>

<p><strong>**</strong><strong>**</strong><strong>**</strong>** Database Endpoint <strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong>**</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="sx">%w(endpoints bind_service)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">type</span><span class="o">|</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'3306'</span>
<span class="k">end</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'interface'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'enabled_slave'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'slave_host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'slave_port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'3316'</span>
</code></pre>
</div>

<p>If you bind the database to a specific ip-address (you can only choose one
here for mysql, so 127.0.0.1 + external address is not an option), to allow
the services and applications to access it via this one, you probably do not
want to allow the db root user to access it via this external address. In this
case you have the option to allow root access only via localhost, which
will work for mysql databases, since it will use a direct connection via
the socket, so the database does not have not to listen on 127.0.0.1.
Set this to ‘localhost’ for mysql to connect via socket.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'host_for_db_root_user'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Default database attributes</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'server_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-ops-database'</span>
<span class="c1"># Database charset during create database</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'charset'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">mysql: </span><span class="s1">'utf8'</span><span class="p">,</span>
  <span class="s1">'percona-cluster'</span> <span class="o">=&gt;</span> <span class="s1">'utf8'</span><span class="p">,</span>
  <span class="ss">mariadb: </span><span class="s1">'utf8'</span><span class="p">,</span>
  <span class="ss">postgresql: </span><span class="kp">nil</span><span class="p">,</span>
  <span class="ss">pgsql: </span><span class="kp">nil</span><span class="p">,</span>
  <span class="ss">sqlite: </span><span class="kp">nil</span><span class="p">,</span>
  <span class="ss">nosql: </span><span class="kp">nil</span><span class="p">,</span>
  <span class="ss">galera: </span><span class="s1">'utf8'</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Database connection options. Should include starting ‘?’</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'options'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">mysql: </span><span class="s2">"?charset=</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'charset'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
  <span class="s1">'percona-cluster'</span> <span class="o">=&gt;</span> <span class="s2">"?charset=</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'charset'</span><span class="p">][</span><span class="s1">'percona-cluster'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
  <span class="ss">mariadb: </span><span class="s2">"?charset=</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'charset'</span><span class="p">][</span><span class="s1">'mariadb'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
  <span class="ss">postgresql: </span><span class="s1">''</span><span class="p">,</span>
  <span class="ss">sqlite: </span><span class="s1">''</span><span class="p">,</span>
  <span class="ss">nosql: </span><span class="s1">''</span><span class="p">,</span>
  <span class="ss">galera: </span><span class="s2">"?charset=</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'charset'</span><span class="p">][</span><span class="s1">'galera'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span>
<span class="p">}</span>
</code></pre>
</div>

<p>platform and DBMS-specific python client packages</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'python_packages'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">postgresql: </span><span class="p">[</span><span class="s1">'python-psycopg2'</span><span class="p">],</span>
  <span class="ss">sqlite: </span><span class="p">[]</span>
<span class="p">}</span>
<span class="k">case</span> <span class="n">node</span><span class="p">[</span><span class="s1">'platform_family'</span><span class="p">]</span>
<span class="k">when</span> <span class="s1">'rhel'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'mariadb'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'python_packages'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'MySQL-python'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'python_packages'</span><span class="p">][</span><span class="s1">'mariadb'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'MySQL-python'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'python_packages'</span><span class="p">][</span><span class="s1">'percona-cluster'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'MySQL-python'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'python_packages'</span><span class="p">][</span><span class="s1">'galera'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'MySQL-python'</span><span class="p">]</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'mysql'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'python_packages'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'python-mysqldb'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'python_packages'</span><span class="p">][</span><span class="s1">'mariadb'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'python-mysqldb'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'python_packages'</span><span class="p">][</span><span class="s1">'percona-cluster'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'python-mysqldb'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'python_packages'</span><span class="p">][</span><span class="s1">'galera'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'python-mysqldb'</span><span class="p">]</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Database used by the OpenStack services</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'common'</span><span class="p">][</span><span class="s1">'services'</span><span class="p">].</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">service</span><span class="p">,</span> <span class="n">project</span><span class="o">|</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'db_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">project</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="n">project</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'options'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'options'</span><span class="p">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'slave_host'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'slave_host'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'slave_port'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'slave_port'</span><span class="p">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="k">case</span> <span class="n">service</span>
  <span class="k">when</span> <span class="s1">'dashboard'</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'migrate'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
  <span class="k">when</span> <span class="s1">'identity'</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'migrate'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
  <span class="k">when</span> <span class="s1">'image'</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'migrate'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
  <span class="k">when</span> <span class="s1">'network'</span>
    <span class="c1"># The SQLAlchemy connection string used to connect to the slave database</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'slave_connection'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">''</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>    <span class="c1"># Database reconnection retry times - in event connectivity is lost</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'max_retries'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>    <span class="c1"># Database reconnection interval in seconds - if the initial connection to the database fails</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'retry_interval'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>    <span class="c1"># Minimum number of SQL connections to keep open in a pool</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'min_pool_size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>    <span class="c1"># Maximum number of SQL connections to keep open in a pool</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'max_pool_size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>    <span class="c1"># Timeout in seconds before idle sql connections are reaped</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'idle_timeout'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3600</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>    <span class="c1"># If set, use this value for max_overflow with sqlalchemy</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'max_overflow'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>    <span class="c1"># Verbosity of SQL debugging information. 0=None, 100=Everything</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'connection_debug'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>    <span class="c1"># Add python stack traces to SQL as comment strings</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'connection_trace'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>    <span class="c1"># If set, use this value for pool_timeout with sqlalchemy</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'pool_timeout'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
  <span class="k">when</span> <span class="s1">'telemetry'</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'nosql'</span><span class="p">][</span><span class="s1">'used'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'nosql'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'27017'</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>DB key to the get_password library routine</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'root_user_key'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'mysqlroot'</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-common-attributes-default">cookbook-openstack-common-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'common'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
'</span>
</code></pre>
</div>

<p>OpenStack services and their project names</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'common'</span><span class="p">][</span><span class="s1">'services'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'bare-metal'</span> <span class="o">=&gt;</span> <span class="s1">'ironic'</span><span class="p">,</span>
  <span class="s1">'block-storage'</span> <span class="o">=&gt;</span> <span class="s1">'cinder'</span><span class="p">,</span>
  <span class="s1">'compute'</span> <span class="o">=&gt;</span> <span class="s1">'nova'</span><span class="p">,</span>
  <span class="s1">'compute_api'</span> <span class="o">=&gt;</span> <span class="s1">'nova_api'</span><span class="p">,</span>
  <span class="s1">'dashboard'</span> <span class="o">=&gt;</span> <span class="s1">'horizon'</span><span class="p">,</span>
  <span class="s1">'database'</span> <span class="o">=&gt;</span> <span class="s1">'trove'</span><span class="p">,</span>
  <span class="s1">'identity'</span> <span class="o">=&gt;</span> <span class="s1">'keystone'</span><span class="p">,</span>
  <span class="s1">'image'</span> <span class="o">=&gt;</span> <span class="s1">'glance'</span><span class="p">,</span>
  <span class="s1">'network'</span> <span class="o">=&gt;</span> <span class="s1">'neutron'</span><span class="p">,</span>
  <span class="s1">'object-storage'</span> <span class="o">=&gt;</span> <span class="s1">'swift'</span><span class="p">,</span>
  <span class="s1">'orchestration'</span> <span class="o">=&gt;</span> <span class="s1">'heat'</span><span class="p">,</span>
  <span class="s1">'telemetry'</span> <span class="o">=&gt;</span> <span class="s1">'ceilometer'</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Setting this to True means that database passwords and service user
passwords for Keystone will be easy-to-remember values – they will be
the same value as the key. For instance, if a cookbook calls the
::Openstack::secret routine like so:</p>

<p>pass = secret “passwords”, “nova”</p>

<p>The value of pass will be “nova”</p>

<p>Use data bags for storing passwords
Set this to false in order to get the passwords from attributes like:
node[‘openstack’][‘secret’][key][type]</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'use_databags'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<p>Set databag type
acceptable values ‘encrypted’, ‘standard’, ‘vault’
Set this to ‘standard’ in order to use regular databags.
this is not recommended for anything other than dev/CI
type environments.  Storing real secrets in plaintext = craycray.
In addition to the encrypted data_bags which are an included
feature of the official chef project, you can use ‘vault’ to
encrypt your secrets with the method provided in the chef-vault gem.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'databag_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'encrypted'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'vault_gem_version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'~&gt; 2.3'</span>
</code></pre>
</div>

<p>Default attributes when not using data bags (use_databags = false)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'common'</span><span class="p">][</span><span class="s1">'services'</span><span class="p">].</span><span class="nf">each_key</span> <span class="k">do</span> <span class="o">|</span><span class="n">service</span><span class="o">|</span>
  <span class="sx">%w(user service db token)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">type</span><span class="o">|</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'secret'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="n">type</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">service</span><span class="si">}</span><span class="s2">-</span><span class="si">#{</span><span class="n">type</span><span class="si">}</span><span class="s2">"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>The type of token signing to use (uuid or pki)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'strategy'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'pki'</span>
</code></pre>
</div>

<p>Set to true where using self-signed certs (in testing environments)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'validate_certs'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<p>========================= Encrypted Databag Setup ===========================</p>

<p>The openstack-common cookbook’s default library contains a <code class="highlighter-rouge">secret</code>
routine that looks up the value of encrypted databag values. This routine
uses the secret key file located at the following location to decrypt the
values in the data bag.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'secret'</span><span class="p">][</span><span class="s1">'key_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/chef/openstack_data_bag_secret'</span>
</code></pre>
</div>

<p>The name of the encrypted data bag that stores openstack secrets</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'secret'</span><span class="p">][</span><span class="s1">'secrets_data_bag'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'secrets'</span>
</code></pre>
</div>

<p>The name of the encrypted data bag that stores service user passwords, with
each key in the data bag corresponding to a named OpenStack service, like
“nova”, “cinder”, etc.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'secret'</span><span class="p">][</span><span class="s1">'service_passwords_data_bag'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service_passwords'</span>
</code></pre>
</div>

<p>The name of the encrypted data bag that stores DB passwords, with
each key in the data bag corresponding to a named OpenStack database, like
“nova”, “cinder”, etc.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'secret'</span><span class="p">][</span><span class="s1">'db_passwords_data_bag'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'db_passwords'</span>
</code></pre>
</div>

<p>The name of the encrypted data bag that stores Keystone user passwords, with
each key in the data bag corresponding to a user (Keystone or otherwise).</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'secret'</span><span class="p">][</span><span class="s1">'user_passwords_data_bag'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'user_passwords'</span>
</code></pre>
</div>

<p>========================= Package and Repository Setup ======================</p>

<p>Various Linux distributions provide OpenStack packages and repositories.
The provide some sensible defaults, but feel free to override per your
needs.
The coordinated release of OpenStack codename</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'release'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'mitaka'</span>
</code></pre>
</div>

<p>The Ubuntu Cloud Archive has packages for multiple Ubuntu releases. For
more information, see: https://wiki.ubuntu.com/ServerTeam/CloudArchive.
In the component strings, %codename% will be replaced by the value of
the node[‘lsb’][‘codename’] Ohai value and %release% will be replaced
by the value of node[‘openstack’][‘release’]</p>

<p>Change [‘openstack’][‘apt’][‘update_apt_cache’] to true if you would like
have the cache automaticly updated</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'apt'</span><span class="p">][</span><span class="s1">'update_apt_cache'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'apt'</span><span class="p">][</span><span class="s1">'live_updates_enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'apt'</span><span class="p">][</span><span class="s1">'uri'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http://ubuntu-cloud.archive.canonical.com/ubuntu'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'apt'</span><span class="p">][</span><span class="s1">'components'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'lsb'</span><span class="p">][</span><span class="s1">'codename'</span><span class="p">]</span><span class="si">}</span><span class="s2">-updates/</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'release'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="s1">'main'</span><span class="p">]</span>
<span class="c1"># For the SRU packaging, use this:</span>
<span class="c1"># default['openstack']['apt']['components'] = [ '%codename%-proposed/%release%', 'main' ]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'yum'</span><span class="p">][</span><span class="s1">'rdo_enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'yum'</span><span class="p">][</span><span class="s1">'uri'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"http://mirror.centos.org/centos/$releasever/cloud/$basearch/openstack-</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'release'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'yum'</span><span class="p">][</span><span class="s1">'repo-key'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'https://raw.githubusercontent.com/redhat-openstack/rdo-release/master/RPM-GPG-KEY-CentOS-SIG-Cloud'</span>
<span class="c1"># Enforcing GnuPG signature check for RDO repo. Set this to false if you want to disable the check.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'yum'</span><span class="p">][</span><span class="s1">'gpgcheck'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'family'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'inet'</span>
</code></pre>
</div>

<p>Set a default region that other regions are set to - such that changing the region for all services can be done in one place</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'RegionOne'</span>
</code></pre>
</div>

<p>Set a default auth api version that other components use to interact with identity service.
Allowed auth API versions: v2.0 or v3.0. By default, it is set to v2.0.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2.0'</span>
</code></pre>
</div>

<p>Allow configured loggers in logging.conf</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'logging'</span><span class="p">][</span><span class="s1">'loggers'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'root'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'NOTSET'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'devel'</span>
  <span class="p">},</span>
  <span class="s1">'ceilometer'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'DEBUG'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'ceilometer'</span>
  <span class="p">},</span>
  <span class="s1">'cinder'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'DEBUG'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'cinder'</span>
  <span class="p">},</span>
  <span class="s1">'glance'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'DEBUG'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'glance'</span>
  <span class="p">},</span>
  <span class="s1">'horizon'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'DEBUG'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'horizon'</span>
  <span class="p">},</span>
  <span class="s1">'keystone'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'DEBUG'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'keystone'</span>
  <span class="p">},</span>
  <span class="s1">'nova'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'DEBUG'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'nova'</span>
  <span class="p">},</span>
  <span class="s1">'neutron'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'DEBUG'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'neutron'</span>
  <span class="p">},</span>
  <span class="s1">'trove'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'DEBUG'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'trove'</span>
  <span class="p">},</span>
  <span class="s1">'amqplib'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'WARNING'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'stderr'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'amqplib'</span>
  <span class="p">},</span>
  <span class="s1">'sqlalchemy'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'WARNING'</span><span class="p">,</span>
    <span class="c1"># "level' =&gt; 'INFO" logs SQL queries.</span>
    <span class="c1"># "level' =&gt; 'DEBUG" logs SQL queries and results.</span>
    <span class="c1"># "level' =&gt; 'WARNING" logs neither.  (Recommended for production systems.)</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'stderr'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'sqlalchemy'</span>
  <span class="p">},</span>
  <span class="s1">'boto'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'WARNING'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'stderr'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'boto'</span>
  <span class="p">},</span>
  <span class="s1">'suds'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'INFO'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'stderr'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'suds'</span>
  <span class="p">},</span>
  <span class="s1">'eventletwsgi'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'WARNING'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'stderr'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'eventlet.wsgi.server'</span>
  <span class="p">},</span>
  <span class="s1">'nova_api_openstack_wsgi'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'WARNING'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'nova.api.openstack.wsgi'</span>
  <span class="p">},</span>
  <span class="s1">'nova_osapi_compute_wsgi_server'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'WARNING'</span><span class="p">,</span>
    <span class="s1">'handlers'</span> <span class="o">=&gt;</span> <span class="s1">'prod,debug'</span><span class="p">,</span>
    <span class="s1">'qualname'</span> <span class="o">=&gt;</span> <span class="s1">'nova.osapi_compute.wsgi.server'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Allow configured formatters in logging.conf</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'logging'</span><span class="p">][</span><span class="s1">'formatters'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'normal'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'format'</span> <span class="o">=&gt;</span> <span class="s1">'%(asctime)s %(levelname)s %(message)s'</span>
  <span class="p">},</span>
  <span class="s1">'normal_with_name'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'format'</span> <span class="o">=&gt;</span> <span class="s1">'[%(name)s]: %(asctime)s %(levelname)s %(message)s'</span>
  <span class="p">},</span>
  <span class="s1">'debug'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'format'</span> <span class="o">=&gt;</span> <span class="s1">'[%(name)s]: %(asctime)s %(levelname)s %(module)s.%(funcName)s %(message)s'</span>
  <span class="p">},</span>
  <span class="s1">'syslog_with_name'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'format'</span> <span class="o">=&gt;</span> <span class="s1">'%(name)s: %(levelname)s %(message)s'</span>
  <span class="p">},</span>
  <span class="s1">'syslog_debug'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'format'</span> <span class="o">=&gt;</span> <span class="s1">'%(name)s: %(levelname)s %(module)s.%(funcName)s %(message)s'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Allow configured logging handlers in logging.conf</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'logging'</span><span class="p">][</span><span class="s1">'handlers'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'stderr'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'args'</span> <span class="o">=&gt;</span> <span class="s1">'(sys.stderr,)'</span><span class="p">,</span>
    <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="s1">'StreamHandler'</span><span class="p">,</span>
    <span class="s1">'formatter'</span> <span class="o">=&gt;</span> <span class="s1">'debug'</span>
  <span class="p">},</span>
  <span class="s1">'devel'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'args'</span> <span class="o">=&gt;</span> <span class="s1">'(sys.stdout,)'</span><span class="p">,</span>
    <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="s1">'StreamHandler'</span><span class="p">,</span>
    <span class="s1">'formatter'</span> <span class="o">=&gt;</span> <span class="s1">'debug'</span><span class="p">,</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'NOTSET'</span>
  <span class="p">},</span>
  <span class="s1">'prod'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'args'</span> <span class="o">=&gt;</span> <span class="s1">'((\'/dev/log\'), handlers.SysLogHandler.LOG_LOCAL0)'</span><span class="p">,</span>
    <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="s1">'handlers.SysLogHandler'</span><span class="p">,</span>
    <span class="s1">'formatter'</span> <span class="o">=&gt;</span> <span class="s1">'syslog_with_name'</span><span class="p">,</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'INFO'</span>
  <span class="p">},</span>
  <span class="s1">'debug'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'args'</span> <span class="o">=&gt;</span> <span class="s1">'((\'/dev/log\'), handlers.SysLogHandler.LOG_LOCAL1)'</span><span class="p">,</span>
    <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="s1">'handlers.SysLogHandler'</span><span class="p">,</span>
    <span class="s1">'formatter'</span> <span class="o">=&gt;</span> <span class="s1">'syslog_debug'</span><span class="p">,</span>
    <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="s1">'DEBUG'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'memcached_servers'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Default sysctl settings</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'sysctl'</span><span class="p">][</span><span class="s1">'net.ipv4.conf.all.rp_filter'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'sysctl'</span><span class="p">][</span><span class="s1">'net.ipv4.conf.default.rp_filter'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">node</span><span class="p">[</span><span class="s1">'platform_family'</span><span class="p">]</span>
<span class="k">when</span> <span class="s1">'rhel'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'common'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'common_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-openstackclient'</span><span class="p">],</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'common'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'common_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-openstackclient'</span><span class="p">],</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s2">"-o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef'"</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<p>The name of the Chef role that installs the Keystone Service API</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity_service_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-identity'</span>
</code></pre>
</div>

<p>The name of the Chef role that sets up the compute worker</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute_worker_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-compute-worker'</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-common-attributes-messaging">cookbook-openstack-common-attributes-messaging</h3>

<p><a href="#contents">back to top</a></p>

<p><strong>**</strong><strong>**</strong><strong>**</strong>** RabbitMQ Endpoint <strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong>**</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="sx">%w(endpoints bind_service)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">type</span><span class="o">|</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'5672'</span>
<span class="k">end</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'interface'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'5672'</span>
</code></pre>
</div>

<p>Services to assign mq attributes for</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">services</span> <span class="o">=</span> <span class="sx">%w(bare-metal block-storage compute database image
              identity telemetry network orchestration)</span>
</code></pre>
</div>

<p>Generic default attributes</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'server_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-ops-messaging'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'rabbit'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'guest'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'vhost'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/'</span>
</code></pre>
</div>

<p>defined in oslo/messaging/_drivers/amqp.py</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'durable_queues'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'auto_delete'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>Default rabbit values (for attribute assignment below)</p>

<p>global switch for handling rabbit ssl</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'use_ssl'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># SSL version to use (valid only if SSL enabled)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_ssl_version'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="c1"># SSL key file (valid only if SSL enabled)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_ssl_keyfile'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="c1"># SSL cert file (valid only if SSL enabled)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_ssl_certfile'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="c1"># SSL certification authority file (valid only if SSL enabled)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_ssl_ca_certs'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="c1"># How long to wait before reconnecting in response to an AMQP consumer cancel notification</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_reconnect_delay'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span>
<span class="c1"># How long to wait before considering a reconnect attempt to have failed.</span>
<span class="c1"># This value should not be longer than rpc_response_timeout</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_reconnect_timeout'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">60</span>
<span class="c1"># global switch for handling rabbit ha</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'ha'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># global switch for number of seconds after which the Rabbit broker is considered down if heartbeat's keep-alive fails (0 disable the heartbeat)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'heartbeat_timeout_threshold'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># global switch for how often times during the heartbeat_timeout_threshold we check the heartbeat</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'heartbeat_rate'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">rabbit_defaults</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">rabbit_max_retries: </span><span class="mi">0</span><span class="p">,</span>
  <span class="ss">rabbit_retry_interval: </span><span class="mi">1</span><span class="p">,</span>
  <span class="ss">userid: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">],</span>
  <span class="ss">vhost: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'vhost'</span><span class="p">],</span>
  <span class="ss">port: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">],</span>
  <span class="ss">host: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">],</span>
  <span class="ss">ha: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'ha'</span><span class="p">],</span>
  <span class="ss">heartbeat_timeout_threshold: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'heartbeat_timeout_threshold'</span><span class="p">],</span>
  <span class="ss">heartbeat_rate: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'heartbeat_rate'</span><span class="p">],</span>
  <span class="ss">use_ssl: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'use_ssl'</span><span class="p">],</span>
  <span class="ss">kombu_ssl_version: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_ssl_version'</span><span class="p">],</span>
  <span class="ss">kombu_ssl_keyfile: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_ssl_keyfile'</span><span class="p">],</span>
  <span class="ss">kombu_ssl_certfile: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_ssl_certfile'</span><span class="p">],</span>
  <span class="ss">kombu_ssl_ca_certs: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_ssl_ca_certs'</span><span class="p">],</span>
  <span class="ss">kombu_reconnect_delay: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_reconnect_delay'</span><span class="p">],</span>
  <span class="ss">kombu_reconnect_timeout: </span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'kombu_reconnect_timeout'</span><span class="p">]</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Assign default mq attributes for every service</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">services</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">svc</span><span class="o">|</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="n">svc</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="n">svc</span><span class="p">][</span><span class="s1">'notification_topic'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'notifications'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="n">svc</span><span class="p">][</span><span class="s1">'durable_queues'</span><span class="p">]</span> <span class="o">=</span>
    <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'durable_queues'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="n">svc</span><span class="p">][</span><span class="s1">'auto_delete'</span><span class="p">]</span> <span class="o">=</span>
    <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'auto_delete'</span><span class="p">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="n">rabbit_defaults</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="o">|</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="n">svc</span><span class="p">][</span><span class="s1">'rabbit'</span><span class="p">][</span><span class="n">key</span><span class="p">.</span><span class="nf">to_s</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Overrides and additional attributes for individual services</p>

<p>bare-metal</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rabbit'</span><span class="p">][</span><span class="s1">'notification_topic'</span><span class="p">]</span> <span class="o">=</span>
  <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'notification_topic'</span><span class="p">]</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ironic'</span>
</code></pre>
</div>

<p>block-storage</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'rabbit'</span><span class="p">][</span><span class="s1">'notification_topic'</span><span class="p">]</span> <span class="o">=</span>
  <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'notification_topic'</span><span class="p">]</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder'</span>
</code></pre>
</div>

<p>image</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'notifier_strategy'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'noop'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'notification_topic'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'glance_notifications'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'rabbit'</span><span class="p">][</span><span class="s1">'notification_topic'</span><span class="p">]</span> <span class="o">=</span>
  <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'notification_topic'</span><span class="p">]</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'glance'</span>
</code></pre>
</div>

<p>identity
AMQP topics used for openstack notifications, can be comma-separated values</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'notification_topics'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'notifications'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'identity'</span>
</code></pre>
</div>

<p>network
AMQP topics used for openstack notifications, can be comma-separated values</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'notification_topics'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'notifications'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron'</span>
</code></pre>
</div>

<p>compute</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nova'</span>
</code></pre>
</div>

<p>orchestration</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'heat'</span>
</code></pre>
</div>

<p>telemetry</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ceilometer'</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-bare-metal">cookbook-openstack-bare-metal</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-bare-metal-readme">cookbook-openstack-bare-metal-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="cookbook-openstack-bare-metal-cookbook">cookbook-openstack-bare-metal Cookbook</h1>

<p>This cookbook installs the OpenStack Bare Metal service <strong>Ironic</strong> as part of
the OpenStack reference deployment Chef for OpenStack. Ironic is currently
installed from packages.</p>

<p>https://wiki.openstack.org/wiki/Ironic</p>

<h2 id="requirements-1">Requirements</h2>

<p>Chef 12 or higher required (for Chef environment use).</p>

<h2 id="attributes-1">Attributes</h2>

<p>Please see the extensive inline documentation in <code class="highlighter-rouge">attributes/*.rb</code> for descriptions
of all the settable attributes for this cookbook.</p>

<p>There are also many common attributes shared across the cookbooks that are found in
the cookbook-openstack-common cookbook attribute files.</p>

<p>Note that all attributes are in the <code class="highlighter-rouge">default["openstack"]</code> “namespace”</p>

<h2 id="usage-1">Usage</h2>
<p>#### cookbook-openstack-bare-metal::default
TODO: Write usage instructions for each cookbook.</p>

<hr />

<h3 id="cookbook-openstack-bare-metal-attributes-default">cookbook-openstack-bare-metal-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
"</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'verbose'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'false'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'debug'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'false'</span>
</code></pre>
</div>

<p>Maximum number of worker threads that can be started
simultaneously by a periodic task. Should be less than RPC
thread pool size. (integer value)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'conductor'</span><span class="p">][</span><span class="s1">'periodic_max_workers'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
</code></pre>
</div>

<p>The size of the workers greenthread pool. (integer value)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'conductor'</span><span class="p">][</span><span class="s1">'workers_pool_size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
</code></pre>
</div>

<p>Common rpc definitions</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rpc_thread_pool_size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rpc_conn_pool_size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rpc_response_timeout'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">60</span>
</code></pre>
</div>

<p>The name of the Chef role that knows about the message queue server
that Ironic uses</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rabbit_server_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-ops-messaging'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span>
<span class="k">when</span> <span class="s1">'rabbitmq'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rpc_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'rabbit'</span>
<span class="k">when</span> <span class="s1">'qpid'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rpc_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'qpid'</span>
<span class="k">end</span>
</code></pre>
</div>

<p>The AMQP exchange to connect to if using RabbitMQ or Qpid</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span>  <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span>
</code></pre>
</div>

<p>Logging stuff</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'log_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/ironic'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'LOG_LOCAL1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'config_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'local1'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
</code></pre>
</div>

<p>Keystone settings</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth_strategy'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span>
</code></pre>
</div>

<p>Whether to allow the client to perform insecure SSL (https) requests</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'insecure'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>Keystone PKI signing directories</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'cache_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/ironic/api'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'service_tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'service_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ironic'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'service_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ironic'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ironic'</span>
</code></pre>
</div>

<p>Setup the tftp variables</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'tftp'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># IP address of Ironic compute node's tftp server</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'tftp'</span><span class="p">][</span><span class="s1">'server'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="c1"># Ironic compute node's tftp root path</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'tftp'</span><span class="p">][</span><span class="s1">'root_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/lib/tftpboot'</span>
<span class="c1"># Directory where master tftp images are stored on disk</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'tftp'</span><span class="p">][</span><span class="s1">'master_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'tftp'</span><span class="p">][</span><span class="s1">'root_path'</span><span class="p">]</span><span class="si">}</span><span class="s2">/master_images"</span>
</code></pre>
</div>

<p>rootwrap.conf</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'filters_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/ironic/rootwrap.d,/usr/share/ironic/rootwrap'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'exec_dirs'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/sbin,/usr/sbin,/bin,/usr/bin'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'use_syslog'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'syslog_log_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'syslog'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'syslog_log_level'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ERROR'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform_family</span>
<span class="k">when</span> <span class="s1">'fedora'</span><span class="p">,</span> <span class="s1">'rhel'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'ironic_api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ironic-api'</span><span class="p">],</span>
    <span class="s1">'ironic_api_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ironic-api'</span><span class="p">,</span>
    <span class="s1">'ironic_conductor_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ironic-conductor'</span><span class="p">,</span> <span class="s1">'shellinabox'</span><span class="p">,</span> <span class="s1">'ipmitool'</span><span class="p">],</span>
    <span class="s1">'ironic_conductor_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ironic-conductor'</span><span class="p">,</span>
    <span class="s1">'ironic_common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ironic-common'</span><span class="p">,</span> <span class="s1">'python-ironicclient'</span><span class="p">]</span>
  <span class="p">}</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bare-metal'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'ironic_api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ironic-api'</span><span class="p">],</span>
    <span class="s1">'ironic_api_service'</span> <span class="o">=&gt;</span> <span class="s1">'ironic-api'</span><span class="p">,</span>
    <span class="s1">'ironic_conductor_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ironic-conductor'</span><span class="p">,</span> <span class="s1">'shellinabox'</span><span class="p">,</span> <span class="s1">'ipmitool'</span><span class="p">],</span>
    <span class="s1">'ironic_conductor_service'</span> <span class="o">=&gt;</span> <span class="s1">'ironic-conductor'</span><span class="p">,</span>
    <span class="s1">'ironic_common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-ironicclient'</span><span class="p">,</span> <span class="s1">'ironic-common'</span><span class="p">]</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-block-storage">cookbook-openstack-block-storage</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-block-storage-readme">cookbook-openstack-block-storage-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-1">Description</h1>

<p>Installs the OpenStack Block Storage service <strong>Cinder</strong> as part of the OpenStack reference deployment Chef for OpenStack. The https://github.com/openstack/openstack-chef-repo contains documentation for using this cookbook in the context of a full OpenStack deployment. Cinder is currently installed from packages.</p>

<p>http://cinder.openstack.org</p>

<h1 id="requirements-2">Requirements</h1>

<ul>
  <li>Chef 0.10.0 or higher required (for Chef environment use).</li>
</ul>

<h2 id="cookbooks-1">Cookbooks</h2>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>apt</li>
  <li>openstack-common</li>
  <li>openstack-identity</li>
  <li>openstack-image</li>
  <li>selinux (Fedora)</li>
</ul>

<h1 id="usage-2">Usage</h1>

<h2 id="api">api</h2>
<ul>
  <li>Installs the cinder-api, sets up the cinder database,
 and cinder service/user/endpoints in keystone</li>
</ul>

<h2 id="client-1">client</h2>
<ul>
  <li>Install the cinder client packages</li>
</ul>

<h2 id="scheduler">scheduler</h2>
<ul>
  <li>Installs the cinder-scheduler service</li>
</ul>

<h2 id="volume">volume</h2>
<ul>
  <li>Installs the cinder-volume service, sets up the iscsi helper and create volume group when using the LVMVolumeDriver</li>
</ul>

<p>Defaults to the LVM Volume Driver.</p>

<h1 id="attributes-2">Attributes</h1>

<ul>
  <li><code class="highlighter-rouge">openstack["block-storage"]["db"]["username"]</code> - cinder username for database</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["volume_name_template"]</code> - Template string to be used to generate volume names</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["snapshot_name_template"]</code> - Template string to be used to generate snapshot names</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['api']['auth']['version']</code> - Select v2.0 or v3.0. Default v2.0 inherited from common cookbook. The default auth API version used to interact with identity service</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['api']['auth']['memcached_servers']</code> - A list of memcached server(s) to use for caching</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['api']['auth']['memcache_security_strategy']</code> - Whether token data should be authenticated or authenticated and encrypted. Acceptable values are MAC or ENCRYPT</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['api']['auth']['memcache_secret_key']</code> - This string is used for key derivation</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['api']['auth']['hash_algorithms']</code> - Hash algorithms to use for hashing PKI tokens</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['api']['auth']['cafile']</code> - A PEM encoded Certificate Authority to use when verifying HTTPs connections</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['api']['auth']['insecure']</code> - Set whether to verify HTTPS connections</li>
</ul>

<h2 id="glance-attributes">Glance Attributes</h2>
<ul>
  <li><code class="highlighter-rouge">openstack["block-storage"]["image"]["glance_api_insecure"]</code> - If True, this indicates that glance-api allows the client to perform insecure SSL(https) requests, this should be the same as the setting in the glance-api service</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["image"]["glance_ca_certificates_file"]</code> - Location of ca certificates file to use for glance client requests</li>
</ul>

<h2 id="mq-attributes">MQ attributes</h2>
<ul>
  <li><code class="highlighter-rouge">openstack["block-storage"]["mq"]["service_type"]</code> - Select qpid or rabbitmq. default rabbitmq
TODO: move rabbit parameters under openstack[“block-storage”][“mq”]</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["rabbit"]["username"]</code> - Username for nova rabbit access</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["rabbit"]["vhost"]</code> - The rabbit vhost to use</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["rabbit"]["port"]</code> - The rabbit port to use</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["rabbit"]["host"]</code> - The rabbit host to use (must set when <code class="highlighter-rouge">openstack["block-storage"]["rabbit"]["ha"]</code> false).</li>
  <li>
    <p><code class="highlighter-rouge">openstack["block-storage"]["rabbit"]["ha"]</code> - Whether or not to use rabbit ha</p>
  </li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["mq"]["qpid"]["host"]</code> - The qpid host to use</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["mq"]["qpid"]["port"]</code> - The qpid port to use</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["mq"]["qpid"]["qpid_hosts"]</code> - Qpid hosts. TODO. use only when ha is specified.</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["mq"]["qpid"]["username"]</code> - Username for qpid connection</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["mq"]["qpid"]["password"]</code> - Password for qpid connection</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["mq"]["qpid"]["sasl_mechanisms"]</code> - Space separated list of SASL mechanisms to use for auth</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["mq"]["qpid"]["reconnect_timeout"]</code> - The number of seconds to wait before deciding that a reconnect attempt has failed.</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["mq"]["qpid"]["reconnect_limit"]</code> - The limit for the number of times to reconnect before considering the connection to be failed.</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["mq"]["qpid"]["reconnect_interval_min"]</code> - Minimum number of seconds between connection attempts.</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["mq"]["qpid"]["reconnect_interval_max"]</code> - Maximum number of seconds between connection attempts.</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["mq"]["qpid"]["reconnect_interval"]</code> - Equivalent to setting qpid_reconnect_interval_min and qpid_reconnect_interval_max to the same value.</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["mq"]["qpid"]["heartbeat"]</code> - Seconds between heartbeat messages sent to ensure that the connection is still alive.</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["mq"]["qpid"]["protocol"]</code> - Protocol to use. Default tcp.</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["mq"]["qpid"]["tcp_nodelay"]</code> - Disable the Nagle algorithm. default disabled.</li>
</ul>

<h2 id="cinder-attributes">Cinder attributes</h2>

<ul>
  <li><code class="highlighter-rouge">openstack["block-storage"]["service_tenant_name"]</code> - name of tenant to use for the cinder service account in keystone</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["service_user"]</code> - cinder service user in keystone</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["service_role"]</code> - role for the cinder service user in keystone</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["service_name"]</code> - Cinder Volume Service name in keystone, cinder for V1 and cinderv2 for v2.</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["service_type"]</code> - Cinder Volume Service type in keystone, volume for V1 and volumev2 for v2.</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["notification_driver"]</code> - Set the notification driver to be used (default to cinder.openstack.common.notifier.rpc_notifier)</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["syslog"]["use"]</code></li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["syslog"]["facility"]</code></li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["syslog"]["config_facility"]</code></li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["platform"]</code> - hash of platform specific package/service names and options</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["volume"]["state_path"]</code> - Top-level directory for maintaining cinder’s state</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["volume"]["driver"]</code> - Driver to use for volume creation
    <ul>
      <li>Supported volume drivers
        <ul>
          <li><strong>cinder.volume.drivers.netapp.iscsi.NetAppISCSIDriver</strong> - NetApp iSCSI driver for clustered Data</li>
          <li><strong>cinder.volume.drivers.rbd.RBDDriver</strong> - Ceph Block Device driver</li>
          <li><strong>cinder.volume.drivers.netapp.nfs.NetAppDirect7modeNfsDriver</strong> - NetApp NFS direct driver for 7-Mode storage controller</li>
          <li><strong>cinder.volume.drivers.ibm.storwize_svc.StorwizeSVCDriver</strong> -  IBM Storwize/SVC driver</li>
          <li><strong>cinder.volume.drivers.ibm.gpfs.GPFSDriver</strong> -  IBM General Parallel File System driver</li>
          <li><strong>cinder.volume.drivers.ibm.ibmnas.IBMNAS_NFSDriver</strong> - IBM Storwize V7000 Unified and IBM SONAS Cinder driver</li>
          <li><strong>cinder.volume.drivers.lvm.LVMVolumeDriver</strong> - LVM Driver</li>
          <li><strong>cinder.volume.drivers.emc.emc_smis_iscsi.EMCSMISISCSIDriver</strong> - EMC SMI-S iSCSI Driver</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["volume"]["volume_clear"]</code> - Defines the method for clearing volumes on a volume delete possible options: ‘zero’, ‘none’, ‘shred’ (https://review.openstack.org/#/c/12521/)</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["volume"]["volume_clear_size"]</code> - size in MB used to limit the cleared area on deleting a volume, to the first part of the volume only. (default 0 = all MB)</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["volume"]["volume_group"]</code> - Name for the VG that will contain exported volumes</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["voluem"]["volume_group_size"]</code> - The size (GB) of volume group (default is 40)</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["voluem"]["create_volume_group"]</code> - Create volume group or not when using the LVMVolumeDriver (default is false)</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["volume"]["create_volume_group_type"]</code> - ‘file’ or ‘block_devices’. Create volume group from block devices or just a file for testing</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["volume"]["block_devices"]</code> - String of blank separated block devices to use for creating volume group when type is ‘block_devices’</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["volume"]["iscsi_helper"]</code> - ISCSI target user-land tool to use</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["volume"]["iscsi_ip_address"]</code> - The IP address where the iSCSI daemon is listening on</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["volume"]["iscsi_port"]</code> - The port where the iSCSI daemon is listening on</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["rbd_pool"]</code> - RADOS Block Device pool to use</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["rbd_user"]</code> - User for Cephx Authentication</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["rbd_secret_uuid"]</code> - Secret UUID for Cephx Authentication</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["netapp"]["protocol"]</code> - How are we talking to either dfm or filer, http or https</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["netapp"]["dfm_hostname"]</code> - Host or IP of your dfm server</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["netapp"]["dfm_login"]</code> - Username for dfm</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["netapp"]["dfm_password"]</code> - Password for the dfm user</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["netapp"]["dfm_port"]</code> - Default port for dfm</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["netapp"]["dfm_web_port"]</code> - Web gui port for wsdl file download</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["netapp"]["storage_service"]</code> - Name of the service in dfpm</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["netapp"]["netapp_server_port"]</code> - Web admin port of the filer itself</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["netapp"]["netapp_server_hostname"]</code> - Hostname of your filer, needs to be resolvable</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["netapp"]["netapp_server_login"]</code> - Username for netapp filer</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["netapp"]["netapp_server_password"]</code> - Password for user above</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["nfs"]["shares_config"]</code> - File containing line by line entries of server:export</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["nfs"]["mount_point_base"]</code> - Directory to mount NFS exported shares</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["control_exchange"]</code> - The AMQP exchange to connect to if using RabbitMQ or Qpid, defaults to cinder</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["rpc_backend"]</code> - The messaging module to use, defaults to kombu.</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["rpc_thread_pool_size"]</code> - Size of RPC thread pool</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["rpc_conn_pool_size"]</code> - Size of RPC connection pool</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["rpc_response_timeout"]</code> - Seconds to wait for a response from call or multicall</li>
  <li>`openstack[“block-storage”][“misc_cinder”] - Array of strings to be added to cinder.conf for misc options, e.g. [’# Comment’, ‘key=value’]</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["enable_v1_api"]</code> - Whether to enable cinder v1 api or not.</li>
  <li><code class="highlighter-rouge">openstack["block-storage"]["enable_v2_api"]</code> - Whether to enable cinder v2 api or not.</li>
</ul>

<h3 id="storwizesvc-attributes">Storwize/SVC attributes</h3>
<ul>
  <li>`openstack[‘block-storage’][‘san’][‘san_ip’] - IP address of SAN controller</li>
  <li>`openstack[‘block-storage’][‘san’][‘san_login’] - Username for SAN controller</li>
  <li>`openstack[‘block-storage’][‘san’][‘san_private_key’] - Filename of private key to use for SSH authentication</li>
  <li>`openstack[‘block-storage’][‘san’][‘san_private_key_url’] - Source url of private key to use for SSH authentication</li>
  <li>`openstack[‘block-storage’][‘storwize’][‘storwize_svc_volpool_name’] - Storage system storage pool for volumes</li>
  <li>`openstack[‘block-storage’][‘storwize’][‘storwize_svc_vol_rsize’] - Storage system space-efficiency parameter for volumes</li>
  <li>`openstack[‘block-storage’][‘storwize’][‘storwize_svc_vol_warning’] - Storage system threshold for volume capacity warnings</li>
  <li>`openstack[‘block-storage’][‘storwize’][‘storwize_svc_vol_autoexpand’] - Storage system autoexpand parameter for volumes</li>
  <li>`openstack[‘block-storage’][‘storwize’][‘storwize_svc_vol_grainsize’] - Storage system grain size parameter for volumes</li>
  <li>`openstack[‘block-storage’][‘storwize’][‘storwize_svc_vol_compression’] - Storage system compression option for volumes</li>
  <li>`openstack[‘block-storage’][‘storwize’][‘storwize_svc_vol_easytier’] - Enable Easy Tier for volumes</li>
  <li>`openstack[‘block-storage’][‘storwize’][‘storwize_svc_vol_iogrp’] - The I/O group in which to allocate volumes</li>
  <li>`openstack[‘block-storage’][‘storwize’][‘storwize_svc_flashcopy_timeout’] - Maximum number of seconds to wait for FlashCopy to be prepared</li>
  <li>`openstack[‘block-storage’][‘storwize’][‘storwize_svc_connection_protocol’] - Connection protocol (iSCSI/FC)</li>
  <li>`openstack[‘block-storage’][‘storwize’][‘storwize_svc_iscsi_chap_enabled’] - Configure CHAP authentication for iSCSI connections</li>
  <li>`openstack[‘block-storage’][‘storwize’][‘storwize_svc_multipath_enabled’] - Connect with multipath (FC only; iSCSI multipath is controlled by Nova)</li>
  <li>`openstack[‘block-storage’][‘storwize’][‘storwize_svc_multihostmap_enabled’] - Allows vdisk to multi host mapping</li>
  <li>`openstack[‘block-storage’][‘storwize’][‘storwize_svc_allow_tenant_qos’] - Allow tenants to specify QOS on create</li>
  <li>`openstack[‘block-storage’][‘storwize’][‘storwize_svc_stretched_cluster_partner’] - Enable volume-replication for stretched cluster</li>
</ul>

<h3 id="flashsystem-attributes">FlashSystem attributes</h3>
<ul>
  <li>`openstack[‘block-storage’][‘san’][‘san_ip’] - IP address of FlashSystem Cluster node</li>
  <li>`openstack[‘block-storage’][‘san’][‘san_login’] - Username for FlashSystem Cluster node</li>
  <li>`openstack[‘block-storage’][‘flashsystem’][‘flashsystem_connection_protocol’] - The connection protocol for FlashSystem data path (FC)</li>
  <li>`openstack[‘block-storage’][‘flashsystem’][‘flashsystem_multipath_enabled’] - The multipath enablement flag (FC only)</li>
  <li>`openstack[‘block-storage’][‘flashsystem’][‘flashsystem_multihostmap_enabled’] - Enable vdisk to multi-host mapping</li>
</ul>

<h3 id="vmware-attributes">VMware attributes</h3>
<ul>
  <li><code class="highlighter-rouge">openstack['block-storage']['vmware']['secret_name']</code> - VMware databag secret name</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['vmware']['vmware_host_ip']</code> - IP address for connecting to VMware ESX/VC server. (string value)</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['vmware']['vmware_host_username']</code> - Username for authenticating with VMware ESX/VC server. (string value)</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['vmware']['vmware_wsdl_location']</code> - Optional VIM service WSDL Location e.g http://<server>/vimService.wsdl. Optional over-ride to default location for bug work-arounds. (string value)</server></li>
  <li><code class="highlighter-rouge">openstack['block-storage']['vmware']['vmware_api_retry_count']</code> - Number of times VMware ESX/VC server API must be retried upon connection related issues. (integer value, default 10)</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['vmware']['vmware_task_poll_interval']</code> - The interval (in seconds) for polling remote tasks invoked on VMware ESX/VC server. (integer value, default 5)</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['vmware']['vmware_volume_folder']</code> - Name for the folder in the VC datacenter that will contain cinder volumes. (string value, default cinder-volumes)</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['vmware']['vmware_image_transfer_timeout_secs']</code> - Timeout in seconds for VMDK volume transfer between Cinder and Glance. (integer value, default 7200)</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['vmware']['vmware_max_objects_retrieval']</code> - Max number of objects to be retrieved per batch. (integer value, default 100)</li>
</ul>

<h3 id="ibm-gpfs-attributes">IBM GPFS attributes</h3>
<ul>
  <li><code class="highlighter-rouge">openstack['block-storage']['gpfs']['gpfs_mount_point_base']</code> - Path to directory in GPFS filesystem where volume files are located (string value)</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['gpfs']['gpfs_images_dir']</code> - Path to directory in GPFS filesystem where Glance images are located (string value)</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['gpfs']['gpfs_images_share_mode']</code> - Type of image copy to use, either “copy_on_write” or “copy” (string value)</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['gpfs']['gpfs_sparse_volumes']</code> - Create volumes as sparse or fully allocated files (boolean value, default true)</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['gpfs']['gpfs_max_clone_depth']</code> - Maximum clone indirections allowed when creating volume file snapshots clones; zero indicates unlimited clone depth (integer, defalut 0)</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['gpfs']['gpfs_storage_pool']</code> - GPFS storage pool that volumes are assigned to (string value)</li>
</ul>

<h3 id="ibmnas-sonasstorwize-v7000-unified-attributes">IBMNAS (SONAS/Storwize V7000 Unified) attributes</h3>
<ul>
  <li><code class="highlighter-rouge">openstack['block-storage']['ibmnas']['nas_ip']</code> - Management IP address of IBMNAS storage</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['ibmnas']['nas_login']</code> - Username for IBMNAS storage system</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['ibmnas']['nas_access_ip']</code> - Hostname/Public IP address to access shares</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['ibmnas']['nas_ssh_port']</code> - ssh port of IBMNAS storage</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['ibmnas']['export']</code> - Storage system shares/export path parameter</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['ibmnas']['shares_config']</code> - File that contains list of IBMNAS Shares</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['ibmnas']['mount_point_base']</code> - Storage system autoexpand parameter for volumes</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['ibmnas']['nfs_sparsed_volumes']</code> - Storage system volume creation method</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['ibmnas']['ibmnas_platform_type']</code> - Platform type to be used as backend storage</li>
</ul>

<h3 id="multiple-backends-attributes">Multiple backends attributes</h3>
<ul>
  <li><code class="highlighter-rouge">openstack['block-storage']['volume']['multi_backend']</code> - Hash map to indicate multiple backends sections, e.g. { ‘lvm1’ =&gt; { ‘volume_driver’ =&gt; ‘cinder.volume.drivers.lvm.LVMVolumeDriver’, ‘volume_backend_name’ =&gt; ‘lvm1’ }, ‘lvm2’ =&gt; { ‘volume_driver’ =&gt; ‘cinder.volume.drivers.lvm.LVMVolumeDriver’, ‘volume_backend_name’ =&gt; ‘lvm2’ } }</li>
  <li><code class="highlighter-rouge">default['openstack']['block-storage']['volume']['default_volume_type']</code> - String to indicate the volume_type that maps to one of the configured volume backends</li>
</ul>

<p>The following attributes are defined in attributes/default.rb of the common cookbook, but are documented here due to their relevance:</p>

<ul>
  <li><code class="highlighter-rouge">openstack['endpoints']['block-storage-api-bind']['host']</code> - The IP address to bind the api service to</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['block-storage-api-bind']['port']</code> - The port to bind the api service to</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['block-storage-api-bind']['bind_interface']</code> - The interface name to bind the api service to</li>
</ul>

<h3 id="backup-service-attributes">Backup service attributes</h3>
<ul>
  <li><code class="highlighter-rouge">openstack['block-storage']['backup']['enabled']</code> - Whether to enable cinder backup service or not.</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['backup']['driver']</code> - The driver for cinder backup service.</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['backup']['swift']['url']</code> - The URL of Swift endpoint.</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['backup']['swift']['catalog_info']</code> - Info to match when looking for swift in the service catalog.</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['backup']['swift']['auth']</code> - Swift authentication mechanism.</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['backup']['swift']['auth_version']</code> - Swift authentication version.</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['backup']['swift']['user']</code> - Swift user name.</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['backup']['swift']['tenant']</code> - Swift tenant/account name. Required when connecting.</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['backup']['swift']['key']</code> - Swift key for authentication.</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['backup']['swift']['container']</code> - The default Swift container to use.</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['backup']['swift']['object_size']</code> - The size in bytes of Swift backup objects.</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['backup']['swift']['block_size']</code> - The size in bytes that changes are tracked for incremental backups.</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['backup']['swift']['retry_attempts']</code> - The number of retries to make for Swift operations.</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['backup']['swift']['retry_backoff']</code> - The backoff time in seconds between Swift retries.</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['backup']['swift']['enable_progress_timer']</code> - Enable or Disable the timer to send the periodic progress notifications to Ceilometer when backing up the volume to the Swift backend storage.</li>
</ul>

<h3 id="keymgr-configuration-attributes">Keymgr configuration attributes</h3>
<ul>
  <li><code class="highlighter-rouge">openstack['block-storage']['keymgr']['api_class']</code> - The key manager api class to use.</li>
  <li><code class="highlighter-rouge">openstack['block-storage']['keymgr']['fixed_key']</code> - The fixed key returned by key manager, specified in hex (string value).</li>
</ul>

<p>If the value of the ‘bind_interface’ attribute is non-nil, then the block-storage service will be bound to the first IP address on that interface.  If the value of the ‘bind_interface’ attribute is nil, then the block-storage service will be bound to the IP address specified in the host attribute.</p>

<hr />

<h3 id="cookbook-openstack-block-storage-attributes-cinderconf">cookbook-openstack-block-storage-attributes-cinder_conf</h3>

<p><a href="#contents">back to top</a></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'conf_secrets'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'notification_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder.openstack.common.notifier.rpc_notifier'</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_config'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack/logging.conf'</span>
  <span class="k">end</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'rpc_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'auth_strategy'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'volume_group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder-volumes'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'state_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/lib/cinder'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'auth_plugin'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'region_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'signing_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/cinder/api'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'oslo_concurrency'</span><span class="p">][</span><span class="s1">'lock_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/lib/cinder/tmp'</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-block-storage-attributes-default">cookbook-openstack-block-storage-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Toggles - These can be overridden at the environment level</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'developer_mode'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span> <span class="c1"># we want secure passwords by default</span>
<span class="c1">########################################################################</span>
</code></pre>
</div>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
'</span>
</code></pre>
</div>

<p>Specify policy.json remote file to import</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'policyfile_url'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Availability zone/region for the OpenStack Block-Storage service</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'scheduler_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-block-storage-scheduler'</span>
</code></pre>
</div>

<p>The name of the Chef role that knows about the message queue server
that Cinder uses</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'rabbit_server_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-ops-messaging'</span>
</code></pre>
</div>

<p>This is the name of the Chef role that will install the Keystone Service API</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'keystone_service_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'service_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'service_tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'service_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'service_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinderv2'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'volumev2'</span>
</code></pre>
</div>

<p>logging attribute</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'LOG_LOCAL2'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'config_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'local2'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'volume'</span><span class="p">][</span><span class="s1">'volume_group_size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">40</span>
<span class="c1"># Type of volume group to create:</span>
<span class="c1"># - 'file' for basic 40g file for testing</span>
<span class="c1"># - 'block_devices' for using block devices, specified in block_devices attribute</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'volume'</span><span class="p">][</span><span class="s1">'create_volume_group_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'file'</span>
<span class="c1"># String of local disk device paths</span>
<span class="c1"># Examples: '/dev/sdx /dev/sdx1' or '/dev/sd[k-m]1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'volume'</span><span class="p">][</span><span class="s1">'block_devices'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform_family</span>
<span class="k">when</span> <span class="s1">'rhel'</span> <span class="c1"># :pragma-foodcritic: ~FC024 - won't fix this</span>
  <span class="c1"># operating system user and group names</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'volume'</span><span class="p">][</span><span class="s1">'iscsi_helper'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'lioadm'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'cinder_common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-cinder'</span><span class="p">],</span>
    <span class="s1">'cinder_api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-cinderclient'</span><span class="p">],</span>
    <span class="s1">'cinder_api_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-cinder-api'</span><span class="p">,</span>
    <span class="s1">'cinder_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-cinderclient'</span><span class="p">],</span>
    <span class="s1">'cinder_volume_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'qemu-img'</span><span class="p">],</span>
    <span class="s1">'cinder_volume_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-cinder-volume'</span><span class="p">,</span>
    <span class="s1">'cinder_scheduler_packages'</span> <span class="o">=&gt;</span> <span class="p">[],</span>
    <span class="s1">'cinder_scheduler_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-cinder-scheduler'</span><span class="p">,</span>
    <span class="s1">'cinder_backup_packages'</span> <span class="o">=&gt;</span> <span class="p">[],</span>
    <span class="s1">'cinder_backup_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-cinder-backup'</span><span class="p">,</span>
    <span class="s1">'cinder_iscsitarget_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'targetcli'</span><span class="p">],</span>
    <span class="s1">'cinder_iscsitarget_service'</span> <span class="o">=&gt;</span> <span class="s1">'target'</span><span class="p">,</span>
    <span class="s1">'cinder_ceph_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-ceph'</span><span class="p">,</span> <span class="s1">'ceph-common'</span><span class="p">],</span>
    <span class="s1">'cinder_nfs_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nfs-utils'</span><span class="p">,</span> <span class="s1">'nfs-utils-lib'</span><span class="p">],</span>
    <span class="s1">'cinder_emc_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'pywbem'</span><span class="p">],</span>
    <span class="s1">'cinder_svc_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'sysfsutils'</span><span class="p">],</span>
    <span class="s1">'cinder_lvm_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'lvm2'</span><span class="p">],</span>
    <span class="s1">'cinder_flashsystem_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'sysfsutils'</span><span class="p">],</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="c1"># operating system user and group names</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'cinder_common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'cinder-common'</span><span class="p">],</span>
    <span class="s1">'cinder_api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'cinder-api'</span><span class="p">,</span> <span class="s1">'python-cinderclient'</span><span class="p">],</span>
    <span class="s1">'cinder_api_service'</span> <span class="o">=&gt;</span> <span class="s1">'cinder-api'</span><span class="p">,</span>
    <span class="s1">'cinder_volume_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'cinder-volume'</span><span class="p">,</span> <span class="s1">'qemu-utils'</span><span class="p">],</span>
    <span class="s1">'cinder_volume_service'</span> <span class="o">=&gt;</span> <span class="s1">'cinder-volume'</span><span class="p">,</span>
    <span class="s1">'cinder_scheduler_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'cinder-scheduler'</span><span class="p">],</span>
    <span class="s1">'cinder_scheduler_service'</span> <span class="o">=&gt;</span> <span class="s1">'cinder-scheduler'</span><span class="p">,</span>
    <span class="s1">'cinder_backup_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'cinder-backup'</span><span class="p">],</span>
    <span class="s1">'cinder_backup_service'</span> <span class="o">=&gt;</span> <span class="s1">'cinder-backup'</span><span class="p">,</span>
    <span class="s1">'cinder_ceph_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-ceph'</span><span class="p">,</span> <span class="s1">'ceph-common'</span><span class="p">],</span>
    <span class="s1">'cinder_iscsitarget_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'tgt'</span><span class="p">],</span>
    <span class="s1">'cinder_iscsitarget_service'</span> <span class="o">=&gt;</span> <span class="s1">'tgt'</span><span class="p">,</span>
    <span class="s1">'cinder_nfs_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nfs-common'</span><span class="p">],</span>
    <span class="s1">'cinder_emc_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-pywbem'</span><span class="p">],</span>
    <span class="s1">'cinder_svc_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'sysfsutils'</span><span class="p">],</span>
    <span class="s1">'cinder_lvm_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'lvm2'</span><span class="p">],</span>
    <span class="s1">'cinder_flashsystem_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'sysfsutils'</span><span class="p">],</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s2">"-o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef'"</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<p><strong>**</strong><strong>**</strong><strong>**</strong>** OpenStack Volume Endpoints <strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong>*****
The OpenStack Volume (Cinder) API endpoint</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="sx">%w(public internal admin)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">ep_type</span><span class="o">|</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'scheme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/v2/%(tenant_id)s'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'8776'</span>
<span class="k">end</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'block-storage'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'8776'</span>

<span class="o">=============================</span> <span class="n">rootwrap</span> <span class="no">Configuration</span> <span class="o">===================</span>
<span class="n">use</span> <span class="n">cinder</span> <span class="n">root</span> <span class="n">wrap</span>

<span class="sb">``` ruby
default['openstack']['block-storage']['use_rootwrap'] = true
# rootwrap.conf
default['openstack']['block-storage']['rootwrap']['conf'].tap do |conf|
  conf['DEFAULT']['filters_path'] = '/etc/cinder/rootwrap.d,/usr/share/cinder/rootwrap'
  conf['DEFAULT']['exec_dirs'] = '/sbin,/usr/sbin,/bin,/usr/bin'
  conf['DEFAULT']['use_syslog'] = false
  conf['DEFAULT']['syslog_log_facility'] = 'syslog'
  conf['DEFAULT']['syslog_log_level'] = 'ERROR'
end
</span></code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-client">cookbook-openstack-client</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-client-readme">cookbook-openstack-client-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="openstack-cookbook">Openstack Cookbook</h1>

<p>This is a library cookbook to consume openstack cloud resources.</p>

<h2 id="requirements-3">Requirements</h2>

<ul>
  <li>TBD</li>
</ul>

<h2 id="attributes-3">Attributes</h2>

<p>Attributes are self documented in <code class="highlighter-rouge">attributes/*.rb</code></p>

<h2 id="usage-3">Usage</h2>
<p>#### openstack::default</p>

<p>Installs <a href="http://fog.io">fog</a> gem and enabled LWRPs</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"my_node"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"run_list"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"recipe[openstack]"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h4 id="openstackexampleswift">openstack::_example_swift</h4>

<p>Example usage of swift LWRPs</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"my_node"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"run_list"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"recipe[openstack]"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"recipe[openstack::_example_swift]"</span><span class="p">,</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>If you need a simple swift endpoint to test against, the following blog post will help you set up a <a href="http://blog.phymata.com/2013/02/18/swift-only-with-openstack-devstack-on-the-rackspace-cloud/">single node swift on rackspace cloud</a>.</p>

<hr />

<h3 id="cookbook-openstack-client-attributes-default">cookbook-openstack-client-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Dependencies and versions</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack_client'</span><span class="p">][</span><span class="s1">'fog_version'</span><span class="p">]</span>      <span class="o">=</span> <span class="s1">'~&gt; 1.23.0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack_client'</span><span class="p">][</span><span class="s1">'nokogiri_version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'~&gt; 1.6.2.1'</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-compute">cookbook-openstack-compute</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-compute-readme">cookbook-openstack-compute-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-2">Description</h1>

<p>This cookbook installs the OpenStack Compute service <strong>Nova</strong> as part of the OpenStack reference deployment Chef for OpenStack. The https://github.com/mattray/openstack-chef-repo contains documentation for using this cookbook in the context of a full OpenStack deployment. Nova is currently installed from packages.</p>

<p>http://nova.openstack.org</p>

<h1 id="requirements-4">Requirements</h1>

<p>Chef 12 or higher required.</p>

<h2 id="cookbooks-2">Cookbooks</h2>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>openstack-common</li>
  <li>openstack-identity</li>
  <li>openstack-image</li>
  <li>openstack-network</li>
  <li>selinux (Fedora)</li>
  <li>python</li>
</ul>

<h1 id="usage-4">Usage</h1>

<h2 id="api-ec2">api-ec2</h2>
<ul>
  <li>This is obsoleted by https://github.com/cloudscaling/cookbook-openstack-ec2</li>
</ul>

<h2 id="api-metadata">api-metadata</h2>
<ul>
  <li>Includes recipe <code class="highlighter-rouge">nova-common</code></li>
  <li>Installs the nova metadata package</li>
</ul>

<h2 id="api-os-compute">api-os-compute</h2>
<ul>
  <li>Includes recipe <code class="highlighter-rouge">nova-common</code></li>
  <li>Installs OS API and configures the service and endpoints in keystone</li>
</ul>

<h2 id="client-2">client</h2>
<ul>
  <li>Install the nova client packages</li>
</ul>

<h2 id="compute">compute</h2>
<ul>
  <li>Includes recipes <code class="highlighter-rouge">nova-common</code>, <code class="highlighter-rouge">api-metadata</code>, <code class="highlighter-rouge">network</code></li>
  <li>Installs nova-compute service</li>
</ul>

<h2 id="libvirt">libvirt</h2>
<ul>
  <li>Installs libvirt, used by nova compute for management of the virtual machine environment</li>
</ul>

<h2 id="libvirtrbd">libvirt_rbd</h2>
<ul>
  <li>Prepares the compute node for interaction with a Ceph cluster for block storage (RBD)</li>
  <li>Depends on <code class="highlighter-rouge">ceph::_common</code>, <code class="highlighter-rouge">ceph::install</code>, and <code class="highlighter-rouge">ceph::conf</code> for packages and cluster connectivity (i.e. a proper <code class="highlighter-rouge">/etc/ceph/ceph.conf</code>)</li>
</ul>

<h2 id="network">network</h2>
<ul>
  <li>Includes recipe <code class="highlighter-rouge">nova-common</code></li>
  <li>Installs nova network service</li>
</ul>

<h2 id="nova-cert">nova-cert</h2>
<ul>
  <li>Installs nova-cert service</li>
</ul>

<h2 id="nova-common">nova-common</h2>
<ul>
  <li>May include recipe <code class="highlighter-rouge">selinux</code> (Fedora)</li>
  <li>Builds the basic nova.conf config file with details of the rabbitmq, mysql, glance and keystone servers</li>
</ul>

<h2 id="nova-setup">nova-setup</h2>
<ul>
  <li>Includes recipes <code class="highlighter-rouge">nova-common</code></li>
  <li>Sets up the nova networks with <code class="highlighter-rouge">nova-manage</code></li>
</ul>

<h2 id="scheduler-1">scheduler</h2>
<ul>
  <li>Includes recipe <code class="highlighter-rouge">nova-common</code></li>
  <li>Installs nova scheduler service</li>
</ul>

<h2 id="vncproxy">vncproxy</h2>
<ul>
  <li>Includes recipe <code class="highlighter-rouge">nova-common</code></li>
  <li>Installs and configures the vncproxy service for console access to VMs</li>
</ul>

<h2 id="serialproxy">serialproxy</h2>
<ul>
  <li>Includes recipe <code class="highlighter-rouge">nova-common</code></li>
  <li>Installs and configures the serialproxy service for serial console access to VMs</li>
</ul>

<h1 id="attributes-4">Attributes</h1>

<p>Openstack Compute attributes are in the attribute namespace [“openstack”][“compute”].</p>

<ul>
  <li><code class="highlighter-rouge">openstack["compute"]["identity_service_chef_role"]</code> - The name of the Chef role that sets up the Keystone Service API</li>
  <li><code class="highlighter-rouge">openstack["compute"]["user"]</code> - User nova services run as</li>
  <li><code class="highlighter-rouge">openstack["compute"]["group"]</code> - Group nova services run as</li>
  <li><code class="highlighter-rouge">openstack["compute"]["db"]["username"]</code> - Username for nova database access</li>
  <li><code class="highlighter-rouge">openstack["compute"]["service_tenant_name"]</code> - Tenant name used by nova when interacting with keystone</li>
  <li><code class="highlighter-rouge">openstack["compute"]["service_user"]</code> - User name used by nova when interacting with keystone</li>
  <li><code class="highlighter-rouge">openstack["compute"]["service_role"]</code> - User role used by nova when interacting with keystone</li>
  <li><code class="highlighter-rouge">openstack["compute"]["floating_cmd"]</code> - Path to the <code class="highlighter-rouge">nova-manage floating create</code> wrapper script.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["osapi_compute_workers"]</code> - Number of api workers</li>
  <li><code class="highlighter-rouge">openstack["compute"]["metadata_workers"]</code> - Number of metadata workders</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["volume_api_class"]</code> - API Class used for Volume support</li>
  <li>`openstack[‘compute’][‘driver’] = Driver to use for controlling virtualization</li>
  <li>`openstack[‘compute’][‘manager’] = Full class name for the Manager for compute</li>
  <li>`openstack[‘compute’][‘default_ephemeral_format’] = The default format an ephemeral_volume will be formatted with on creation</li>
  <li>`openstack[‘compute’][‘preallocate_images’] = VM image preallocation mode</li>
  <li>`openstack[‘compute’][‘use_cow_images’] = Whether to use cow images</li>
  <li>`openstack[‘compute’][‘vif_plugging_is_fatal’] = Fail instance boot if vif plugging fails</li>
  <li>`openstack[‘compute’][‘vif_plugging_timeout’] = Number of seconds to wait for neutron vif plugging events to arrive before continuing or failing</li>
  <li>`openstack[‘compute’][‘ssl_only’] = Disallow non-encrypted connections</li>
  <li>`openstack[‘compute’][‘cert’] = SSL certificate file</li>
  <li>`openstack[‘compute’][‘key’] = SSL key file (if separate from cert)</li>
  <li><code class="highlighter-rouge">openstack['compute']['dbsync_timeout']</code> - Set dbsync command timeout value</li>
  <li><code class="highlighter-rouge">openstack["compute"]["compute"]["api"]["protocol"]</code> - Protocol used for the OS API</li>
  <li><code class="highlighter-rouge">openstack["compute"]["compute"]["api"]["port"]</code> - Port on which OS API runs</li>
  <li><code class="highlighter-rouge">openstack["compute"]["compute"]["api"]["version"]</code> - Version of the OS API used</li>
  <li><code class="highlighter-rouge">openstack["compute"]["compute"]["adminURL"]</code> - URL used to access the OS API for admin functions</li>
  <li><code class="highlighter-rouge">openstack["compute"]["compute"]["internalURL"]</code> - URL used to access the OS API for user functions from an internal network</li>
  <li><code class="highlighter-rouge">openstack["compute"]["compute"]["publicURL"]</code> - URL used to access the OS API for user functions from an external network</li>
  <li><code class="highlighter-rouge">openstack["compute"]["compute"]["dnsmasq_config_file"]</code> - Override the default dnsmasq settings with this file</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["availability_zone"]</code> - Nova availability zone.  Usually set at the node level to place a compute node in another az</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["default_schedule_zone"]</code> - The availability zone to schedule instances in when no az is specified in the request</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["force_raw_images"]</code> - Convert all images used as backing files for instances to raw (we default to false)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["allow_same_net_traffic"]</code> - Disable security groups for internal networks (we default to true)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["osapi_max_limit"]</code> - The maximum number of items returned in a single response from a collection resource (default is 1000)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["osapi_compute_link_prefix"]</code> - Base URL that will be presented to users in links to the OpenStack Compute API (default is nil)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["osapi_glance_link_prefix"]</code> - Base URL that will be presented to users in links to glance resources(default is nil)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["cpu_allocation_ratio"]</code> - Virtual CPU to Physical CPU allocation ratio (default 16.0)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["ram_allocation_ratio"]</code> - Virtual RAM to Physical RAM allocation ratio (default 1.5)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["snapshot_image_format"]</code> - Snapshot image format (valid options are : raw, qcow2, vmdk, vdi [we default to qcow2]).</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["start_guests_on_host_boot"]</code> - Whether to restart guests when the host reboots</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["resume_guests_state_on_host_boot"]</code> - Whether to start guests that were running before the host rebooted</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["disk_allocation_ratio"]</code> - Virtual disk to physical disk allocation ratio (default 1.0)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["allow_resize_to_same_host"]</code> - Allow destination machine to match source for resize. Useful when testing in single-host environments (default is false)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["resize_confirm_window"]</code> -  Automatically confirm resizes after N seconds, Set to 0 to disable (default is 0)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["reserved_host_memory_mb"]</code> - Amount of disk in MB to reserve for the host (default is 512)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["disk_cachemodes"]</code> - Cachemodes to use for different disk types e.g: “file=directsync,block=none”.  Valid cache values are “default”, “none”, “writethrough”, “writeback”, “directsync” and “unsafe”.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["live_migration_retry_count"]</code> - Number of 1 second retries needed in live_migration</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["flat_injected"]</code> - Whether to attempt to inject network setup into guest. Used by config_drive support.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["config_drive_format"]</code> - Config drive format.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["api"]["signing_dir"]</code> - Keystone PKI needs a location to hold the signed tokens</li>
  <li><code class="highlighter-rouge">openstack["compute"]["api"]["signing_dir"]</code> - Keystone PKI needs a location to hold the signed tokens</li>
  <li><code class="highlighter-rouge">openstack["compute"]["rpc_thread_pool_size"]</code> - Size of RPC thread pool (default 64)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["rpc_conn_pool_size"]</code> - Size of RPC connection pool (default 30)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["rpc_response_timeout"]</code> - Seconds to wait for a response from call or multicall (default 60)</li>
  <li><code class="highlighter-rouge">openstack['compute']['api']['auth']['version']</code> - Select v2.0 or v3.0. Default v2.0. The auth API version used to interact with identity service.</li>
  <li><code class="highlighter-rouge">openstack['compute']['api']['auth']['memcached_servers']</code> - A list of memcached server(s) for caching</li>
  <li><code class="highlighter-rouge">openstack['compute']['api']['auth']['memcache_security_strategy']</code> - Whether token data should be authenticated or authenticated and encrypted. Acceptable values are MAC or ENCRYPT.</li>
  <li><code class="highlighter-rouge">openstack['compute']['api']['auth']['memcache_secret_key']</code> - This string is used for key derivation.</li>
  <li><code class="highlighter-rouge">openstack['compute']['api']['auth']['hash_algorithms']</code> - Hash algorithms to use for hashing PKI tokens.</li>
  <li><code class="highlighter-rouge">openstack['compute']['api']['auth']['cafile']</code> - A PEM encoded Certificate Authority to use when verifying HTTPs connections.</li>
  <li><code class="highlighter-rouge">openstack['compute']['api']['auth']['insecure']</code> - Whether to allow the client to perform insecure SSL (https) requests.</li>
  <li><code class="highlighter-rouge">openstack['compute']['conductor']['workers']</code> = Number of conductor workers</li>
</ul>

<h2 id="mq-attributes-1">MQ attributes</h2>
<ul>
  <li><code class="highlighter-rouge">openstack["compute"]["mq"]["service_type"]</code> - Select qpid or rabbitmq. default rabbitmq
TODO: move rabbit parameters under openstack[“compute”][“mq”]</li>
  <li><code class="highlighter-rouge">openstack["compute"]["rabbit"]["username"]</code> - Username for nova rabbit access</li>
  <li><code class="highlighter-rouge">openstack["compute"]["rabbit"]["vhost"]</code> - The rabbit vhost to use</li>
  <li><code class="highlighter-rouge">openstack["compute"]["rabbit"]["port"]</code> - The rabbit port to use</li>
  <li><code class="highlighter-rouge">openstack["compute"]["rabbit"]["host"]</code> - The rabbit host to use (must set when <code class="highlighter-rouge">openstack["compute"]["rabbit"]["ha"]</code> false).</li>
  <li><code class="highlighter-rouge">openstack["compute"]["rabbit"]["ha"]</code> - Whether or not to use rabbit ha</li>
  <li><code class="highlighter-rouge">openstack["compute"]["rabbit"]["heartbeat_timeout_threshold"]</code> - Number of seconds after which the Rabbit broker is considered down if heartbeat’s keep-alive fails (0 disable the heartbeat)</li>
  <li>
    <p><code class="highlighter-rouge">openstack["compute"]["rabbit"]["heartbeat_rate"]</code> - How often times during the heartbeat_timeout_threshold we check the heartbeat</p>
  </li>
  <li><code class="highlighter-rouge">openstack["compute"]["mq"]["qpid"]["host"]</code> - The qpid host to use</li>
  <li><code class="highlighter-rouge">openstack["compute"]["mq"]["qpid"]["port"]</code> - The qpid port to use</li>
  <li><code class="highlighter-rouge">openstack["compute"]["mq"]["qpid"]["qpid_hosts"]</code> - Qpid hosts. TODO. use only when ha is specified.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["mq"]["qpid"]["username"]</code> - Username for qpid connection</li>
  <li><code class="highlighter-rouge">openstack["compute"]["mq"]["qpid"]["password"]</code> - Password for qpid connection</li>
  <li><code class="highlighter-rouge">openstack["compute"]["mq"]["qpid"]["sasl_mechanisms"]</code> - Space separated list of SASL mechanisms to use for auth</li>
  <li><code class="highlighter-rouge">openstack["compute"]["mq"]["qpid"]["reconnect_timeout"]</code> - The number of seconds to wait before deciding that a reconnect attempt has failed.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["mq"]["qpid"]["reconnect_limit"]</code> - The limit for the number of times to reconnect before considering the connection to be failed.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["mq"]["qpid"]["reconnect_interval_min"]</code> - Minimum number of seconds between connection attempts.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["mq"]["qpid"]["reconnect_interval_max"]</code> - Maximum number of seconds between connection attempts.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["mq"]["qpid"]["reconnect_interval"]</code> - Equivalent to setting qpid_reconnect_interval_min and qpid_reconnect_interval_max to the same value.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["mq"]["qpid"]["heartbeat"]</code> - Seconds between heartbeat messages sent to ensure that the connection is still alive.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["mq"]["qpid"]["protocol"]</code> - Protocol to use. Default tcp.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["mq"]["qpid"]["tcp_nodelay"]</code> - Disable the Nagle algorithm. default disabled.</li>
</ul>

<h2 id="glance-attributes-1">Glance Attributes</h2>

<ul>
  <li><code class="highlighter-rouge">openstack["compute"]["image"]["glance_api_insecure"]</code> - If True, this indicates that glance-api allows the client to perform insecure SSL(https) requests, this should be the same as the setting in the glance-api service.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["image"]["ssl"]["ca_file"]</code> - CA certificate file to use to verify connecting clients.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["image"]["ssl"]["cert_file"]</code> - Certificate file to use when starting the server securely.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["image"]["ssl"]["key_file"]</code> - Private key file to use when starting the server securely.</li>
</ul>

<h2 id="cinder-attributes-1">Cinder Attributes</h2>

<ul>
  <li><code class="highlighter-rouge">openstack["compute"]["block-storage"]["cinder_ca_certificates_file"]</code> - Location of ca certificates file to use for cinder client requests.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["block-storage"]["cinder_api_insecure"]</code> - Allow to perform insecure SSL requests to cinder.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["block-storage"]["cinder_catalog_info"]</code> - Info to match when looking for cinder in the service catalog.</li>
</ul>

<h2 id="networking-attributes">Networking Attributes</h2>

<p>Basic networking configuration is controlled with the following attributes:</p>

<ul>
  <li><code class="highlighter-rouge">openstack["compute"]["network"]["network_manager"]</code> - Defaults to “nova.network.manager.FlatDHCPManager”. Set to “nova.network.manager.VlanManager” to configure VLAN Networking.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["network"]["dmz_cidr"]</code> - A CIDR for the range of IP addresses that will NOT be SNAT’ed by the nova network controller</li>
  <li><code class="highlighter-rouge">openstack["compute"]["network"]["public_interface"]</code> - Defaults to eth0. Refers to the network interface used for VM addresses`.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["network"]["vlan_interface"]</code> - Defaults to eth0. Refers to the network interface used for VM addresses when VMs are assigned in a VLAN subnet.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["network"]["auto_assign_floating_ip"]</code> - Defaults to false. Autoassigning floating ip to VM, this should be only for nova network.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["network"]["force_dhcp_release"]</code> - If True, send a dhcp release on instance termination. (Default is false on “fedora”, “redhat”, “centos”)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["network"]["use_ipv6"]</code> - If True, use ipv6 support.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["network"]["neutron"]["api_insecure"]</code> - If True, this indicates that neutron-api allows the client to perform insecure SSL (https) requests. This should be the same as the setting in the neutron api service.</li>
</ul>

<p>You can have the cookbook automatically create networks in Nova for you by adding a Hash to the <code class="highlighter-rouge">openstack["compute"]["networks"]</code> Array.
<strong>Note</strong>: The <code class="highlighter-rouge">openstack-compute::nova-setup</code> recipe contains the code that creates these pre-defined networks.</p>

<p>Each Hash must contain the following keys:</p>

<ul>
  <li><code class="highlighter-rouge">ipv4_cidr</code> - The CIDR representation of the subnet. Supplied to the nova-manage network create command as <code class="highlighter-rouge">--fixed_ipv4_range</code></li>
  <li><code class="highlighter-rouge">label</code> - A name for the network</li>
</ul>

<p>In addition to the above required keys in the Hash, the below keys are optional:</p>

<ul>
  <li><code class="highlighter-rouge">num_networks</code> - Passed as-is to <code class="highlighter-rouge">nova-manage network create</code> as the <code class="highlighter-rouge">--num_networks</code> option. This overrides the default <code class="highlighter-rouge">num_networks</code> nova.conf value.</li>
  <li><code class="highlighter-rouge">network_size</code> - Passed as-is to <code class="highlighter-rouge">nova-manage network create</code> as the <code class="highlighter-rouge">--network_size</code> option. This overrides the default <code class="highlighter-rouge">network_size</code> nova.conf value.</li>
  <li><code class="highlighter-rouge">bridge</code> - Passed as-is to <code class="highlighter-rouge">nova-manage network create</code> as the <code class="highlighter-rouge">--bridge</code> option.</li>
  <li><code class="highlighter-rouge">bridge_interface</code> – Passed as-is to <code class="highlighter-rouge">nova-manage network create</code> as the <code class="highlighter-rouge">--bridge_interface</code> option. This overrides the default <code class="highlighter-rouge">vlan_interface</code> nova.conf value.</li>
  <li><code class="highlighter-rouge">dns1</code> - Passed as-is to <code class="highlighter-rouge">nova-manage network create</code> as the <code class="highlighter-rouge">--dns1</code> option.</li>
  <li><code class="highlighter-rouge">dns2</code> - Passed as-is to <code class="highlighter-rouge">nova-manage network create</code> as the <code class="highlighter-rouge">--dns2</code> option.</li>
  <li><code class="highlighter-rouge">multi_host</code> - Passed as-is to <code class="highlighter-rouge">nova-manage network create</code> as the <code class="highlighter-rouge">--multi_host</code> option. Values should be either ‘T’ or ‘F’</li>
  <li><code class="highlighter-rouge">vlan</code> - Passed as-is to <code class="highlighter-rouge">nova-manage network create</code> as the <code class="highlighter-rouge">--vlan</code> option. Should be the VLAN tag ID.</li>
</ul>

<p>By default, the <code class="highlighter-rouge">openstack["compute"]["networks"]</code> array has two networks:</p>

<ul>
  <li><code class="highlighter-rouge">openstack["compute"]["networks"]["public"]["label"]</code> - Network label to be assigned to the public network on creation</li>
  <li><code class="highlighter-rouge">openstack["compute"]["networks"]["public"]["ipv4_cidr"]</code> - Network to be created (in CIDR notation, e.g., 192.168.100.0/24)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["networks"]["public"]["num_networks"]</code> - Number of networks to be created</li>
  <li><code class="highlighter-rouge">openstack["compute"]["networks"]["public"]["network_size"]</code> - Number of IP addresses to be used in this network</li>
  <li><code class="highlighter-rouge">openstack["compute"]["networks"]["public"]["bridge"]</code> - Bridge to be created for accessing the VM network (e.g., br100)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["networks"]["public"]["bridge_dev"]</code> - Physical device on which the bridge device should be attached (e.g., eth2)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["networks"]["public"]["dns1"]</code> - DNS server 1</li>
  <li>
    <p><code class="highlighter-rouge">openstack["compute"]["networks"]["public"]["dns2"]</code> - DNS server 2</p>
  </li>
  <li><code class="highlighter-rouge">openstack["compute"]["networks"]["private"]["label"]</code> - Network label to be assigned to the private network on creation</li>
  <li><code class="highlighter-rouge">openstack["compute"]["networks"]["private"]["ipv4_cidr"]</code> - Network to be created (in CIDR notation e.g., 192.168.200.0/24)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["networks"]["private"]["num_networks"]</code> - Number of networks to be created</li>
  <li><code class="highlighter-rouge">openstack["compute"]["networks"]["private"]["network_size"]</code> - Number of IP addresses to be used in this network</li>
  <li><code class="highlighter-rouge">openstack["compute"]["networks"]["private"]["bridge"]</code> - Bridge to be created for accessing the VM network (e.g., br200)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["networks"]["private"]["bridge_dev"]</code> - Physical device on which the bridge device should be attached (e.g., eth3)</li>
</ul>

<h2 id="libvirt-configuration-attributes">Libvirt Configuration Attributes</h2>

<ul>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["virt_type"]</code> - What hypervisor software layer to use with libvirt (e.g., kvm, qemu)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["volume_backend"]</code> - What block storage backend to use with libvirt (e.g. rbd)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["auth_tcp"]</code> - Type of authentication your libvirt layer requires</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["ssh"]["private_key"]</code> - Private key to use if using SSH authentication to your libvirt layer</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["ssh"]["public_key"]</code> - Public key to use if using SSH authentication to your libvirt layer</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["max_clients"]</code> - Maximum number of concurrent client connections to allow over all sockets combined. (default: 20)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["max_workers"]</code> - Maximum number of workers spawned, typically equal to max_clients. (default: 20)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["max_requests"]</code> - Total global limit on concurrent RPC calls. Should be at least as large as max_workers. (default: 20)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["max_client_requests"]</code> - Limit on concurrent requests from a single client connection. (default: 5)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["libvirt_inject_key"]</code> - Inject the ssh public key at boot time, without an agent. (default: true)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["libvirt_inject_password"]</code> - Inject the admin password at boot time, without an agent. (default: false)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["libvirt_inject_partition"]</code> - The partition to inject to : -2 =&gt; disable, -1 =&gt; inspect (libguestfs only), 0 =&gt; not partitioned, &gt;0 =&gt; partition number. (default: -2)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["images_type"]</code> - How to store local images (ephemeral disks): raw, qcow2, lvm, rbd, or default</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["volume_group"]</code> - When images_type is lvm: volume group to use</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["sparse_logical_volumes"]</code> - When images_type is lvm: use sparse logical volumes</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["unix_sock_rw_perms"]</code> - Set the UNIX socket permissions for the R/W socket. This is used for full management of VMs.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["live_migration_bandwidth"]</code> - Maximum bandwidth to be used during migration, in Mbps.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["live_migration_flag"]</code> - Migration flags to be set for live migration.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["block_migration_flag"]</code> - Migration flags to be set for block migration.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["live_migration_uri"]</code> - Migration target URI (any included “%s” is replaced with the migration target hostname).</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["rbd"]["glance"]["pool"]</code> - When images_type is rbd: use this RBD pool for images</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["rbd"]["cinder"]["pool"]</code> - When images_type is rbd: use this RBD pool for volumes</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["rbd"]["nova"]["pool"]</code> - When images_type is rbd: use this RBD pool for instances</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["rbd"]["ceph_conf"]</code> - When images_type is rbd: use this ceph.conf</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["rbd"]["cinder"]["user"]</code> - The cephx user used for accessing the RBD pool used for block storage. (Which pool to use is passed by cinder when nova-compute is instructed to mount a volume.)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["rbd"]["cinder"]["secret_uuid"]</code> - A shared secret between cinder and libvirt.  It should be the same as the secret_uuid that is defined in block-storage.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["libvirt"]["rng_dev_path"]</code> - A path to a device that will be used as source of entropy on the host. Permitted options are: /dev/random or /dev/hwrng (string value)</li>
</ul>

<h2 id="bare-metal-configuration-attributes">Bare Metal Configuration Attributes</h2>

<ul>
  <li><code class="highlighter-rouge">openstack['compute']['scheduler']['use_baremetal_filters']</code> Boolean that decides whether to use baremetal_scheduler_default_filters or not.
If this attribute is set to true, the following attributes will be overwritten:
<code class="highlighter-rouge">openstack['compute']['driver']</code>
<code class="highlighter-rouge">openstack['compute']['manager']</code>
<code class="highlighter-rouge">openstack['compute']['scheduler']['scheduler_host_manager']</code>
<code class="highlighter-rouge">openstack['compute']['config']['ram_allocation_ratio']</code>
<code class="highlighter-rouge">openstack['compute']['config']['reserved_host_memory_mb']</code></li>
  <li><code class="highlighter-rouge">openstack['compute']['scheduler']['baremetal_default_filters']</code> A list of filters enabled for baremetal schedulers that support them.</li>
</ul>

<h2 id="keymgr-configuration-attributes-1">Keymgr Configuration Attributes</h2>

<ul>
  <li>`openstack[“compute”][“keymgr”][“api_class”] - the full class name of the key manager API class.</li>
  <li>`openstack[“compute”][“keymgr”][“fixed_key”] - the fixed key returned by key manager, specified in hex (string value).</li>
</ul>

<h2 id="scheduler-configuration-attributes">Scheduler Configuration Attributes</h2>

<ul>
  <li><code class="highlighter-rouge">openstack["compute"]["scheduler"]["scheduler_manager"]</code> - the scheduler manager to use</li>
  <li><code class="highlighter-rouge">openstack["compute"]["scheduler"]["scheduler_driver"]</code> - the scheduler driver to use
NOTE: The filter scheduler currently does not work with ec2.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["scheduler"]["available_filters"]</code> - Filter classes available to the scheduler which may be specified more than once.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["scheduler"]["default_filters"]</code> - a list of filters enabled for schedulers that support them.</li>
</ul>

<h2 id="syslog-configuration-attributes">Syslog Configuration Attributes</h2>

<ul>
  <li><code class="highlighter-rouge">openstack["compute"]["syslog"]["use"]</code> - Should nova log to syslog?</li>
  <li><code class="highlighter-rouge">openstack["compute"]["syslog"]["facility"]</code> - Which facility nova should use when logging in python style (for example, <code class="highlighter-rouge">LOG_LOCAL1</code>)</li>
  <li><code class="highlighter-rouge">openstack["compute"]["syslog"]["config_facility"]</code> - Which facility nova should use when logging in rsyslog style (for example, local1)</li>
</ul>

<h2 id="osapi-compute-extentions">OSAPI Compute Extentions</h2>

<ul>
  <li><code class="highlighter-rouge">openstack["compute"]["plugins"]</code> - Array of osapi compute exntesions to add to nova</li>
</ul>

<h2 id="miscellaneous-options">Miscellaneous Options</h2>

<p>Arrays whose elements will be copied exactly into the respective config files (contents e.g. [‘option1=value1’, ‘option2=value2’]).</p>

<ul>
  <li><code class="highlighter-rouge">openstack["compute"]["misc_nova"]</code> - Array of bare options for <code class="highlighter-rouge">nova.conf</code>.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["misc_paste"]</code> - Array of bare options for <code class="highlighter-rouge">api-paste.ini</code></li>
</ul>

<h2 id="api-configuration-attributes">API Configuration Attributes</h2>

<ul>
  <li><code class="highlighter-rouge">openstack["compute"]["enabled_apis"]</code> - Which apis have been enabled in nova compute, only for osapi_compute. For metadata, include the api-metadata recipe.</li>
</ul>

<h2 id="notification-attributes">Notification Attributes</h2>

<ul>
  <li><code class="highlighter-rouge">openstack["compute"]["metering"]</code>- Boolean that indicates whether to enable the metering attributes with sensible defaults. Default is false.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["notification_drivers"]</code>- An array of drivers to handle sending notifications.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["instance_usage_audit"]</code>- Boolean that indicates whether to generate intance usage audits.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["instance_usage_audit_period"]</code>- Time period to generate instance usages for.  Time period must be “hour”, “day”, “month” or “year”.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["notify_on_state_change"]</code>- If set, send compute.instance.update notifications on instance state changes.  Valid values are None, “vm_state” or “vm_and_task_state”.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["notification_topics"]</code>- AMQP topic used for OpenStack notifications.</li>
</ul>

<p>When enabling nova metering with ceilometer, the notification configuration
properties need to be set to values that are different from the default values
used when metering is off. In order to facilitate setting all those
notification properties, the cookbook includes the <code class="highlighter-rouge">openstack["compute"]["metering"]</code>
attribute which when set to <code class="highlighter-rouge">true</code> will automatically set all notification
properties to the suggested defaults.</p>

<p>One of the notification_drivers that is set when metering is on comes from
ceilometer. In order for the notification driver to be available, make sure
the <code class="highlighter-rouge">os-telemetry-agent-compute</code> role (or the openstack-telemetry::agent-compute recipe)
are set on this node.</p>

<h2 id="monitor-attributes">Monitor Attributes</h2>

<ul>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["compute_available_monitors"]</code>- Monitor classes available to the compute.</li>
  <li><code class="highlighter-rouge">openstack["compute"]["config"]["compute_monitors"]</code>- An array of monitors that can be used for getting compute metrics.</li>
</ul>

<h2 id="vmware-configuration-attributes">VMware Configuration Attributes</h2>

<ul>
  <li><code class="highlighter-rouge">openstack['compute']['vmware']['secret_name']</code> - VMware databag secret name</li>
  <li><code class="highlighter-rouge">openstack['compute']['vmware']['host_ip']</code> - URL for connection to VMware ESX/VC host. (string value)</li>
  <li><code class="highlighter-rouge">openstack['compute']['vmware']['host_username']</code> - Username for connection to VMware ESX/VC host. (string value)</li>
  <li><code class="highlighter-rouge">openstack['compute']['vmware']['cluster_name']</code> - Name of a VMware Cluster ComputeResource. Used only if compute_driver is vmwareapi.VMwareVCDriver. (multi valued)</li>
  <li><code class="highlighter-rouge">openstack['compute']['vmware']['datastore_regex']</code> - Regex to match the name of a datastore. (string value)</li>
  <li><code class="highlighter-rouge">openstack['compute']['vmware']['task_poll_interval']</code> - The interval used for polling of remote tasks. (floating point value, default 0.5)</li>
  <li><code class="highlighter-rouge">openstack['compute']['vmware']['api_retry_count']</code> - The number of times we retry on failures, e.g., socket error, etc. (integer value, default 10)</li>
  <li><code class="highlighter-rouge">openstack['compute']['vmware']['vnc_port']</code> - VNC starting port (integer value, default 5900)</li>
  <li><code class="highlighter-rouge">openstack['compute']['vmware']['vnc_port_total']</code> - Total number of VNC ports (integer value, default 10000)</li>
  <li><code class="highlighter-rouge">openstack['compute']['vmware']['use_linked_clone']</code> - Whether to use linked clone (boolean value, default true)</li>
  <li><code class="highlighter-rouge">openstack['compute']['vmware']['vlan_interface']</code> - Physical ethernet adapter name for vlan networking (string value, default vmnic0)</li>
  <li><code class="highlighter-rouge">openstack['compute']['vmware']['wsdl_location']</code> - Optional VIM Service WSDL Location, you must specify this location of the WSDL files when you try to connect vSphere vCenter versions 5.0 and earlier.</li>
  <li><code class="highlighter-rouge">openstack['compute']['vmware']['maximum_objects']</code> - The maximum number of ObjectContent data objects that should be returned in a single result. (integer value, default 100)</li>
  <li><code class="highlighter-rouge">openstack['compute']['vmware']['integration_bridge']</code> - Name of Integration Bridge (string value, default br-int)</li>
</ul>

<h2 id="upgrade-levels-attribute">Upgrade levels Attribute</h2>
<ul>
  <li><code class="highlighter-rouge">openstack['openstack']['compute']['upgrade_levels']</code> - The RPC version numbers or release name alias</li>
</ul>

<h2 id="docker-configuration-attributes">Docker configuration Attributes</h2>

<ul>
  <li><code class="highlighter-rouge">['openstack']['compute']['docker']['enable']</code> - Mark this as true to make compute docker type and use nova docker driver as compute driver. Docker computes are supported only in Ubuntu and Rhel</li>
  <li><code class="highlighter-rouge">['openstack']['compute']['docker']['driver']</code> - The nova docker driver that will be configured in a docker type compute</li>
  <li><code class="highlighter-rouge">['openstack']['compute']['platform']['docker_build_pkgs']</code> - Additoinal packages required for nova docker driver build and installation from git source</li>
  <li><code class="highlighter-rouge">['openstack']['compute']['docker']['pip_build_pkgs']</code> - Additional python packages required for nova docker driver build and installation from git source</li>
  <li><code class="highlighter-rouge">['openstack']['compute']['docker']['github']['repository']</code> - github repository from which nova-docker source will be downloaded</li>
  <li><code class="highlighter-rouge">['openstack']['compute']['docker']['github']['branch']</code> - github branch from which nova-docker source will be downloaded. Default is master</li>
  <li><code class="highlighter-rouge">['openstack']['compute']['docker']['filter_source_path']</code> - Relative path to docker filter files in nova-docker source which will be cloned from git repo</li>
  <li><code class="highlighter-rouge">['openstack']['compute']['docker']['service_sock']</code> - Path to docker service sock file</li>
  <li><code class="highlighter-rouge">['openstack']['compute']['docker']['service_sock_mode']</code> - Permission level to be assigned to docker sock file</li>
  <li><code class="highlighter-rouge">['openstack']['compute']['docker']['group']</code> - Docker group which will be created and added with openstack compute user</li>
</ul>

<p>The following attributes are defined in attributes/default.rb of the common cookbook, but are documented here due to their relevance:</p>

<ul>
  <li><code class="highlighter-rouge">openstack['endpoints']['compute-compute api-bind']['host']</code> - The IP address to bind the compute api service to</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['compute-compute api-bind']['port']</code> - The port to bind the compute api service to</li>
  <li>
    <p><code class="highlighter-rouge">openstack['endpoints']['compute-compute api-bind']['bind_interface']</code> - The interface name to bind the compute api service to</p>
  </li>
  <li><code class="highlighter-rouge">openstack['endpoints']['compute-xvpvnc-bind']['host']</code> - The IP address to bind the xvpvnc service to</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['compute-xvpvnc-bind']['port']</code> - The port to bind the xvpvnc service to</li>
  <li>
    <p><code class="highlighter-rouge">openstack['endpoints']['compute-xvpvnc-bind']['bind_interface']</code> - The interface name to bind the xvpvnc service to</p>
  </li>
  <li><code class="highlighter-rouge">openstack['endpoints']['compute-novnc-bind']['host']</code> - The IP address to bind the novnc service to</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['compute-novnc-bind']['port']</code> - The port to bind the novnc service to</li>
  <li>
    <p><code class="highlighter-rouge">openstack['endpoints']['compute-novnc-bind']['bind_interface']</code> - The interface name to bind the novnc service to</p>
  </li>
  <li><code class="highlighter-rouge">openstack['endpoints']['compute-vnc-bind']['host']</code> - The IP address to bind the vnc service to</li>
  <li>
    <p><code class="highlighter-rouge">openstack['endpoints']['compute-vnc-bind']['bind_interface']</code> - The interface name to bind the vnc service to</p>
  </li>
  <li><code class="highlighter-rouge">openstack['endpoints']['compute-vnc-proxy-bind']['host']</code> - The IP address to bind the vnc proxy service to</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['compute-vnc-proxy-bind']['bind_interface']</code> - The interface name to bind the vnc proxy service to</li>
</ul>

<p>If the value of the ‘bind_interface’ attribute is non-nil, then the service will be bound to the first IP address on that interface.  If the value of the ‘bind_interface’ attribute is nil, then the service will be bound to the IP address specified in the host attribute.</p>

<hr />

<h3 id="cookbook-openstack-compute-attributes-default">cookbook-openstack-compute-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'enable_monit'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span> <span class="c1"># OS provides packages</span>
<span class="c1">########################################################################</span>
</code></pre>
</div>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
'</span>
</code></pre>
</div>

<p>The name of the Chef role that knows about the message queue server
that Nova uses</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'rabbit_server_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-ops-messaging'</span>
</code></pre>
</div>

<p>Set dbsync command timeout value</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'dbsync_timeout'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3600</span>
</code></pre>
</div>

<p>The name of the Chef role that sets up the Keystone Service API</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'identity_service_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-identity'</span>
</code></pre>
</div>

<p>Disallow non-encrypted connections</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'service_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform_family</span>
<span class="k">when</span> <span class="s1">'rhel'</span><span class="p">,</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nova'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nova'</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Logging stuff</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'LOG_LOCAL1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'config_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'local1'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'floating_cmd'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/usr/local/bin/add_floaters.py'</span>
</code></pre>
</div>

<p>rootwrap.conf</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'filters_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/nova/rootwrap.d,/usr/share/nova/rootwrap'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'exec_dirs'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/sbin,/usr/sbin,/bin,/usr/bin'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'use_syslog'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'False'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'syslog_log_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'syslog'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'syslog_log_level'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ERROR'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'libvirt.LibvirtDriver'</span>
</code></pre>
</div>

<p>libvirtd_opts used in template for /etc/default/libvirt-bin</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'libvirtd_opts'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'-d -l'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'auth_tcp'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'none'</span>
<span class="c1"># libvirt.max_clients (default: 20)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'max_clients'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
<span class="c1"># libvirt.max_workers (default: 20)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'max_workers'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
<span class="c1"># libvirt.max_requests (default: 20)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'max_requests'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
<span class="c1"># libvirt.max_client_requests (default: 5)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'max_client_requests'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'libvirtd'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'unix_sock_rw_perms'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'0770'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'libvirt_inject_key'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="c1"># rbd</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'rbd'</span><span class="p">][</span><span class="s1">'ceph_conf'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/ceph/ceph.conf'</span>
<span class="c1"># use a different backend for volumes, allowed options: rbd</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'volume_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'rbd'</span><span class="p">][</span><span class="s1">'cinder'</span><span class="p">][</span><span class="s1">'pool'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'volumes'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'rbd'</span><span class="p">][</span><span class="s1">'glance'</span><span class="p">][</span><span class="s1">'pool'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'images'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'rbd'</span><span class="p">][</span><span class="s1">'nova'</span><span class="p">][</span><span class="s1">'pool'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'instances'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'rbd'</span><span class="p">][</span><span class="s1">'cinder'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'rbd'</span><span class="p">][</span><span class="s1">'cinder'</span><span class="p">][</span><span class="s1">'secret_uuid'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'00000000-0000-0000-0000-000000000000'</span>
</code></pre>
</div>

<p>Base URL that will be presented to users in links
to the OpenStack Compute API</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'osapi_compute_link_prefix'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="c1"># Base URL that will be presented to users in links</span>
<span class="c1"># to glance resources</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'osapi_glance_link_prefix'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'cpu_allocation_ratio'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span><span class="o">.</span><span class="mi">0</span>
</code></pre>
</div>

<p><code class="highlighter-rouge">start</code> will cause nova-compute to error out if a VM is already running, where
<code class="highlighter-rouge">resume</code> checks to see if it is running first.
requires https://review.openstack.org/#/c/8423/</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'resume_guests_state_on_host_boot'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'ratelimit'</span><span class="p">][</span><span class="s1">'settings'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'generic-post-limit'</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">'verb'</span> <span class="o">=&gt;</span> <span class="s1">'POST'</span><span class="p">,</span> <span class="s1">'uri'</span> <span class="o">=&gt;</span> <span class="s1">'*'</span><span class="p">,</span> <span class="s1">'regex'</span> <span class="o">=&gt;</span> <span class="s1">'.*'</span><span class="p">,</span> <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="s1">'10'</span><span class="p">,</span> <span class="s1">'interval'</span> <span class="o">=&gt;</span> <span class="s1">'MINUTE'</span> <span class="p">},</span>
  <span class="s1">'create-servers-limit'</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">'verb'</span> <span class="o">=&gt;</span> <span class="s1">'POST'</span><span class="p">,</span> <span class="s1">'uri'</span> <span class="o">=&gt;</span> <span class="s1">'*/servers'</span><span class="p">,</span> <span class="s1">'regex'</span> <span class="o">=&gt;</span> <span class="s1">'^/servers'</span><span class="p">,</span> <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="s1">'50'</span><span class="p">,</span> <span class="s1">'interval'</span> <span class="o">=&gt;</span> <span class="s1">'DAY'</span> <span class="p">},</span>
  <span class="s1">'generic-put-limit'</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">'verb'</span> <span class="o">=&gt;</span> <span class="s1">'PUT'</span><span class="p">,</span> <span class="s1">'uri'</span> <span class="o">=&gt;</span> <span class="s1">'*'</span><span class="p">,</span> <span class="s1">'regex'</span> <span class="o">=&gt;</span> <span class="s1">'.*'</span><span class="p">,</span> <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="s1">'10'</span><span class="p">,</span> <span class="s1">'interval'</span> <span class="o">=&gt;</span> <span class="s1">'MINUTE'</span> <span class="p">},</span>
  <span class="s1">'changes-since-limit'</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">'verb'</span> <span class="o">=&gt;</span> <span class="s1">'GET'</span><span class="p">,</span> <span class="s1">'uri'</span> <span class="o">=&gt;</span> <span class="s1">'*changes-since*'</span><span class="p">,</span> <span class="s1">'regex'</span> <span class="o">=&gt;</span> <span class="s1">'.*changes-since.*'</span><span class="p">,</span> <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="s1">'3'</span><span class="p">,</span> <span class="s1">'interval'</span> <span class="o">=&gt;</span> <span class="s1">'MINUTE'</span> <span class="p">},</span>
  <span class="s1">'generic-delete-limit'</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">'verb'</span> <span class="o">=&gt;</span> <span class="s1">'DELETE'</span><span class="p">,</span> <span class="s1">'uri'</span> <span class="o">=&gt;</span> <span class="s1">'*'</span><span class="p">,</span> <span class="s1">'regex'</span> <span class="o">=&gt;</span> <span class="s1">'.*'</span><span class="p">,</span> <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="s1">'100'</span><span class="p">,</span> <span class="s1">'interval'</span> <span class="o">=&gt;</span> <span class="s1">'MINUTE'</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Metering settings</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'metering'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span> <span class="c1">####</span>
</code></pre>
</div>

<p>Notification settings</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'metering'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'notification_drivers'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'nova.openstack.common.notifier.rpc_notifier'</span><span class="p">,</span> <span class="s1">'ceilometer.compute.nova_notifier'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'instance_usage_audit'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'True'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'instance_usage_audit_period'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'hour'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'notify_on_state_change'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'vm_and_task_state'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'notification_topics'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'notifications'</span><span class="p">]</span>
<span class="k">else</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'notification_drivers'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'instance_usage_audit'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'False'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'instance_usage_audit_period'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'month'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'notify_on_state_change'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">''</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'notification_topics'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'notifications'</span><span class="p">]</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Monitor settings</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'config'</span><span class="p">][</span><span class="s1">'compute_available_monitors'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'nova.compute.monitors.all_monitors'</span><span class="p">]</span>
</code></pre>
</div>

<p>Keystone settings</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth_strategy'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span>
</code></pre>
</div>

<p>A PEM encoded Certificate Authority to use when verifying HTTPs connections.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'cafile'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Keystone PKI signing directories</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'cache_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/nova/api'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform_family</span>
<span class="k">when</span> <span class="s1">'rhel'</span> <span class="c1"># :pragma-foodcritic: ~FC024 - won't fix this</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'api_os_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-api'</span><span class="p">],</span>
    <span class="s1">'api_os_compute_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-nova-api'</span><span class="p">,</span>
    <span class="s1">'neutron_python_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-neutronclient'</span><span class="p">,</span> <span class="s1">'pyparsing'</span><span class="p">],</span>
    <span class="s1">'memcache_python_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-memcached'</span><span class="p">],</span>
    <span class="s1">'compute_api_metadata_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-api'</span><span class="p">],</span>
    <span class="s1">'compute_api_metadata_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-nova-metadata-api'</span><span class="p">,</span>
    <span class="s1">'compute_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-novaclient'</span><span class="p">],</span>
    <span class="s1">'compute_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-compute'</span><span class="p">],</span>
    <span class="s1">'qemu_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[],</span>
    <span class="s1">'kvm_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[],</span>
    <span class="s1">'compute_compute_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-nova-compute'</span><span class="p">,</span>
    <span class="s1">'compute_scheduler_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-scheduler'</span><span class="p">],</span>
    <span class="s1">'compute_scheduler_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-nova-scheduler'</span><span class="p">,</span>
    <span class="s1">'compute_conductor_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-conductor'</span><span class="p">],</span>
    <span class="s1">'compute_conductor_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-nova-conductor'</span><span class="p">,</span>
    <span class="s1">'compute_vncproxy_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-novncproxy'</span><span class="p">],</span>
    <span class="s1">'compute_vncproxy_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-nova-novncproxy'</span><span class="p">,</span>
    <span class="s1">'compute_vncproxy_consoleauth_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-console'</span><span class="p">],</span>
    <span class="s1">'compute_vncproxy_consoleauth_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-nova-consoleauth'</span><span class="p">,</span>
    <span class="s1">'compute_serialproxy_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-serialproxy'</span><span class="p">],</span>
    <span class="s1">'compute_serialproxy_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-nova-serialproxy'</span><span class="p">,</span>
    <span class="s1">'libvirt_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'libvirt'</span><span class="p">,</span> <span class="s1">'device-mapper'</span><span class="p">,</span> <span class="s1">'python-libguestfs'</span><span class="p">],</span>
    <span class="s1">'libvirt_service'</span> <span class="o">=&gt;</span> <span class="s1">'libvirtd'</span><span class="p">,</span>
    <span class="s1">'libvirt_ceph_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceph-common'</span><span class="p">],</span>
    <span class="s1">'dbus_service'</span> <span class="o">=&gt;</span> <span class="s1">'messagebus'</span><span class="p">,</span>
    <span class="s1">'compute_cert_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-cert'</span><span class="p">],</span>
    <span class="s1">'compute_cert_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-nova-cert'</span><span class="p">,</span>
    <span class="s1">'mysql_service'</span> <span class="o">=&gt;</span> <span class="s1">'mysqld'</span><span class="p">,</span>
    <span class="s1">'common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-nova-common'</span><span class="p">],</span>
    <span class="s1">'iscsi_helper'</span> <span class="o">=&gt;</span> <span class="s1">'ietadm'</span><span class="p">,</span>
    <span class="s1">'volume_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'sysfsutils'</span><span class="p">,</span> <span class="s1">'sg3_utils'</span><span class="p">,</span> <span class="s1">'device-mapper-multipath'</span><span class="p">],</span>
    <span class="s1">'docker_build_pkgs'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'git'</span><span class="p">,</span> <span class="s1">'python-devel'</span><span class="p">,</span> <span class="s1">'gcc'</span><span class="p">],</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'api_os_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-api-os-compute'</span><span class="p">],</span>
    <span class="s1">'api_os_compute_service'</span> <span class="o">=&gt;</span> <span class="s1">'nova-api-os-compute'</span><span class="p">,</span>
    <span class="s1">'memcache_python_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-memcache'</span><span class="p">],</span>
    <span class="s1">'neutron_python_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-neutronclient'</span><span class="p">,</span> <span class="s1">'python-pyparsing'</span><span class="p">],</span>
    <span class="s1">'compute_api_metadata_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-api-metadata'</span><span class="p">],</span>
    <span class="s1">'compute_api_metadata_service'</span> <span class="o">=&gt;</span> <span class="s1">'nova-api-metadata'</span><span class="p">,</span>
    <span class="s1">'compute_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-novaclient'</span><span class="p">],</span>
    <span class="s1">'compute_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-compute'</span><span class="p">],</span>
    <span class="s1">'qemu_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-compute-qemu'</span><span class="p">],</span>
    <span class="s1">'kvm_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-compute-kvm'</span><span class="p">],</span>
    <span class="s1">'compute_compute_service'</span> <span class="o">=&gt;</span> <span class="s1">'nova-compute'</span><span class="p">,</span>
    <span class="s1">'compute_scheduler_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-scheduler'</span><span class="p">],</span>
    <span class="s1">'compute_scheduler_service'</span> <span class="o">=&gt;</span> <span class="s1">'nova-scheduler'</span><span class="p">,</span>
    <span class="s1">'compute_conductor_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-conductor'</span><span class="p">],</span>
    <span class="s1">'compute_conductor_service'</span> <span class="o">=&gt;</span> <span class="s1">'nova-conductor'</span><span class="p">,</span>
    <span class="c1"># Websockify is needed due to https://bugs.launchpad.net/ubuntu/+source/nova/+bug/1076442</span>
    <span class="s1">'compute_vncproxy_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'novnc'</span><span class="p">,</span> <span class="s1">'websockify'</span><span class="p">,</span> <span class="s1">'nova-novncproxy'</span><span class="p">],</span>
    <span class="s1">'compute_vncproxy_service'</span> <span class="o">=&gt;</span> <span class="s1">'nova-novncproxy'</span><span class="p">,</span>
    <span class="s1">'compute_vncproxy_consoleauth_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-consoleauth'</span><span class="p">],</span>
    <span class="s1">'compute_vncproxy_consoleauth_service'</span> <span class="o">=&gt;</span> <span class="s1">'nova-consoleauth'</span><span class="p">,</span>
    <span class="s1">'compute_serialproxy_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-serialproxy'</span><span class="p">],</span>
    <span class="s1">'compute_serialproxy_service'</span> <span class="o">=&gt;</span> <span class="s1">'nova-serialproxy'</span><span class="p">,</span>
    <span class="s1">'libvirt_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'libvirt-bin'</span><span class="p">,</span> <span class="s1">'python-guestfs'</span><span class="p">],</span>
    <span class="s1">'libvirt_service'</span> <span class="o">=&gt;</span> <span class="s1">'libvirt-bin'</span><span class="p">,</span>
    <span class="s1">'libvirt_ceph_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceph-common'</span><span class="p">],</span>
    <span class="s1">'dbus_service'</span> <span class="o">=&gt;</span> <span class="s1">'dbus'</span><span class="p">,</span>
    <span class="s1">'compute_cert_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-cert'</span><span class="p">],</span>
    <span class="s1">'compute_cert_service'</span> <span class="o">=&gt;</span> <span class="s1">'nova-cert'</span><span class="p">,</span>
    <span class="s1">'mysql_service'</span> <span class="o">=&gt;</span> <span class="s1">'mysql'</span><span class="p">,</span>
    <span class="s1">'common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'nova-common'</span><span class="p">],</span>
    <span class="s1">'iscsi_helper'</span> <span class="o">=&gt;</span> <span class="s1">'tgtadm'</span><span class="p">,</span>
    <span class="s1">'volume_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'sysfsutils'</span><span class="p">,</span> <span class="s1">'sg3-utils'</span><span class="p">,</span> <span class="s1">'multipath-tools'</span><span class="p">],</span>
    <span class="s1">'docker_build_pkgs'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'git'</span><span class="p">,</span> <span class="s1">'python-dev'</span><span class="p">,</span> <span class="s1">'gcc'</span><span class="p">],</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s2">"-o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef'"</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Array of options for <code class="highlighter-rouge">api-paste.ini</code> (e.g. [‘option1=value1’, …])</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'misc_paste'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>NOTE: The metadata api service is enabled via including it’s recipe
NOTE: api-metadata.  By default the api-metadata recipe is included in
NOTE: the os-compute-api role which is included in the
NOTE: os-compute-single-controller role.
For true case, this logic allows the following ironic-related attribtes to be overwritten automatically.
Docker configurations
Docker compute configuration is supported only in Rhel and Ubuntu
This is to be true to make a compute docker type and use nova docker driver as compute driver</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'docker'</span><span class="p">][</span><span class="s1">'enable'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># The nova docker driver that will be configured in a docker type compute</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'docker'</span><span class="p">][</span><span class="s1">'driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'novadocker.virt.docker.driver.DockerDriver'</span>
<span class="c1"># Additional python packages required for nova docker driver build and installation from git source</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'docker'</span><span class="p">][</span><span class="s1">'pip_build_pkgs'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'setuptools'</span><span class="p">,</span> <span class="s1">'pbr'</span><span class="p">]</span>
<span class="c1"># github repository from which nova-docker source will be downloaded</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'docker'</span><span class="p">][</span><span class="s1">'github'</span><span class="p">][</span><span class="s1">'repository'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'https://github.com/stackforge/nova-docker'</span>
<span class="c1"># github branch from which nova-docker source will be downloaded. Default is master</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'docker'</span><span class="p">][</span><span class="s1">'github'</span><span class="p">][</span><span class="s1">'branch'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'master'</span>
<span class="c1"># Relative path to docker filter files in nova-docker source which will be cloned from git repo</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'docker'</span><span class="p">][</span><span class="s1">'filter_source_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/nova/rootwrap.d'</span>
<span class="c1"># Path to docker service sock file</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'docker'</span><span class="p">][</span><span class="s1">'service_sock'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/run/docker.sock'</span>
<span class="c1"># Permission level to be assigned to docker service sock file</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'docker'</span><span class="p">][</span><span class="s1">'service_sock_mode'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">666</span>
<span class="c1"># Docker group which will be created and added with openstack compute user</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'docker'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'docker'</span>
</code></pre>
</div>

<p><strong>**</strong><strong>**</strong><strong>**</strong> OpenStack Compute Endpoints <strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong>
The OpenStack Compute (Nova) XVPvnc endpoint</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="sx">%w(
  compute-xvpvnc compute-novnc
  compute-metadata-api
  compute-vnc compute-api
)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">service</span><span class="o">|</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
  <span class="sx">%w(public internal admin)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">type</span><span class="o">|</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'scheme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http'</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="sx">%w(public internal admin)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">type</span><span class="o">|</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-xvpvnc'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'6081'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-xvpvnc'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/console'</span>
  <span class="c1"># The OpenStack Compute (Nova) Native API endpoint</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-api'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'8774'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-api'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/v2/%(tenant_id)s'</span>
  <span class="c1"># The OpenStack Compute (Nova) novnc endpoint</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-novnc'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'6080'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-novnc'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/vnc_auto.html'</span>
  <span class="c1"># The OpenStack Compute (Nova) metadata API endpoint</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-metadata-api'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'8775'</span>
  <span class="c1"># The OpenStack Compute (Nova) serial proxy endpoint</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-serial-proxy'</span><span class="p">][</span><span class="s1">'scheme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ws'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-serial-proxy'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'6083'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-serial-proxy'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">type</span><span class="p">][</span><span class="s1">'compute-serial-proxy'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="k">end</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'compute-serial-proxy'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'compute-vnc-proxy'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'compute-serial-console'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'compute-xvpvnc'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'6081'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'compute-vnc'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'6081'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'compute-serial-proxy'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'6081'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'compute-novnc'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'6080'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'compute-metadata-api'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'8775'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'compute-api'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'8774'</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-compute-attributes-novaconf">cookbook-openstack-compute-attributes-nova_conf</h3>

<p><a href="#contents">back to top</a></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'conf_secrets'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="c1"># [DEFAULT] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/nova'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'state_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/lib/nova'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'compute_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'libvirt.LibvirtDriver'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'auth_version'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'rpc_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'instances_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'state_path'</span><span class="p">]</span><span class="si">}</span><span class="s2">/instances"</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'enabled_apis'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'osapi_compute'</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span> <span class="c1">#= false</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_config'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack/logging.conf'</span>
  <span class="k">end</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'use_neutron'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'true'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'linuxnet_interface_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nova.network.linux_net.LinuxOVSInterfaceDriver'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'firewall_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nova.virt.firewall.NoopFirewallDriver'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'default_floating_pool'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'public'</span> <span class="c1"># not listed</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'dns_server'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'8.8.8.8'</span> <span class="c1"># [] in docs</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [keystone_authtoken]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'signing_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/nova/api'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'auth_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'region_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nova'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [libvirt]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'virt_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'kvm'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'images_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'default'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'images_type'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'lvm'</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'images_volume_group'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'sparse_logical_volumes'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="k">elsif</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'images_type'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'rbd'</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'images_rbd_pool'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'instances'</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'images_rbd_ceph_conf'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/ceph/ceph.conf'</span> <span class="c1"># nil</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'rbd_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cinder'</span> <span class="c1"># none</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'rbd_secret_uuid'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'libvirt'</span><span class="p">][</span><span class="s1">'rbd'</span><span class="p">][</span><span class="s1">'cinder'</span><span class="p">][</span><span class="s1">'secret_uuid'</span><span class="p">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="k">end</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [neutron]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'neutron'</span><span class="p">][</span><span class="s1">'auth_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'neutron'</span><span class="p">][</span><span class="s1">'region_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'neutron'</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'neutron'</span><span class="p">][</span><span class="s1">'tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'neutron'</span><span class="p">][</span><span class="s1">'service_metadata_proxy'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [cinder] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'cinder'</span><span class="p">][</span><span class="s1">'os_region_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [oslo_concurrency] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'oslo_concurrency'</span><span class="p">][</span><span class="s1">'lock_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'state_path'</span><span class="p">]</span><span class="si">}</span><span class="s2">/lock"</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-dashboard">cookbook-openstack-dashboard</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-dashboard-readme">cookbook-openstack-dashboard-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-3">Description</h1>

<p>Installs the OpenStack Dashboard service <strong>Horizon</strong> as part of the OpenStack reference deployment Chef for OpenStack. The http://github.com/mattray/chef-openstack-repo contains documentation for using this cookbook in the context of a full OpenStack deployment. Horizon is currently installed from packages.</p>

<p>http://horizon.openstack.org</p>

<h1 id="requirements-5">Requirements</h1>

<ul>
  <li>Chef 0.10.0 or higher required (for Chef environment use).</li>
</ul>

<h2 id="cookbooks-3">Cookbooks</h2>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>apache2</li>
  <li>openstack-common</li>
</ul>

<h1 id="usage-5">Usage</h1>

<h2 id="horizon">horizon</h2>

<p>Sets up the packages needed to run the Horizon dashboard and its dependencies.
Will be included from the <code class="highlighter-rouge">server</code> recipe.</p>

<h2 id="apache2-server">apache2-server</h2>

<p>Installs the Apache webserver and sets up an <code class="highlighter-rouge">mod_wsgi</code> container to run the
Horizon dashboard.  Will be included from the <code class="highlighter-rouge">server</code> recipe.</p>

<h2 id="server">server</h2>

<p>Sets up the Horizon dashboard and a webserver of type <code class="highlighter-rouge">['openstack']['dashboard']['server_type']</code>
to run it, default type is ‘apache2’.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s2">"run_list"</span><span class="err">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"recipe[openstack-dashboard::server]"</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
</div>

<h1 id="attributes-5">Attributes</h1>

<ul>
  <li><code class="highlighter-rouge">openstack['dashboard']['server_type']</code> - Selects the type of webserver to install</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['db']['username']</code> - Username for horizon database access</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['server_hostname']</code> - Sets the ServerName in the webserver config</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['allowed_hosts']</code> - List of host/domain names we can service (default: ‘[*]’)</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['dash_path']</code> - Base path for dashboard files (document root)</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['wsgi_path']</code> - Path for wsgi dir</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['wsgi_socket_prefix']</code> - Location that will override the standard Apache runtime directory</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['ssl_offload']</code> - Set SECURE_PROXY_SSL_HEADER = (‘HTTP_X_FORWARDED_PROTOCOL’, ‘https’) flag for offloading SSL</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['plugins']</code> - Array of plugins to include via INSTALED_APPS</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['simple_ip_management']</code> - Boolean to enable or disable simplified floating IP address management</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['password_autocomplete']</code> - Toggle browser autocompletion for login form (‘on’ or ‘off’, default: ‘off’)</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['ssl_no_verify']</code> - Disable SSL certificate checks (useful for self-signed certificates)</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['ssl_cacert']</code> - The CA certificate to use to verify SSL connections</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['misc_local_settings']</code> - Additions to the local_settings conf file</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['hash_algorithm']</code> - Hash algorithm to use for hashing PKI tokens</li>
</ul>

<p>For listen addresses and ports, there are http and https bind endpoints defined in Common.</p>

<h2 id="identity">Identity</h2>
<ul>
  <li><code class="highlighter-rouge">openstack['dashboard']['identity_api_version']</code> - Force a specific Identity API version (‘2.0’ or ‘3’, default: ‘2.0’)</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['volume_api_version']</code> - Force a specific Cinder API version (default: ‘2’)</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['keystone_multidomain_support']</code> - Boolean to enable multi-Domain support</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['keystone_default_domain']</code> - Default Domain if using API v3 and on a single-domain model (default: ‘Default’)</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['keystone_default_role']</code> - Default Keystone role assigned to project members (default: ‘<em>member</em>’)</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['keystone_backend']['name']</code> - Keystone backend in use (‘native’ or ‘ldap’, default: ‘native’)</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['keystone_backend']['can_edit_user']</code> - Boolean to allow some user-related identity operations (default: true)</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['keystone_backend']['can_edit_group']</code> - Boolean to allow some group-related identity operations (default: true)</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['keystone_backend']['can_edit_project']</code> - Boolean to allow some project-related identity operations (default: true)</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['keystone_backend']['can_edit_domain']</code> - Boolean to allow some domain-related identity operations (default: true)</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['keystone_backend']['can_edit_role']</code> - Boolean to allow some role-related identity operations (default: true)</li>
</ul>

<h2 id="certificate">Certificate</h2>
<ul>
  <li><code class="highlighter-rouge">openstack['dashboard']['use_ssl']</code> - Toggle for using ssl with dashboard (default: true)</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['ssl']['dir']</code> - Directory where ssl certs are stored on this system (default: platform dependent)</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['ssl']['cert']</code> - Name to use when creating the ssl certificate</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['ssl']['cert_url']</code> - If using an existing certificate, this is the URL to its location</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['ssl']['key']</code> - Name to use when creating the ssl key</li>
  <li><code class="highlighter-rouge">openstack['dashboard']['ssl']['key_url']</code> - If using an existing certificate key, this is the URL to its location</li>
</ul>

<p>By default the openstack-dashboard cookbook ships with a self-signed certificate from a fake organization.
It is possible to use a real production certificate from your organization by putting that certificate
somewhere where the cookbook can download it from then simply passing in the URL of the certificate, and its
corresponding key, using the ‘cert_url’ and ‘key_url’ attributes.</p>

<hr />

<h3 id="cookbook-openstack-dashboard-attributes-default">cookbook-openstack-dashboard-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
'</span>

<span class="o">******************</span> <span class="no">OpenStack</span> <span class="no">Dashboard</span> <span class="no">Endpoints</span> <span class="o">******************************</span>
<span class="no">The</span> <span class="no">OpenStack</span> <span class="no">Dashboard</span> <span class="n">non</span><span class="o">-</span><span class="no">SSL</span> <span class="n">endpoint</span>

<span class="sb">``` ruby
default['openstack']['bind_service']['dashboard_http']['host'] = '0.0.0.0'
default['openstack']['bind_service']['dashboard_http']['port'] = '80'
</span></code></pre>
</div>

<p>The OpenStack Dashboard SSL endpoint</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'dashboard_https'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'0.0.0.0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'dashboard_https'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'443'</span>
</code></pre>
</div>

<hr />

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'server_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'apache2'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'debug'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>Don’t cache html pages.
NOTE: This setting requires apache 2.4 or greater is used</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'cache_html'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>The Keystone role used by default for users logging into the dashboard</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_default_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'_member_'</span>
</code></pre>
</div>

<p>This is the name of the Chef role that will install the Keystone Service API</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_service_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'server_hostname'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'use_ssl'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="c1"># When using a remote certificate and key, the names of the actual installed certificate</span>
<span class="c1"># and key in the file system are determined by the following two attributes.</span>
<span class="c1"># If you want the name of the installed files to match the name of the files from the URL,</span>
<span class="c1"># they need to be manually set below, if not the conventional horizon.* names will be used.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'cert'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'horizon.pem'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'key'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'horizon.key'</span>
<span class="c1"># Which versions of the SSL/TLS protocol will be accepted in new connections.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'protocol'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'All -SSLv2 -SSLv3'</span>
<span class="c1"># Which ciphers to use with the SSL/TLS protocol.</span>
<span class="c1"># Example: 'RSA:HIGH:MEDIUM:!LOW:!kEDH:!aNULL:!ADH:!eNULL:!EXP:!SSLv2:!SEED:!CAMELLIA:!PSK!RC4:!RC4-MD5:!RC4-SHA'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'ciphers'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>List of hosts/domains the dashboard can serve. This should be changed, a ‘*’
allows everything</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'allowed_hosts'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'*'</span><span class="p">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'swift'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'False'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'theme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'default'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'apache'</span><span class="p">][</span><span class="s1">'sites-path'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'apache'</span><span class="p">][</span><span class="s1">'dir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/openstack-dashboard.conf"</span>
</code></pre>
</div>

<p>Allow TRACE method</p>

<p>Set to “extended” to also reflect the request body (only for testing and
diagnostic purposes).</p>

<table>
  <tbody>
    <tr>
      <td>Set to one of:  On</td>
      <td>Off</td>
      <td>extended</td>
    </tr>
  </tbody>
</table>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'traceenable'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'apache'</span><span class="p">][</span><span class="s1">'traceenable'</span><span class="p">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'secret_key_content'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl_no_verify'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'True'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl_cacert'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'webroot'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/'</span>
</code></pre>
</div>

<p>Dashboard specific database packages
Put common ones here and platform specific ones below.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'db_python_packages'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">mysql: </span><span class="p">[],</span>
  <span class="ss">postgresql: </span><span class="p">[],</span>
  <span class="ss">sqlite: </span><span class="p">[]</span>
<span class="p">}</span>
</code></pre>
</div>

<p>The hash algorithm to use for authentication tokens. This must match the hash
algorithm that the identity (Keystone) server and the auth_token middleware
are using. Allowed values are the algorithms supported by Python’s hashlib
library.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'hash_algorithm'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'md5'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">node</span><span class="p">[</span><span class="s1">'platform_family'</span><span class="p">]</span>
<span class="k">when</span> <span class="s1">'rhel'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'key_group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'root'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'horizon_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'apache'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'horizon_group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'apache'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'secret_key_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/usr/share/openstack-dashboard/openstack_dashboard/local/.secret_key_store'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'cert_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/pki/tls/certs/'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'key_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/pki/tls/private/'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'local_settings_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack-dashboard/local_settings'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'django_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/usr/share/openstack-dashboard'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'login_url'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'webroot'</span><span class="p">]</span><span class="si">}</span><span class="s2">auth/login/"</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'logout_url'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'webroot'</span><span class="p">]</span><span class="si">}</span><span class="s2">auth/logout/"</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'login_redirect_url'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'webroot'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'horizon_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-dashboard'</span><span class="p">],</span>
    <span class="s1">'memcache_python_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-memcached'</span><span class="p">],</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'apache'</span><span class="p">][</span><span class="s1">'sites-path'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'apache'</span><span class="p">][</span><span class="s1">'dir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/sites-available/openstack-dashboard.conf"</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'key_group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ssl-cert'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'horizon_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'horizon'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'horizon_group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'horizon'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'secret_key_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/lib/openstack-dashboard/secret_key'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'cert_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/ssl/certs/'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'key_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/ssl/private/'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'local_settings_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack-dashboard/local_settings.py'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'django_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/usr/share/openstack-dashboard'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'login_url'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'logout_url'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'login_redirect_url'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'memcache_python_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-memcache'</span><span class="p">],</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s2">"-o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef'"</span>
  <span class="p">}</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">][</span><span class="s1">'horizon_packages'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'node-less'</span><span class="p">,</span> <span class="s1">'openstack-dashboard'</span><span class="p">]</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'apache'</span><span class="p">][</span><span class="s1">'sites-path'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'apache'</span><span class="p">][</span><span class="s1">'dir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/sites-available/openstack-dashboard.conf"</span>
<span class="k">else</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'key_group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'root'</span>
<span class="k">end</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'dash_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'django_path'</span><span class="p">]</span><span class="si">}</span><span class="s2">/openstack_dashboard"</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'static_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'django_path'</span><span class="p">]</span><span class="si">}</span><span class="s2">/static"</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'stylesheet_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/usr/share/openstack-dashboard/openstack_dashboard/templates/_stylesheets.html'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'wsgi_path'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'dash_path'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">'/wsgi/django.wsgi'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'wsgi_socket_prefix'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'session_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'memcached'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'ssl_offload'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'plugins'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'file_upload_temp_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'error_log'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'openstack-dashboard-error.log'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'access_log'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'openstack-dashboard-access.log'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'help_url'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http://docs.openstack.org'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'csrf_cookie_secure'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'session_cookie_secure'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_multidomain_support'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span>
<span class="k">when</span> <span class="s1">'v2.0'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'identity_api_version'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">.</span><span class="mi">0</span>
<span class="k">when</span> <span class="s1">'v3.0'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'identity_api_version'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="k">end</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'volume_api_version'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_default_domain'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Default'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'console_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'AUTO'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_backend'</span><span class="p">][</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'native'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_backend'</span><span class="p">][</span><span class="s1">'can_edit_user'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_backend'</span><span class="p">][</span><span class="s1">'can_edit_group'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_backend'</span><span class="p">][</span><span class="s1">'can_edit_project'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_backend'</span><span class="p">][</span><span class="s1">'can_edit_domain'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'keystone_backend'</span><span class="p">][</span><span class="s1">'can_edit_role'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'horizon'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'openstack_dashboard'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'novaclient'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'cinderclient'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'keystoneclient'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'glanceclient'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'neutronclient'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'heatclient'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'ceilometerclient'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'troveclient'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'swiftclient'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'openstack_auth'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'nose.plugins.manager'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">][</span><span class="s1">'django'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'password_autocomplete'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'off'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'simple_ip_management'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'neutron'</span><span class="p">][</span><span class="s1">'enable_quotas'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'neutron'</span><span class="p">][</span><span class="s1">'enable_lb'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># Allow for misc sections to be added to the local_settings template</span>
<span class="c1"># For example: {</span>
<span class="c1">#                'CUSTOM_CONFIG_A' =&gt; {</span>
<span class="c1">#                  'variable1': 'value1',</span>
<span class="c1">#                  'variable2': 'value2'</span>
<span class="c1">#                }</span>
<span class="c1">#                'CUSTOM_CONFIG_B' =&gt; {</span>
<span class="c1">#                  'variable1': 'value1',</span>
<span class="c1">#                  'variable2': 'value2'</span>
<span class="c1">#                }</span>
<span class="c1">#              }</span>
<span class="c1"># will generate:</span>
<span class="c1">#  CUSTOM_CONFIG_A = {</span>
<span class="c1">#    'varable1': 'value1',</span>
<span class="c1">#    'varable2': 'value2',</span>
<span class="c1">#  }</span>
<span class="c1">#  CUSTOM_CONFIG_A = {</span>
<span class="c1">#    'varable1': 'value1',</span>
<span class="c1">#    'varable2': 'value2',</span>
<span class="c1">#  }</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'dashboard'</span><span class="p">][</span><span class="s1">'misc_local_settings'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-database">cookbook-openstack-database</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-database-readme">cookbook-openstack-database-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-4">Description</h1>

<p>Installs the OpenStack Database service <strong>Trove</strong> as part of the
OpenStack reference deployment Chef for OpenStack.  Trove is currently
installed from packages.</p>

<p>https://wiki.openstack.org/wiki/Trove</p>

<h1 id="requirements-6">Requirements</h1>

<p>Chef 11</p>

<h2 id="cookbooks-4">Cookbooks</h2>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>openstack-common</li>
  <li>openstack-identity</li>
</ul>

<h1 id="usage-6">Usage</h1>

<h2 id="api-1">api</h2>
<ul>
  <li>Installs the API service.</li>
</ul>

<h2 id="conductor">conductor</h2>
<ul>
  <li>Installs conductor service.</li>
</ul>

<h2 id="taskmanager">taskmanager</h2>
<ul>
  <li>Installs the taskmanager service.</li>
</ul>

<h2 id="identityregistration">identity_registration</h2>
<ul>
  <li>Registers the endpoints with Keystone.</li>
</ul>

<h1 id="attributes-6">Attributes</h1>

<hr />

<h3 id="cookbook-openstack-database-attributes-default">cookbook-openstack-database-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'verbose'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'debug'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'trove'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'trove'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform</span>
<span class="k">when</span> <span class="s1">'suse'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-trove-api'</span><span class="p">],</span>
    <span class="s1">'api_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-trove-api'</span><span class="p">,</span>
    <span class="s1">'conductor_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-trove-conductor'</span><span class="p">],</span>
    <span class="s1">'conductor_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-trove-conductor'</span><span class="p">,</span>
    <span class="s1">'taskmanager_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-trove-taskmanager'</span><span class="p">],</span>
    <span class="s1">'taskmanager_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-trove-taskmanager'</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'service_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'trove'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'service_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'service_tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'volume_support'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<p>Keystone PKI signing directory</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'cache_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/trove/api'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'nova_proxy_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'nova_proxy_password'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'nova_proxy_tenant'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-data-processing">cookbook-openstack-data-processing</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-data-processing-readme">cookbook-openstack-data-processing-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-5">Description</h1>

<p>This cookbook installs the OpenStack Data Processing service <strong>Sahara</strong> as part of an OpenStack reference deployment Chef for OpenStack.</p>

<p>https://wiki.openstack.org/wiki/Sahara</p>

<hr />

<h2 id="cookbook-openstack-identity">cookbook-openstack-identity</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-identity-readme">cookbook-openstack-identity-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-6">Description</h1>

<p>This cookbook installs the OpenStack Identity Service <strong>Keystone</strong> as part of the OpenStack reference deployment Chef for OpenStack. The https://github.com/openstack/openstack-chef-repo contains documentation for using this cookbook in the context of a full OpenStack deployment. Keystone is installed from packages, creating the default user, tenant, and roles. It also registers the identity service and identity endpoint.</p>

<p>http://keystone.openstack.org/</p>

<h1 id="requirements-7">Requirements</h1>

<p>Chef 0.10.0 or higher required (for Chef environment use)</p>

<h2 id="cookbooks-5">Cookbooks</h2>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>openstack-common</li>
</ul>

<h1 id="usage-7">Usage</h1>

<h2 id="client-3">client</h2>

<p>Installs the keystone client packages</p>

<h2 id="server-deprecated-will-be-removed-in-m-release">server (deprecated, will be removed in M release)</h2>

<p>Installs and Configures Keystone Service</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s2">"run_list"</span><span class="err">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"recipe[openstack-identity::server]"</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
</div>

<h2 id="server-apache">server-apache</h2>

<p>Installs and Configures Keystone Service under Apache</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s2">"run_list"</span><span class="err">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"recipe[openstack-identity::server-apache]"</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
</div>

<h1 id="resourcesproviders">Resources/Providers</h1>

<p>These resources provide an abstraction layer for interacting with the keystone server’s API, allowing for other nodes to register any required users, tenants, roles, services, or endpoints.</p>

<h2 id="register">register</h2>

<p>Register users, tenants, roles, services and endpoints with Keystone</p>

<h3 id="actions">Actions</h3>

<ul>
  <li>:create_tenant: Create a tenant</li>
  <li>:create_user: Create a user for a specified tenant</li>
  <li>:create_role: Create a role</li>
  <li>:grant_role: Grant a role to a specified user for a specified tenant</li>
  <li>:create_service: Create a service</li>
  <li>:create_endpoint: Create an endpoint for a sepcified service</li>
</ul>

<h3 id="general-attributes">General Attributes</h3>

<ul>
  <li>auth_protocol: Required communication protocol with Keystone server</li>
  <li>Acceptable values are [ “http”, “https” ]</li>
  <li>auth_host: Keystone server IP Address</li>
  <li>auth_port: Port Keystone server is listening on</li>
  <li>api_ver: API Version for Keystone server</li>
  <li>Accepted values are [ “/v2.0” ]</li>
  <li>auth_token: Auth Token for communication with Keystone server</li>
  <li>misc_keystone: Array of strings to be added to the keystone.conf file</li>
</ul>

<h3 id="createtenant-specific-attributes">:create_tenant Specific Attributes</h3>

<ul>
  <li>tenant_name: Name of tenant to create</li>
  <li>tenant_description: Description of tenant to create</li>
  <li>tenant_enabled: Enable or Disable tenant</li>
  <li>Accepted values are [ “true”, “false” ]</li>
  <li>Default is “true”</li>
</ul>

<h3 id="createuser-specific-attributes">:create_user Specific Attributes</h3>

<ul>
  <li>user_name: Name of user account to create</li>
  <li>user_pass: Password for the user account</li>
  <li>user_enabled: Enable or Disable user</li>
  <li>Accepted values are [ “true”, “false” ]</li>
  <li>Default is “true”</li>
  <li>tenant_name: Name of tenant to create user in</li>
</ul>

<h3 id="createrole-specific-attributes">:create_role Specific Attributes</h3>

<ul>
  <li>role_name: Name of the role to create</li>
</ul>

<h3 id="grantrole-specific-attributes">:grant_role Specific Attributes</h3>

<ul>
  <li>role_name: Name of the role to grant</li>
  <li>user_name: User name to grant the role to</li>
  <li>tenant_name: Name of tenant to grant role in</li>
</ul>

<h3 id="createservice-specific-attributes">:create_service Specific Attributes</h3>

<ul>
  <li>service_name: Name of service</li>
  <li>service_description: Description of service</li>
  <li>service_type: Type of service to create</li>
  <li>Accepted values are [ “image”, “identity”, “compute”, “storage”, “ec2”, “volume”, “object-store”, “metering”, “network”, “orchestration”, “cloudformation” ]</li>
  <li><strong>NOTE:</strong> call will be skipped if <code class="highlighter-rouge">openstack['identity']['catalog']['backend']</code> is set to ‘templated’</li>
</ul>

<h3 id="createendpoint-specific-attributes">:create_endpoint Specific Attributes</h3>

<ul>
  <li>endpoint_region: Default value is “RegionOne”</li>
  <li>endpoint_adminurl: URL to admin endpoint (using admin port)</li>
  <li>endpoint_internalurl: URL to service endpoint (using service port)</li>
  <li>endpoint_publicurl: URL to public endpoint</li>
  <li>Default is same as endpoint_internalURL</li>
  <li>service_type: Type of service to create endpoint for</li>
  <li>Accepted values are [ “image”, “identity”, “compute”, “storage”, “ec2”, “volume”, “object-store”, “metering”, “network”, “orchestration”, “cloudformation” ]</li>
  <li><strong>NOTE:</strong> call will be skipped if <code class="highlighter-rouge">openstack['identity']['catalog']['backend']</code> is set to ‘templated’</li>
</ul>

<h3 id="examples">Examples</h3>

<div class="highlighter-rouge"><pre class="highlight"><code># Create 'openstack' tenant
openstack_identity_register "Register 'openstack' Tenant" do
  auth_host "192.168.1.10"
  auth_port "35357"
  auth_protocol "http"
  api_ver "/v2.0"
  auth_token "123456789876"
  tenant_name "openstack"
  tenant_description "Default Tenant"
  tenant_enabled "true" # Not required as this is the default
  action :create_tenant
end

# Create 'admin' user
openstack_identity_register "Register 'admin' User" do
  auth_host "192.168.1.10"
  auth_port "35357"
  auth_protocol "http"
  api_ver "/v2.0"
  auth_token "123456789876"
  tenant_name "openstack"
  user_name "admin"
  user_pass "secrete"
  user_enabled "true" # Not required as this is the default
  action :create_user
end

# Create 'admin' role
openstack_identity_register "Register 'admin' Role" do
  auth_host "192.168.1.10"
  auth_port "35357"
  auth_protocol "http"
  api_ver "/v2.0"
  auth_token "123456789876"
  role_name role_key
  action :create_role
end


# Grant 'admin' role to 'admin' user in the 'openstack' tenant
openstack_identity_register "Grant 'admin' Role to 'admin' User" do
  auth_host "192.168.1.10"
  auth_port "35357"
  auth_protocol "http"
  api_ver "/v2.0"
  auth_token "123456789876"
  tenant_name "openstack"
  user_name "admin"
  role_name "admin"
  action :grant_role
end

# Create 'identity' service
openstack_identity_register "Register Identity Service" do
  auth_host "192.168.1.10"
  auth_port "35357"
  auth_protocol "http"
  api_ver "/v2.0"
  auth_token "123456789876"
  service_name "keystone"
  service_type "identity"
  service_description "Keystone Identity Service"
  action :create_service
end

# Create 'identity' endpoint
openstack_identity_register "Register Identity Endpoint" do
  auth_host "192.168.1.10"
  auth_port "35357"
  auth_protocol "http"
  api_ver "/v2.0"
  auth_token "123456789876"
  service_type "identity"
  endpoint_region "RegionOne"
  endpoint_adminurl "http://192.168.1.10:35357/v2.0"
  endpoint_internalurl "http://192.168.1.10:5001/v2.0"
  endpoint_publicurl "http://1.2.3.4:5001/v2.0"
  action :create_endpoint
end
</code></pre>
</div>

<h2 id="credentials">credentials</h2>

<p>Create EC2 credentials for a given user in the specified tenant</p>

<h3 id="actions-1">Actions</h3>

<ul>
  <li>:create_ec2: create EC2 credentials</li>
</ul>

<h3 id="general-attributes-1">General Attributes</h3>

<ul>
  <li>auth_protocol: Required communication protocol with Keystone server. Acceptable values are [ “http”, “https” ]</li>
  <li>auth_host: Keystone server IP Address</li>
  <li>auth_port: Port Keystone server is listening on</li>
  <li>api_ver: API Version for Keystone server</li>
  <li>Accepted values are [ “/v2.0” ]</li>
  <li>auth_token: Auth Token for communication with Keystone server</li>
</ul>

<h3 id="createec2-specific-attributes">:create_ec2 Specific Attributes</h3>

<ul>
  <li>user_name: User name to grant the credentials for</li>
  <li>tenant_name: Tenant name to grant the credentials in</li>
</ul>

<h3 id="examples-1">Examples</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>openstack_identity_credentials "Create EC2 credentials for 'admin' user" do
  auth_host "192.168.1.10"
  auth_port "35357"
  auth_protocol "http"
  api_ver "/v2.0"
  auth_token "123456789876"
  user_name "admin"
  tenant_name "openstack"
end
</code></pre>
</div>

<h1 id="attributes-7">Attributes</h1>

<p><strong>TODO</strong>: Clean up after refactoring.
Please refer to the Common cookbook for more attributes.</p>

<ul>
  <li><code class="highlighter-rouge">openstack['identity']['db_server_chef_role']</code> - The name of the Chef role that knows about the db server</li>
  <li><code class="highlighter-rouge">openstack['identity']['user']</code> - User keystone runs as</li>
  <li><code class="highlighter-rouge">openstack['identity']['group']</code> - Group keystone runs as</li>
  <li><code class="highlighter-rouge">openstack['identity']['db']</code> - Name of keystone database</li>
  <li><code class="highlighter-rouge">openstack['identity']['db_user']</code> - Username for keystone database access</li>
  <li><code class="highlighter-rouge">openstack['identity']['db_passwd']</code> - Password for keystone database access</li>
  <li><code class="highlighter-rouge">openstack['identity']['db_ipaddress']</code> - IP address of the keystone database</li>
  <li><code class="highlighter-rouge">openstack['identity']['api_ipaddress']</code> - IP address for the keystone API to bind to. <em>TODO</em>: Rename to bind_address</li>
  <li><code class="highlighter-rouge">openstack['identity']['admin_token']</code> - Admin token for bootstraping keystone server</li>
  <li><code class="highlighter-rouge">openstack['identity']['admin_workers']</code> - The number of worker processes to serve the admin WSGI application</li>
  <li><code class="highlighter-rouge">openstack['identity']['public_workers']</code> - The number of worker processes to serve the public WSGI application</li>
  <li><code class="highlighter-rouge">openstack['identity']['roles']</code> - Array of roles to create in the keystone server</li>
  <li><code class="highlighter-rouge">openstack['identity']['users']</code> - Array of users to create in the keystone server</li>
  <li><code class="highlighter-rouge">openstack['identity']['pastefile_url']</code> - Specify the URL for a keystone-paste.ini file that will override the default packaged file</li>
  <li><code class="highlighter-rouge">openstack['identity']['token']['expiration']</code> - Token validity time in seconds</li>
  <li><code class="highlighter-rouge">openstack['identity']['token']['hash_algorithm']</code> - Hash algorithms to use for hashing PKI tokens</li>
  <li><code class="highlighter-rouge">openstack['identity']['catalog']['backend']</code> - Storage mechanism for the keystone service catalog</li>
  <li><code class="highlighter-rouge">openstack['identity']["control_exchange"]</code> - The AMQP exchange to connect to if using RabbitMQ or Qpid, defaults to openstack</li>
  <li><code class="highlighter-rouge">openstack['identity']['rpc_backend']</code> - The messaging module to use</li>
  <li><code class="highlighter-rouge">openstack['identity']['rpc_thread_pool_size']</code> - Size of RPC thread pool</li>
  <li><code class="highlighter-rouge">openstack['identity']['rpc_conn_pool_size']</code> - Size of RPC connection pool</li>
  <li><code class="highlighter-rouge">openstack['identity']['rpc_response_timeout']</code> - Seconds to wait for a response from call or multicall</li>
  <li><code class="highlighter-rouge">openstack['identity']['ldap']['url']</code> - LDAP host URL (default: ‘ldap://localhost’)</li>
  <li><code class="highlighter-rouge">openstack['identity']['ldap']['user']</code> - LDAP bind DN (default: ‘dc=Manager,dc=example,dc=com’)</li>
  <li><code class="highlighter-rouge">openstack['identity']['ldap']['password']</code> - LDAP bind password (default: nil)</li>
  <li><code class="highlighter-rouge">openstack['identity']['ldap']['use_tls']</code> - Use TLS for LDAP (default: false)</li>
  <li><code class="highlighter-rouge">openstack['identity']['ldap']['tls_cacertfile']</code> - Path to CA cert file (default: nil)</li>
  <li><code class="highlighter-rouge">openstack['identity']['ldap']['tls_cacertdir']</code> - Path to CA cert directory (default: nil)</li>
  <li><code class="highlighter-rouge">openstack['identity']['ldap']['tls_req_cert']</code> - CA cert check (‘demand’, ‘allow’ or ‘never’, default: ‘demand’)</li>
  <li><code class="highlighter-rouge">openstack['identity']['ldap']['use_pool']</code> - Enable LDAP connection pool</li>
  <li><code class="highlighter-rouge">openstack['identity']['ldap']['pool_size']</code> - Connection pool size</li>
  <li><code class="highlighter-rouge">openstack['identity']['ldap']['pool_retry_max']</code> - Maximum count of reconnect trials</li>
  <li><code class="highlighter-rouge">openstack['identity']['ldap']['pool_retry_delay']</code> - Time span in seconds to wait between two reconnect trials (floating point value)</li>
  <li><code class="highlighter-rouge">openstack['identity']['ldap']['pool_connection_timeout']</code> - Connector timeout in seconds. Value -1 indicates indefinite</li>
  <li><code class="highlighter-rouge">openstack['identity']['ldap']['pool_connection_lifetime']</code> - Connection lifetime in seconds.(integer value)</li>
  <li><code class="highlighter-rouge">openstack['identity']['ldap']['use_auth_pool']</code> - Enable LDAP connection pooling for end user authentication</li>
  <li><code class="highlighter-rouge">openstack['identity']['ldap']['auth_pool_size']</code> - End user auth connection pool size. (integer value)</li>
  <li>
    <p><code class="highlighter-rouge">openstack['identity']['ldap']['auth_pool_connection_lifetime']</code> -  End user auth connection lifetime in seconds. (integervalue)</p>
  </li>
  <li><code class="highlighter-rouge">openstack['identity']['misc_keystone']</code> - <strong>Array of strings to be added to keystone.conf</strong></li>
  <li><code class="highlighter-rouge">openstack['identity']['list_limit']</code> - Maximum number of entities that will be returned in a collection</li>
  <li><code class="highlighter-rouge">openstack['identity']['assignment']['list_limit']</code> - Maximum number of entities that will be returned in a assignment collection</li>
  <li><code class="highlighter-rouge">openstack['identity']['catalog']['list_limit']</code> - Maximum number of entities that will be returned in a catalog collection</li>
  <li><code class="highlighter-rouge">openstack['identity']['identity']['list_limit']</code> - Maximum number of entities that will be returned in a identity collection</li>
  <li><code class="highlighter-rouge">openstack['identity']['policy']['list_limit']</code> - Maximum number of entities that will be returned in a policy collection</li>
  <li><code class="highlighter-rouge">openstack['identity']['pipeline']['public_api']</code> - Pipeline of identity public api</li>
  <li><code class="highlighter-rouge">openstack['identity']['pipeline']['admin_api']</code> - Pipeline of identity admin api</li>
  <li><code class="highlighter-rouge">openstack['identity']['pipeline']['api_v3']</code> - Pipeline of identity V3 api</li>
  <li><code class="highlighter-rouge">openstack['identity']['ssl']['enabled']</code> - Enable HTTPS Keystone API endpoint. Default is false</li>
  <li><code class="highlighter-rouge">openstack['identity']['ssl']['cert_required']</code> - When SSL is enabled this flag is used to require client certificate. Default is false.</li>
  <li><code class="highlighter-rouge">openstack['identity']['ssl']['basedir']</code> - Path to Keystone SSL directory</li>
  <li><code class="highlighter-rouge">openstack['identity']['ssl']['certfile']</code>- Cert file location</li>
  <li><code class="highlighter-rouge">openstack['identity']['ssl']['keyfile']</code> - Key file location</li>
  <li><code class="highlighter-rouge">openstack['identity']['ssl']['ca_certs']</code> - Path to CA certificate file</li>
</ul>

<p>Most <code class="highlighter-rouge">openstack['identity']['ldap']</code> attributes map directly to the corresponding config options in keystone.conf’s <code class="highlighter-rouge">[ldap]</code> backend.  They are primarily used when configuring <code class="highlighter-rouge">openstack['identity']['identity']['backend']</code> and/or <code class="highlighter-rouge">openstack["identity"]["assignment"]["backend"]</code> as <code class="highlighter-rouge">ldap</code> (both default to <code class="highlighter-rouge">sql</code>).</p>

<p>The <code class="highlighter-rouge">openstack['identity']['ldap']['use_tls']</code> option should not be used in conjunction with an <code class="highlighter-rouge">ldaps://</code> url.  When the latter is used (and <code class="highlighter-rouge">openstack['identity']['ldap']['use_tls'] = false</code>), the certificate path and validation will instead be subject to the OS’s LDAP config.</p>

<p>If <code class="highlighter-rouge">openstack['identity']['ldap']['tls_cacertfile']</code> is set, <code class="highlighter-rouge">openstack['identity']['ldap']['tls_cacertdir']</code> will be ignored.  Set <code class="highlighter-rouge">openstack['identity']['ldap']['tls_cacertfile']</code> to <code class="highlighter-rouge">nil</code> if <code class="highlighter-rouge">openstack['identity']['ldap']['tls_cacertdir']</code> is desired.
Values of <code class="highlighter-rouge">openstack['identity']['ldap']['tls_req_cert']</code> correspond to the standard options permitted by the TLS_REQCERT TLS option (<code class="highlighter-rouge">never</code> performs no validation of certs, <code class="highlighter-rouge">allow</code> performs some basic name checks but no thorough CA validation, <code class="highlighter-rouge">demand</code> requires the certificate chain to be valid for the connection to succeed).</p>

<p>The following attributes are defined in attributes/default.rb of the common cookbook, but are documented here due to their relevance:</p>

<ul>
  <li><code class="highlighter-rouge">openstack['endpoints']['identity-bind']['host']</code> - The IP address to bind the identity services to</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['identity-bind']['scheme']</code> - Unused</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['identity-bind']['port']</code> - Unused</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['identity-bind']['path']</code> - Unused</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['identity-bind']['bind_interface']</code> - The interface name to bind the identity services to</li>
</ul>

<p>If the value of the ‘bind_interface’ attribute is non-nil, then the identity service will be bound to the first IP address on that interface.  If the value of the ‘bind_interface’ attribute is nil, then the identity service will be bound to the IP address specified in the host attribute.</p>

<h3 id="ssl-enabling">SSL enabling</h3>
<p>To enable SSL on Keystone, a key and certficate must be created and installed on server running Keystone. The location of these files can be provided with the node attributes described above. Also, note that <code class="highlighter-rouge">openstack['endpoints']['identity-bind']['scheme']</code>, from openstack common cookbook, must be set to ‘https’ in order to enable SSL.</p>

<h3 id="token-flushing">Token flushing</h3>
<p>When managing tokens with an SQL backend the token database may grow unboundedly as new tokens are issued and expired
tokens are not disposed of. Expired tokens may need to be kept around in order to allow for auditability.</p>

<p>It is up to deployers to define when their tokens can be safely deleted. Keystone provides a tool to purge expired tokens,
and the server recipe can create a cronjob to run that tool. By default the cronjob will be configured to run hourly.</p>

<p>The flush tokens cronjob configuration parameters are listed below:</p>

<ul>
  <li><code class="highlighter-rouge">openstack['identity']['token_flush_cron']['enabled']</code> - Boolean indicating whether the flush tokens cronjob is enabled. It is by default enabled if the token backend is ‘sql’.</li>
  <li><code class="highlighter-rouge">openstack['identity']['token_flush_cron']['log_file']</code> - The log file for the flush tokens tool.</li>
  <li><code class="highlighter-rouge">openstack['identity']['token_flush_cron']['hour']</code> - The hour at which the flush tokens cronjob should run (values 0 - 23).</li>
  <li><code class="highlighter-rouge">openstack['identity']['token_flush_cron']['minute']</code> - The minute at which the flush tokens cronjob should run (values 0 - 59).</li>
  <li><code class="highlighter-rouge">openstack']['identity']['token_flush_cron']['day']</code> - The day of the month when the flush tokens cronjob should run (values 1 - 31).</li>
  <li><code class="highlighter-rouge">openstack['identity']['token_flush_cron']['weekday']</code> = The day of the week at which the flush tokens cronjob should run (values 0 - 6, where Sunday is 0).</li>
</ul>

<hr />

<h3 id="cookbook-openstack-identity-attributes-default">cookbook-openstack-identity-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
"</span>
</code></pre>
</div>

<p>Set the endpoints for the identity service to allow all other cookbooks to
access and use them</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="sx">%w(public internal admin)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">ep_type</span><span class="o">|</span>
  <span class="c1"># openstack identity service endpoints (used by users and services)</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'scheme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/v2.0'</span>
<span class="k">end</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'public'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'internal'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="s1">'admin'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">35357</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'main'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'main'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'admin'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'admin'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">35357</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'catalog'</span><span class="p">][</span><span class="s1">'backend'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'sql'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'token'</span><span class="p">][</span><span class="s1">'backend'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'sql'</span>
<span class="c1"># Adding these as blank</span>
<span class="c1"># this needs to be here for the initial deep-merge to work</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'credentials'</span><span class="p">][</span><span class="s1">'EC2'</span><span class="p">][</span><span class="s1">'admin'</span><span class="p">][</span><span class="s1">'access'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">''</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'credentials'</span><span class="p">][</span><span class="s1">'EC2'</span><span class="p">][</span><span class="s1">'admin'</span><span class="p">][</span><span class="s1">'secret'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">''</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'verbose'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'False'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'debug'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'False'</span>
</code></pre>
</div>

<p>Keystone service startup delay, in seconds</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'start_delay'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
</code></pre>
</div>

<p>Specify a location to retrieve keystone-paste.ini from
which can either be a remote url using http:// or a
local path to a file using file:// which would generally
be a distribution file - if this option is left nil then
the templated version distributed with this cookbook
will be used (keystone-paste.ini.erb)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'pastefile_url'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>This specify the pipeline of the keystone public API,
all Identity public API requests will be processed by the order of the pipeline.
this value will be used in the templated version of keystone-paste.ini
The last item in this pipeline must be public_service or an equivalent
application. It cannot be a filter.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'pipeline'</span><span class="p">][</span><span class="s1">'public_api'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'sizelimit url_normalize request_id build_auth_context token_auth admin_token_auth json_body ec2_extension user_crud_extension public_service'</span>
<span class="c1"># This specify the pipeline of the keystone admin API,</span>
<span class="c1"># all Identity admin API requests will be processed by the order of the pipeline.</span>
<span class="c1"># this value will be used in the templated version of keystone-paste.ini</span>
<span class="c1"># The last item in this pipeline must be admin_service or an equivalent</span>
<span class="c1"># application. It cannot be a filter.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'pipeline'</span><span class="p">][</span><span class="s1">'admin_api'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'sizelimit url_normalize request_id build_auth_context token_auth admin_token_auth json_body ec2_extension s3_extension crud_extension admin_service'</span>
<span class="c1"># This specify the pipeline of the keystone V3 API,</span>
<span class="c1"># all Identity V3 API requests will be processed by the order of the pipeline.</span>
<span class="c1"># this value will be used in the templated version of keystone-paste.ini</span>
<span class="c1"># The last item in this pipeline must be service_v3 or an equivalent</span>
<span class="c1"># application. It cannot be a filter.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'pipeline'</span><span class="p">][</span><span class="s1">'api_v3'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'sizelimit url_normalize request_id build_auth_context token_auth admin_token_auth json_body ec2_extension_v3 s3_extension simple_cert_extension revoke_extension federation_extension oauth1_extension endpoint_filter_extension service_v3'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
</code></pre>
</div>

<p>Logging stuff</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'LOG_LOCAL2'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'config_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'local2'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'admin_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'admin_tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'users'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'admin_user'</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'default_tenant'</span> <span class="o">=&gt;</span> <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'admin_tenant_name'</span><span class="p">],</span>
    <span class="s1">'roles'</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="s1">'admin'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'admin'</span><span class="p">],</span>
      <span class="s1">'service'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'admin'</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>SSL Options
Specify whether to enable SSL for Keystone API endpoint</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># Specify server whether to enforce client certificate requirement</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'cert_required'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># SSL certificate, keyfile and CA certficate file locations</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/keystone/ssl'</span>
<span class="c1"># Path of the cert file for SSL.</span>
<span class="c1"># Protocol for SSL (Apache)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'protocol'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'All -SSLv2 -SSLv3'</span>
<span class="c1"># Which ciphers to use with the SSL/TLS protocol (Apache)</span>
<span class="c1"># Example: 'RSA:HIGH:MEDIUM:!LOW:!kEDH:!aNULL:!ADH:!eNULL:!EXP:!SSLv2:!SEED:!CAMELLIA:!PSK!RC4:!RC4-MD5:!RC4-SHA'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'ciphers'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>PKI signing. Corresponds to the [signing] section of keystone.conf
Note this section is only written if node[‘openstack’][‘auth’][‘strategy’] == ‘pki’</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'signing'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/keystone/ssl'</span>
</code></pre>
</div>

<p>Fernet keys. Note this section is only written if
node[‘openstack’][‘auth’][‘strategy’] == ‘fernet’
Fernet keys to read from databags/vaults. This should be changed in the
environment when rotating keys (with the defaults below, the items
‘fernet_key0’ and ‘fernet_key1’ will be read from the databag/vault
‘keystone).
For more information please read:
http://docs.openstack.org/admin-guide-cloud/keystone_fernet_token_faq.html</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'fernet'</span><span class="p">][</span><span class="s1">'keys'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</code></pre>
</div>

<p>The authorization configuration options
The external (REMOTE_USER) auth plugin module. (String value)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'external'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone.auth.plugins.external.DefaultDomain'</span>
<span class="c1"># Default auth methods. (List value)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'methods'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'external, password, token, oauth1'</span>
</code></pre>
</div>

<p>Token flushing cronjob</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'token_flush_cron'</span><span class="p">][</span><span class="s1">'log_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/keystone/token-flush.log'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'token_flush_cron'</span><span class="p">][</span><span class="s1">'hour'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'*'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'token_flush_cron'</span><span class="p">][</span><span class="s1">'minute'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'token_flush_cron'</span><span class="p">][</span><span class="s1">'day'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'*'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'token_flush_cron'</span><span class="p">][</span><span class="s1">'weekday'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'*'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'token_flush_cron'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'domain_config_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/keystone/domains'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'signing'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/keystone/ssl'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'signing'</span><span class="p">][</span><span class="s1">'certfile'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'signing'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/certs/signing_cert.pem"</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'signing'</span><span class="p">][</span><span class="s1">'keyfile'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'signing'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/private/signing_key.pem"</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'signing'</span><span class="p">][</span><span class="s1">'ca_certs'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'signing'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/certs/ca.pem"</span>
<span class="c1"># Misc option support</span>
<span class="c1"># Allow additional strings to be added to keystone.conf</span>
<span class="c1"># For example:  ['# Comment', 'key=value']</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'misc_keystone'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre>
</div>

<p>SSL Options
Specify whether to enable SSL for Keystone API endpoint</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># Specify server whether to enforce client certificate requirement</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'cert_required'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># SSL certificate, keyfile and CA certficate file locations</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/keystone/ssl'</span>
<span class="c1"># Path of the cert file for SSL.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'certfile'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/certs/sslcert.pem"</span>
<span class="c1"># Path of the keyfile for SSL.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'keyfile'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/private/sslkey.pem"</span>
<span class="c1"># Path of the CA cert file for SSL.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'ca_certs'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/certs/sslca.pem"</span>
<span class="c1"># Path of the CA cert files for SSL (Apache)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'ca_certs_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span><span class="si">}</span><span class="s2">/certs/"</span>
<span class="c1"># Protocol for SSL (Apache)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'protocol'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'All -SSLv2 -SSLv3'</span>
<span class="c1"># Which ciphers to use with the SSL/TLS protocol (Apache)</span>
<span class="c1"># Example: 'RSA:HIGH:MEDIUM:!LOW:!kEDH:!aNULL:!ADH:!eNULL:!EXP:!SSLv2:!SEED:!CAMELLIA:!PSK!RC4:!RC4-MD5:!RC4-SHA'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'ciphers'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>platform defaults</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform_family</span>
<span class="k">when</span> <span class="s1">'fedora'</span><span class="p">,</span> <span class="s1">'rhel'</span> <span class="c1"># :pragma-foodcritic: ~FC024 - won't fix this</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'memcache_python_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-memcached'</span><span class="p">],</span>
    <span class="s1">'keystone_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-keystone'</span><span class="p">],</span>
    <span class="s1">'keystone_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-keystoneclient'</span><span class="p">],</span>
    <span class="s1">'keystone_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-keystone'</span><span class="p">,</span>
    <span class="s1">'keystone_process_name'</span> <span class="o">=&gt;</span> <span class="s1">'keystone-all'</span><span class="p">,</span>
    <span class="s1">'keystone_wsgi_file'</span> <span class="o">=&gt;</span> <span class="s1">'/usr/share/keystone/keystone.wsgi'</span><span class="p">,</span>
    <span class="s1">'package_options'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'memcache_python_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-memcache'</span><span class="p">],</span>
    <span class="s1">'keystone_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'keystone'</span><span class="p">],</span>
    <span class="s1">'keystone_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-keystoneclient'</span><span class="p">],</span>
    <span class="s1">'keystone_service'</span> <span class="o">=&gt;</span> <span class="s1">'keystone'</span><span class="p">,</span>
    <span class="s1">'keystone_process_name'</span> <span class="o">=&gt;</span> <span class="s1">'keystone-all'</span><span class="p">,</span>
    <span class="s1">'keystone_wsgi_file'</span> <span class="o">=&gt;</span> <span class="s1">'/usr/share/keystone/wsgi.py'</span><span class="p">,</span>
    <span class="s1">'package_options'</span> <span class="o">=&gt;</span> <span class="s2">"-o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef'"</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Array of bare options for openrc (e.g. ‘option=value’)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'misc_openrc'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>openrc location and owner</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'openrc'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/root'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'openrc'</span><span class="p">][</span><span class="s1">'file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'openrc'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'openrc'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'root'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'openrc'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'root'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'openrc'</span><span class="p">][</span><span class="s1">'file_mode'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'0600'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'openrc'</span><span class="p">][</span><span class="s1">'path_mode'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'0700'</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-identity-attributes-keystoneconf">cookbook-openstack-identity-attributes-keystone_conf</h3>

<p><a href="#contents">back to top</a></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'conf_secrets'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="c1"># [DEFAULT]</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_config_append'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack/logging.conf'</span>
  <span class="k">else</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/keystone'</span>
  <span class="k">end</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'notification_driver'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'messaging'</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'notification_topics'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'notifications'</span>
  <span class="k">end</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'rpc_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [assignment]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'assignment'</span><span class="p">][</span><span class="s1">'driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone.assignment.backends.sql.Assignment'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [auth]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'external'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone.auth.plugins.external.DefaultDomain'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'methods'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'external, password, token, oauth1'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [catalog]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'catalog'</span><span class="p">][</span><span class="s1">'driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone.catalog.backends.sql.Catalog'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [identity]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'identity'</span><span class="p">][</span><span class="s1">'domain_specific_drivers_enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [policy]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'policy'</span><span class="p">][</span><span class="s1">'driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone.policy.backends.sql.Policy'</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-image">cookbook-openstack-image</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-image-readme">cookbook-openstack-image-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-7">Description</h1>

<p>This cookbook installs the OpenStack Image service <strong>Glance</strong> as part of an OpenStack reference deployment Chef for OpenStack. The http://github.com/mattray/chef-openstack-repo contains documentation for using this cookbook in the context of a full OpenStack deployment. Glance is installed from packages, optionally populating the repository with default images.</p>

<p>http://glance.openstack.org/</p>

<h1 id="requirements-8">Requirements</h1>

<p>Chef 0.10.0 or higher required (for Chef environment use).</p>

<h2 id="cookbooks-6">Cookbooks</h2>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>openstack-common</li>
  <li>openstack-identity</li>
</ul>

<h1 id="usage-8">Usage</h1>

<h2 id="api-2">api</h2>
<ul>
  <li>Installs the glance-api server</li>
</ul>

<h2 id="client-4">client</h2>
<ul>
  <li>Install the glance client packages</li>
</ul>

<h2 id="registry">registry</h2>
<ul>
  <li>Installs the glance-registry server</li>
</ul>

<h2 id="keystone-registration">keystone-registration</h2>
<ul>
  <li>Registers the API endpoint and glance service Keystone user</li>
</ul>

<h2 id="image-upload">image-upload</h2>
<ul>
  <li>Upload image to glance. If you want to upload image during openstack installation, you need to add this recipe or the os-image role to the run list in a certain role and ensure before this recipe or the os-image role glance api and glance registry recipes have been executed.</li>
</ul>

<p>The Glance cookbook currently supports file, swift, and Rackspace Cloud Files (swift API compliant) backing stores.  NOTE: changing the storage location from cloudfiles to swift (and vice versa) requires that you manually export and import your stored images.</p>

<p>To enable these features set the following in the default attributes section in your environment:</p>

<h2 id="files">Files</h2>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s2">"openstack"</span><span class="err">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"api"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"default_store"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"upload_images"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"cirros"</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h2 id="swift">Swift</h2>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s2">"openstack"</span><span class="err">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"api"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"default_store"</span><span class="p">:</span><span class="w"> </span><span class="s2">"swift"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"upload_images"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"cirros"</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h1 id="providers">Providers</h1>

<h2 id="image">image</h2>

<p>Action: <code class="highlighter-rouge">:upload</code></p>

<ul>
  <li><code class="highlighter-rouge">:image_url</code>: Location of the image to be loaded into Glance.</li>
  <li><code class="highlighter-rouge">:image_name</code>: A name for the image.</li>
  <li><code class="highlighter-rouge">:image_type</code>: <code class="highlighter-rouge">unknown</code>, <code class="highlighter-rouge">qcow</code>, <code class="highlighter-rouge">ami</code>, <code class="highlighter-rouge">vhd</code>, <code class="highlighter-rouge">vmdk</code>, <code class="highlighter-rouge">vdi</code>, <code class="highlighter-rouge">iso</code>, <code class="highlighter-rouge">raw</code>. Defaults of <code class="highlighter-rouge">unknown</code> will use file extension ‘.gz’, ‘.tgz’ = ami, ‘.qcow2’, ‘.img’ = qcow.</li>
  <li><code class="highlighter-rouge">:identity_user</code>: Username of the Keystone admin user.</li>
  <li><code class="highlighter-rouge">:identity_pass</code>: Password for the Keystone admin user.</li>
  <li><code class="highlighter-rouge">:identity_tenant</code>: Name of the Keystone admin user’s tenant.</li>
  <li><code class="highlighter-rouge">:identity_uri</code>: URI of the Identity API endpoint.</li>
</ul>

<p>For testing this provider with ChefSpec, a custom matcher was added to <code class="highlighter-rouge">libraries/matchers.rb</code>.</p>

<h1 id="attributes-8">Attributes</h1>

<p>Attributes for the Image service are in the [‘openstack’][‘image’] namespace.</p>

<ul>
  <li><code class="highlighter-rouge">openstack['image']['verbose']</code> - Enables/disables verbose output for glance services.</li>
  <li><code class="highlighter-rouge">openstack['image']['debug']</code> - Enables/disables debug output for glance services.</li>
  <li><code class="highlighter-rouge">openstack['image']['identity_service_chef_role']</code> - The name of the Chef role that installs the Keystone Service API</li>
  <li>`openstack[‘image’][‘user’] - User glance runs as</li>
  <li>`openstack[‘image’][‘group’] - Group glance runs as</li>
  <li><code class="highlighter-rouge">openstack['image']['db']['username']</code> - Username for glance database access</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['adminURL']</code> - Used when registering image endpoint with keystone</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['internalURL']</code> - Used when registering image endpoint with keystone</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['publicURL']</code> - Used when registering image endpoint with keystone</li>
  <li><code class="highlighter-rouge">openstack['image']['service_tenant_name']</code> - Tenant name used by glance when interacting with keystone - used in the API and registry paste.ini files</li>
  <li><code class="highlighter-rouge">openstack['image']['service_user']</code> - User name used by glance when interacting with keystone - used in the API and registry paste.ini files</li>
  <li><code class="highlighter-rouge">openstack['image']['service_role']</code> - User role used by glance when interacting with keystone - used in the API and registry paste.ini files</li>
  <li><code class="highlighter-rouge">openstack['image']['notification_driver']</code> - Notification driver, default noop.</li>
  <li><code class="highlighter-rouge">openstack['image']['filesystem_store_metadata_file']</code> - A path to a JSON file that contains metadata describing the storage system.</li>
  <li><code class="highlighter-rouge">openstack['image']['filesystem_store_metadata_id']</code> - The unique id for the filesystem store the images.</li>
  <li><code class="highlighter-rouge">openstack['image']['filesystem_store_metadata_mountpoint']</code> - The mount point for the filesystem store the images;</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['workers']</code> - Set the number of glance api workers.</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['show_image_direct_url']</code> - Allow glance to return URL referencing where data is stored on the backend. Default ‘False’</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['container_formats']</code> - Supported container formats for glance.</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['disk_formats']</code> - Supported disk formats for glance.</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['auth']['cache_dir']</code> - Defaults to <code class="highlighter-rouge">/var/cache/glance/api</code>. Directory where <code class="highlighter-rouge">auth_token</code> middleware writes certificates for glance-api</li>
  <li><code class="highlighter-rouge">openstack['image']['registry']['auth']['cache_dir']</code> - Defaults to <code class="highlighter-rouge">/var/cache/glance/registry</code>. Directory where <code class="highlighter-rouge">auth_token</code> middleware writes certificates for glance-registry</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['auth']['memcached_servers']</code> - A list of memcached server(s) to use for caching</li>
  <li><code class="highlighter-rouge">openstack['image']['registry']['auth']['memcached_servers']</code> - A list of memcached server(s) to use for caching</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['auth']['memcache_security_strategy']</code> - Whether token data should be authenticated or authenticated and encrypted. Acceptable values are MAC or ENCRYPT</li>
  <li><code class="highlighter-rouge">openstack['image']['registry']['auth']['memcache_security_strategy']</code> - Whether token data should be authenticated or authenticated and encrypted. Acceptable values are MAC or ENCRYPT</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['auth']['memcache_secret_key']</code> - This string is used for key derivation</li>
  <li><code class="highlighter-rouge">openstack['image']['registry']['auth']['memcache_secret_key']</code> - This string is used for key derivation</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['auth']['hash_algorithms']</code> - Hash algorithms to use for hashing PKI tokens</li>
  <li><code class="highlighter-rouge">openstack['image']['registry']['auth']['hash_algorithms']</code> - Hash algorithms to use for hashing PKI tokens</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['auth']['cafile']</code> - A PEM encoded Certificate Authority to use when verifying HTTPs connections.</li>
  <li><code class="highlighter-rouge">openstack['image']['registry']['auth']['cafile']</code> - A PEM encoded Certificate Authority to use when verifying HTTPs connections</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['auth']['insecure']</code> - Set whether to verify HTTPS connections</li>
  <li><code class="highlighter-rouge">openstack['image']['registry']['auth']['insecure']</code> - Set whether to verify HTTPS connections</li>
  <li><code class="highlighter-rouge">openstack['image']['upload_images']</code> - Default list of images to upload to the glance repository as part of the install</li>
  <li><code class="highlighter-rouge">openstack['image']['upload_image']['&lt;imagename&gt;']</code> - URL location of the <code class="highlighter-rouge">&lt;imagename&gt;</code> image. There can be multiple instances of this line to define multiple imagess (eg natty, maverick, fedora17 etc)
— example <code class="highlighter-rouge">openstack['image']['upload_image']['natty']</code> - “http://c250663.r63.cf1.rackcdn.com/ubuntu-11.04-server-uec-amd64-multinic.tar.gz”</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['default_store']</code> - Toggles the backend storage type.  Currently supported is “file”, “swift” and “rbd”.</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['stores']</code> - List of which store classes and store class locations are currently known to glance at startup</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['block-storage']['cinder_catalog_info']</code> - Info to match when looking for cinder in the service catalog</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['block-storage']['cinder_api_insecure']</code> - Allow to perform insecure SSL requests to cinder (boolean value)</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['block-storage']['cinder_ca_certificates_file']</code> - Location of ca certicates file to use for cinder client requests</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['swift']['store_container']</code> - Set the container used by glance to store images and snapshots.  Defaults to “glance”</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['swift']['store_large_object_size']</code> - Set the size at which glance starts to chunnk files.  Defaults to “200” MB</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['swift']['store_large_object_chunk_size']</code> - Set the chunk size for glance.  Defaults to “200” MB</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['swift']['enable_snet']</code> - Set whether to use ServiceNET to communicate with the Swift Storage servers. (Rackspace specific option)</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['swift']['store_region']</code> -  The region of the swift endpoint to be used for single tenant. This setting is only necessary if the tenant has multiple swift endpoints.</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['rbd']['rbd_store_ceph_conf']</code> - Default location of ceph.conf</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['rbd']['rbd_store_user']</code> - User for connecting to ceph store</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['rbd']['rbd_store_pool']</code> - RADOS pool for images</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['rbd']['rbd_store_chunk_size']</code> - Size in MB of chunks for RADOS Store, should be a power of 2</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['rbd']['key_name']</code> - The data bag item name used for the Cephx key of the rbd_store_user.</li>
  <li><code class="highlighter-rouge">openstack['image']['cron']['redirection']</code> - Redirection of cron output
TODO: Add DB2 support on other platforms</li>
</ul>

<h2 id="ssl-attributes">SSL attributes</h2>

<p>Once SSL is enabled, endpoints attributes in Common need to updated to specify the https protocol.</p>

<ul>
  <li><code class="highlighter-rouge">openstack['image']['ssl']['enabled']</code> - Enable SSL for Glance API and registry bind endpoints. Default is false.</li>
  <li><code class="highlighter-rouge">openstack['image']['ssl']['api']['enabled']</code> - Enable SSL for Glance API bind endpoint. Default is from [‘image’][‘ssl’][‘enabled’].</li>
  <li><code class="highlighter-rouge">openstack['image']['ssl']['registry']['enabled']</code> - Enable SSL for Glance Registry bind endpoint. Default is from [‘image’][‘ssl’][‘enabled’].</li>
  <li><code class="highlighter-rouge">openstack['image']['ssl']['basedir']</code> -  Base directory for SSL certficate and key file.</li>
  <li><code class="highlighter-rouge">openstack['image']['ssl']['cert_file']</code> - Path of the cert file for SSL.</li>
  <li><code class="highlighter-rouge">openstack['image']['ssl']['key_file']</code> - Path of the keyfile for SSL.</li>
  <li><code class="highlighter-rouge">openstack['image']['ssl']['cert_required']</code> - Client certificate required. Default is False.</li>
  <li><code class="highlighter-rouge">openstack['image']['ssl']['ca_file']</code> -  Path of the CA cert file</li>
</ul>

<h2 id="vmware-attributes-1">VMWare attributes</h2>

<ul>
  <li><code class="highlighter-rouge">openstack['image']['api']['vmware']['secret_name']</code> - VMware databag secret name</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['vmware']['vmware_server_host']</code> - ESX/ESXi or vCenter Server target system. e.g. 127.0.0.1, 127.0.0.1:443, www.vmware-infra.com</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['vmware']['vmware_server_username']</code> - Server username (string value)</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['vmware']['vmware_datacenter_path']</code> - Inventory path to a datacenter (string value)</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['vmware']['vmware_datastore_name']</code> - Datastore associated with the datacenter (string value)</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['vmware']['vmware_api_retry_count']</code> - The number of times we retry on failures (integer value)</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['vmware']['vmware_task_poll_interval']</code> - The interval used for polling remote tasks invoked on VMware ESX/VC server in seconds (integer value)</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['vmware']['vmware_store_image_dir']</code> - Absolute path of the folder containing the images in the datastore (string value)</li>
  <li><code class="highlighter-rouge">openstack['image']['api']['vmware']['vmware_api_insecure']</code> - Allow to perform insecure SSL requests to the target system (boolean value)</li>
</ul>

<h2 id="mq-attributes-2">MQ attributes</h2>

<ul>
  <li><code class="highlighter-rouge">openstack['image']['mq']['service_type']</code> - Select qpid or rabbitmq. default rabbitmq</li>
  <li><code class="highlighter-rouge">openstack['image']['mq']['qpid']['host']</code> - The qpid host to use</li>
  <li><code class="highlighter-rouge">openstack['image']['mq']['qpid']['port']</code> - The qpid port to use</li>
  <li><code class="highlighter-rouge">openstack['image']['mq']['qpid']['qpid_hosts']</code> - Qpid hosts. TODO. use only when ha is specified.</li>
  <li><code class="highlighter-rouge">openstack['image']['mq']['qpid']['username']</code> - Username for qpid connection</li>
  <li><code class="highlighter-rouge">openstack['image']['mq']['qpid']['password']</code> - Password for qpid connection</li>
  <li><code class="highlighter-rouge">openstack['image']['mq']['qpid']['sasl_mechanisms']</code> - Space separated list of SASL mechanisms to use for auth</li>
  <li><code class="highlighter-rouge">openstack['image']['mq']['qpid']['reconnect_timeout']</code> - The number of seconds to wait before deciding that a reconnect attempt has failed.</li>
  <li><code class="highlighter-rouge">openstack['image']['mq']['qpid']['reconnect_limit']</code> - The limit for the number of times to reconnect before considering the connection to be failed.</li>
  <li><code class="highlighter-rouge">openstack['image']['mq']['qpid']['reconnect_interval_min']</code> - Minimum number of seconds between connection attempts.</li>
  <li><code class="highlighter-rouge">openstack['image']['mq']['qpid']['reconnect_interval_max']</code> - Maximum number of seconds between connection attempts.</li>
  <li><code class="highlighter-rouge">openstack['image']['mq']['qpid']['reconnect_interval']</code> - Equivalent to setting qpid_reconnect_interval_min and qpid_reconnect_interval_max to the same value.</li>
  <li><code class="highlighter-rouge">openstack['image']['mq']['qpid']['heartbeat']</code> - Seconds between heartbeat messages sent to ensure that the connection is still alive.</li>
  <li><code class="highlighter-rouge">openstack['image']['mq']['qpid']['protocol']</code> - Protocol to use. Default tcp.</li>
  <li><code class="highlighter-rouge">openstack['image']['mq']['qpid']['tcp_nodelay']</code> - Disable the Nagle algorithm. default disabled.</li>
</ul>

<h2 id="messaging-common-attributes">Messaging Common attributes</h2>

<ul>
  <li><code class="highlighter-rouge">openstack['image']["control_exchange"]</code> - The AMQP exchange to connect to if using RabbitMQ or Qpid, defaults to openstack</li>
  <li><code class="highlighter-rouge">openstack['image']['rpc_backend']</code> - The messaging module to use</li>
  <li><code class="highlighter-rouge">openstack['image']['rpc_thread_pool_size']</code> - Size of RPC thread pool</li>
  <li><code class="highlighter-rouge">openstack['image']['rpc_conn_pool_size']</code> - Size of RPC connection pool</li>
  <li><code class="highlighter-rouge">openstack['image']['rpc_response_timeout']</code> - Seconds to wait for a response from call or multicall</li>
</ul>

<p>The following attributes are defined in attributes/default.rb of the common cookbook, but are documented here due to their relevance:</p>

<ul>
  <li><code class="highlighter-rouge">openstack['endpoints']['image-api-bind']['host']</code> - The IP address to bind the api service to</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['image-api-bind']['port']</code> - The port to bind the api service to</li>
  <li>
    <p><code class="highlighter-rouge">openstack['endpoints']['image-api-bind']['bind_interface']</code> - The interface name to bind the api service to</p>
  </li>
  <li><code class="highlighter-rouge">openstack['endpoints']['image-registry-bind']['host']</code> - The IP address to bind the registry service to</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['image-registry-bind']['port']</code> - The port to bind the registry service to</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['image-registry-bind']['bind_interface']</code> - The interface name to bind the registry service to</li>
</ul>

<p>If the value of the ‘bind_interface’ attribute is non-nil, then the image service will be bound to the first IP address on that interface.  If the value of the ‘bind_interface’ attribute is nil, then the image service will be bound to the IP address specified in the host attribute.</p>

<hr />

<h3 id="cookbook-openstack-image-attributes-default">cookbook-openstack-image-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
'</span>
</code></pre>
</div>

<p>SSL Options
Enable SSL for glance api and registry bind endpoints.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># Enable SSL for glance api bind endpoint.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span>
<span class="c1"># Enable SSL for glance registry bind endpoint.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'registry'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span>
<span class="c1"># Base directory for SSL certficate and key</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'basedir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/glance/ssl'</span>
<span class="c1"># Specify server whether SSL certificate is required</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'ssl'</span><span class="p">][</span><span class="s1">'cert_required'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'verbose'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'False'</span>
</code></pre>
</div>

<p>This is the name of the Chef role that will install the Keystone Service API</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'identity_service_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-identity'</span>
</code></pre>
</div>

<p>Gets set in the Image Endpoint when registering with Keystone</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
</code></pre>
</div>

<p>The name of the Chef role that knows about the message queue server
that Glance uses</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'rabbit_server_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-ops-messaging'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'service_tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'service_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'glance'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'service_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
</code></pre>
</div>

<p>Supported values for the ‘container_format’ image attribute</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'container_formats'</span><span class="p">]</span> <span class="o">=</span> <span class="sx">%w(ami ari aki bare ovf ova docker dockerref)</span>
</code></pre>
</div>

<p>Supported values for the ‘disk_format’ image attribute
Whether to use any of the default caching pipelines from the paste configuration file</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'caching'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'cache_management'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>Directory for the Image Cache</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'cache'</span><span class="p">][</span><span class="s1">'dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/lib/glance/image-cache/'</span>
<span class="c1"># Number of seconds until an incomplete image is considered stalled an</span>
</code></pre>
</div>

<p>Number of seconds to leave invalid images around before they are eligible to be reaped</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'cache'</span><span class="p">][</span><span class="s1">'grace_period'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3600</span>
</code></pre>
</div>

<p>Default Image Locations</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'upload_images'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'cirros'</span><span class="p">]</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'upload_image'</span><span class="p">][</span><span class="s1">'precise'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http://cloud-images.ubuntu.com/precise/current/precise-server-cloudimg-amd64-disk1.img'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'upload_image'</span><span class="p">][</span><span class="s1">'oneiric'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http://cloud-images.ubuntu.com/oneiric/current/oneiric-server-cloudimg-amd64-disk1.img'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'upload_image'</span><span class="p">][</span><span class="s1">'natty'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http://cloud-images.ubuntu.com/natty/current/natty-server-cloudimg-amd64-disk1.img'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'upload_image'</span><span class="p">][</span><span class="s1">'cirros'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http://download.cirros-cloud.net/0.3.4/cirros-0.3.4-x86_64-disk.img'</span>
<span class="c1"># more images available at https://github.com/rackerjoe/oz-image-build</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'upload_image'</span><span class="p">][</span><span class="s1">'centos'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud.qcow2'</span>
<span class="c1"># To override image type</span>
<span class="c1"># The following disk format types are supported: qcow vhd vmdk vdi iso raw</span>
<span class="c1"># Bare container format will be used.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'upload_image_type'</span><span class="p">][</span><span class="s1">'cirros'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'qcow'</span>
</code></pre>
</div>

<p>logging attribute</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'LOG_LOCAL2'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'config_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'local2'</span>
</code></pre>
</div>

<p>vmware attributes</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'vmware'</span><span class="p">][</span><span class="s1">'secret_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'openstack_vmware_secret_name'</span>
</code></pre>
</div>

<p>cron output redirection</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'cron'</span><span class="p">][</span><span class="s1">'redirection'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'&gt; /dev/null 2&gt;&amp;1'</span>
</code></pre>
</div>

<p>platform-specific settings</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform_family</span>
<span class="k">when</span> <span class="s1">'rhel'</span> <span class="c1"># :pragma-foodcritic: ~FC024 - won't fix this</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'glance'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'glance'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'image_packages'</span> <span class="o">=&gt;</span> <span class="sx">%w(openstack-glance cronie python-glanceclient)</span><span class="p">,</span>
    <span class="s1">'image_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-glanceclient'</span><span class="p">],</span>
    <span class="s1">'ceph_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-ceph'</span><span class="p">],</span>
    <span class="s1">'swift_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-swift'</span><span class="p">],</span>
    <span class="s1">'image_api_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-glance-api'</span><span class="p">,</span>
    <span class="s1">'image_registry_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-glance-registry'</span><span class="p">,</span>
    <span class="s1">'image_api_process_name'</span> <span class="o">=&gt;</span> <span class="s1">'glance-api'</span><span class="p">,</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
<span class="k">when</span> <span class="s1">'suse'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'openstack-glance'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'openstack-glance'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'image_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-glance'</span><span class="p">,</span> <span class="s1">'python-glanceclient'</span><span class="p">],</span>
    <span class="s1">'image_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-glanceclient'</span><span class="p">],</span>
    <span class="s1">'ceph_packages'</span> <span class="o">=&gt;</span> <span class="p">[],</span>
    <span class="s1">'swift_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-swift'</span><span class="p">],</span>
    <span class="s1">'image_api_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-glance-api'</span><span class="p">,</span>
    <span class="s1">'image_registry_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-glance-registry'</span><span class="p">,</span>
    <span class="s1">'image_api_process_name'</span> <span class="o">=&gt;</span> <span class="s1">'glance-api'</span><span class="p">,</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'glance'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'glance'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'image_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'glance'</span><span class="p">],</span>
    <span class="s1">'image_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-glanceclient'</span><span class="p">],</span>
    <span class="s1">'ceph_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-ceph'</span><span class="p">],</span>
    <span class="s1">'swift_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-swift'</span><span class="p">],</span>
    <span class="s1">'image_api_service'</span> <span class="o">=&gt;</span> <span class="s1">'glance-api'</span><span class="p">,</span>
    <span class="s1">'image_registry_service'</span> <span class="o">=&gt;</span> <span class="s1">'glance-registry'</span><span class="p">,</span>
    <span class="s1">'image_registry_process_name'</span> <span class="o">=&gt;</span> <span class="s1">'glance-registry'</span><span class="p">,</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s2">"-o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef'"</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<p><strong>**</strong><strong>**</strong><strong>**</strong>** OpenStack Image Endpoints <strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong>
The OpenStack Image (Glance) endpoints</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="sx">%w(public internal admin)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">ep_type</span><span class="o">|</span>
  <span class="sx">%w(image_api image_registry)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">service</span><span class="o">|</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'scheme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http'</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="n">service</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'image_api'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">''</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'image_api'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9292</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'image_registry'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/v2'</span>
    <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'image_registry'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9191</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'image_registry'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'image_registry'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9191</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'image_api'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'image_api'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9292</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-image-attributes-glanceapiconf">cookbook-openstack-image-attributes-glance_api_conf</h3>

<p><a href="#contents">back to top</a></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image_api'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="c1"># [DEFAULT] section</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_config'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack/logging.conf'</span>
  <span class="k">else</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/glance/api.log'</span>
  <span class="k">end</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'rpc_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [glance_store] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'glance_store'</span><span class="p">][</span><span class="s1">'default_store'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'file'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [paste_deploy] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'paste_deploy'</span><span class="p">][</span><span class="s1">'flavor'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [keystone_authtoken] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'auth_plugin'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'region_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'glance'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'signing_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/glance/api'</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-image-attributes-glancecacheconf">cookbook-openstack-image-attributes-glance_cache_conf</h3>

<p><a href="#contents">back to top</a></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image-cache'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="c1"># [DEFAULT] section</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_config'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack/logging.conf'</span>
  <span class="k">else</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/glance/image-cache.log'</span>
  <span class="k">end</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'image_cache_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/lib/glance/image-cache/'</span> <span class="c1"># none in docs</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-image-attributes-glanceregistryconf">cookbook-openstack-image-attributes-glance_registry_conf</h3>

<p><a href="#contents">back to top</a></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image_registry'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="c1"># [DEFAULT] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'rpc_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_config'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack/logging.conf'</span>
  <span class="k">else</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/glance/registry.log'</span>
  <span class="k">end</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [paste_deploy] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'paste_deploy'</span><span class="p">][</span><span class="s1">'flavor'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'keystone'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1">#  [keystone_authtoken] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'auth_plugin'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'region_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'glance'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'signing_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/glance/registry'</span> <span class="c1"># none in docs</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-image-attributes-glancescrubberconf">cookbook-openstack-image-attributes-glance_scrubber_conf</h3>

<p><a href="#contents">back to top</a></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image-scrubber'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="c1"># [DEFAULT] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'verbose'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'image'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_config'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack/logging.conf'</span>
  <span class="k">else</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/glance/scrubber.log'</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-network">cookbook-openstack-network</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-network-readme">cookbook-openstack-network-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-8">Description</h1>

<p>TODO: (jklare) needs refactoring too</p>

<p>This cookbook installs the <strong>OpenStack Network</strong> service (formerly project-named Quantum, current name is Neutron)
as part of a Chef reference deployment of OpenStack.</p>

<p>More information about the OpenStack Network service is available
<a href="http://docs.openstack.org/trunk/openstack-network/admin/content/index.html">here</a></p>

<h1 id="usage-9">Usage</h1>

<p>OpenStack Network’s design is modular, with plugins available that handle L2 and
L3 networking for various hardware vendors and standards.</p>

<h1 id="requirements-9">Requirements</h1>

<p>Chef 11.4.4 or higher required (for Chef environment use)</p>

<h2 id="cookbooks-7">Cookbooks</h2>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>openstack-identity</li>
  <li>openstack-common</li>
</ul>

<h1 id="recipes-1">Recipes</h1>

<h2 id="client-5">client</h2>

<ul>
  <li>Install the network client packages</li>
</ul>

<h2 id="server-1">server</h2>

<ul>
  <li>Installs the openstack-network API server</li>
</ul>

<h2 id="dhcpagent">dhcp_agent</h2>

<ul>
  <li>Installs the DHCP agent</li>
</ul>

<h2 id="l3agent">l3_agent</h2>

<ul>
  <li>Installs the L3 agent and metadata agent</li>
</ul>

<h2 id="vpnagent">vpn_agent</h2>

<ul>
  <li>Installs the VPN agent</li>
</ul>

<h2 id="identity-registration">Identity-registration</h2>

<ul>
  <li>Registers the OpenStack Network API endpoint and service user with Keystone</li>
</ul>

<h2 id="hyperv">hyperv</h2>

<ul>
  <li>Install the drivers for hyperv needed by OpenStack network.</li>
  <li>The networking-hyperv has not been included by linux distributions, it needs been created by users.</li>
  <li>The source code of networking-hyperv maintains in https://github.com/stackforge/networking-hyperv.</li>
</ul>

<h1 id="attributes-9">Attributes</h1>

<ul>
  <li><code class="highlighter-rouge">openstack['network']['service_provider']</code> - Array of service providers (drivers) for advanced services like loadbalancer, VPN, Firewall.</li>
  <li><code class="highlighter-rouge">openstack['network']['api']['auth']['version']</code> - Select v2.0 or v3.0. Default v2.0. The auth API version used to interact with identity service.</li>
  <li><code class="highlighter-rouge">openstack['network']["misc_neutron"]</code> - Array of strings to be added to neutron.conf</li>
  <li><code class="highlighter-rouge">openstack['network']['api']['auth']['memcached_servers']</code> - A list of memcached server(s) for caching</li>
  <li><code class="highlighter-rouge">openstack['network']['api']['auth']['memcache_security_strategy']</code> - Whether token data should be authenticated or authenticated and encrypted. Acceptable values are MAC or ENCRYPT.</li>
  <li><code class="highlighter-rouge">openstack['network']['api']['auth']['memcache_secret_key']</code> - This string is used for key derivation.</li>
  <li><code class="highlighter-rouge">openstack['network']['api']['auth']['hash_algorithms']</code> - Hash algorithms to use for hashing PKI tokens.</li>
  <li><code class="highlighter-rouge">openstack['network']['api']['auth']['cafile']</code> - A PEM encoded Certificate Authority to use when verifying HTTPs connections.</li>
  <li><code class="highlighter-rouge">openstack['network']['api']['auth']['insecure']</code> - Whether to allow the client to perform insecure SSL (https) requests.</li>
  <li><code class="highlighter-rouge">openstack['network']['dbsync_timeout']</code> - Set dbsync command timeout value</li>
</ul>

<p>TODO
* <code class="highlighter-rouge">openstack["network"]["service_plugins"]</code> - Array of Python classes to be used as <code class="highlighter-rouge">service_plugins</code> in neutron.conf (default: []). Set it to [‘neutron.plugins.services.agent_loadbalancer.plugin.LoadBalancerPlugin’] to include the load balancer plugin.</p>

<h2 id="neutron-nova-interactions">Neutron Nova interactions</h2>
<ul>
  <li><code class="highlighter-rouge">openstack["network"]["nova"]["cafile"]</code> - CA file for novaclient to verify server certificates</li>
  <li><code class="highlighter-rouge">openstack["network"]["nova"]["insecure"]</code> - Boolean to control ignoring SSL errors on the nova url</li>
</ul>

<h2 id="mq-attributes-3">MQ attributes</h2>
<ul>
  <li><code class="highlighter-rouge">openstack["network"]["mq"]["service_type"]</code> - Select qpid or rabbitmq. default rabbitmq
TODO: move rabbit parameters under openstack[“network”][“mq”]</li>
  <li><code class="highlighter-rouge">openstack["network"]["rabbit"]["username"]</code> - Username for nova rabbit access</li>
  <li><code class="highlighter-rouge">openstack["network"]["rabbit"]["vhost"]</code> - The rabbit vhost to use</li>
  <li><code class="highlighter-rouge">openstack["network"]["rabbit"]["port"]</code> - The rabbit port to use</li>
  <li><code class="highlighter-rouge">openstack["network"]["rabbit"]["host"]</code> - The rabbit host to use (must set when <code class="highlighter-rouge">openstack["network"]["rabbit"]["ha"]</code> false).</li>
  <li>
    <p><code class="highlighter-rouge">openstack["network"]["rabbit"]["ha"]</code> - Whether or not to use rabbit ha</p>
  </li>
  <li><code class="highlighter-rouge">openstack["network"]["mq"]["qpid"]["host"]</code> - The qpid host to use</li>
  <li><code class="highlighter-rouge">openstack["network"]["mq"]["qpid"]["port"]</code> - The qpid port to use</li>
  <li><code class="highlighter-rouge">openstack["network"]["mq"]["qpid"]["qpid_hosts"]</code> - Qpid hosts. TODO. use only when ha is specified.</li>
  <li><code class="highlighter-rouge">openstack["network"]["mq"]["qpid"]["username"]</code> - Username for qpid connection</li>
  <li><code class="highlighter-rouge">openstack["network"]["mq"]["qpid"]["password"]</code> - Password for qpid connection</li>
  <li><code class="highlighter-rouge">openstack["network"]["mq"]["qpid"]["sasl_mechanisms"]</code> - Space separated list of SASL mechanisms to use for auth</li>
  <li><code class="highlighter-rouge">openstack["network"]["mq"]["qpid"]["reconnect_timeout"]</code> - The number of seconds to wait before deciding that a reconnect attempt has failed.</li>
  <li><code class="highlighter-rouge">openstack["network"]["mq"]["qpid"]["reconnect_limit"]</code> - The limit for the number of times to reconnect before considering the connection to be failed.</li>
  <li><code class="highlighter-rouge">openstack["network"]["mq"]["qpid"]["reconnect_interval_min"]</code> - Minimum number of seconds between connection attempts.</li>
  <li><code class="highlighter-rouge">openstack["network"]["mq"]["qpid"]["reconnect_interval_max"]</code> - Maximum number of seconds between connection attempts.</li>
  <li><code class="highlighter-rouge">openstack["network"]["mq"]["qpid"]["reconnect_interval"]</code> - Equivalent to setting qpid_reconnect_interval_min and qpid_reconnect_interval_max to the same value.</li>
  <li><code class="highlighter-rouge">openstack["network"]["mq"]["qpid"]["heartbeat"]</code> - Seconds between heartbeat messages sent to ensure that the connection is still alive.</li>
  <li><code class="highlighter-rouge">openstack["network"]["mq"]["qpid"]["protocol"]</code> - Protocol to use. Default tcp.</li>
  <li><code class="highlighter-rouge">openstack["network"]["mq"]["qpid"]["tcp_nodelay"]</code> - Disable the Nagle algorithm. default disabled.</li>
</ul>

<h2 id="linuxbridge-plugin-attributes">Linuxbridge plugin attributes</h2>
<ul>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['linuxbridge']['tenant_network_type']</code> - Type of network to allocate for tenant networks. (default ‘local’)</li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['linuxbridge']['network_vlan_ranges']</code> - Comma-separated list of <physical_network>[:<vlan_min>:<vlan_max>] tuples enumerating ranges of VLAN IDs</vlan_max></vlan_min></physical_network></li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['linuxbridge']['physical_interface_mappings']</code> - (ListOpt) Comma-separated list of <physical_network>:<physical_interface> tuples mapping physical network names</physical_interface></physical_network></li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['linuxbridge']['enable_vxlan']</code> - (BoolOpt) enable VXLAN on the agent. (default false)</li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['linuxbridge']['ttl']</code> - (IntOpt) use specific TTL for vxlan interface protocol packets</li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['linuxbridge']['tos']</code> - (IntOpt) use specific TOS for vxlan interface protocol packets</li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['linuxbridge']['vxlan_group']</code> - (StrOpt) multicast group to use for broadcast emulation. (default ‘224.0.0.1’)</li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['linuxbridge']['l2_population']</code> - (BoolOpt) Flag to enable l2population extension. (default false)</li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['linuxbridge']['polling_interval']</code> - Agent polling interval in seconds. (default 2)</li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['linuxbridge']['rpc_support_old_agents']</code> - (BoolOpt) Enable server RPC compatibility with old (pre-havana). (default false)</li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['linuxbridge']['firewall_driver']</code> - Firewall driver for realizing neutron security group function</li>
</ul>

<h2 id="modular-layer-2-plugin-configuration">Modular Layer 2 Plugin Configuration</h2>
<ul>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['ml2']['type_drivers']</code> - (ListOpt) List of network type driver entrypoints to be loaded from the neutron.ml2.type_drivers namespace.</li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['ml2']['tenant_network_types']</code> - (ListOpt) Ordered list of net work_types to allocate as tenant networks. (default local)</li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['ml2']['mechanism_drivers']</code> - (ListOpt) Ordered list of networ king mechanism driver entrypoints to be loaded from the neutron.ml2.mechanism_drivers namespace.</li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['ml2']['flat_networks']</code> - (ListOpt) List of physical_network names with which flat networks can be created.</li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['ml2']['network_vlan_ranges']</code> - (ListOpt) List of <physical_network>[:<vlan_min>:<vlan_max>] tuples specifying physical_network names usable for VLAN provider and tenant networks</vlan_max></vlan_min></physical_network></li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['ml2']['tunnel_id_ranges']</code> - (ListOpt) Comma-separated list of <tun_min>:<tun_max> tuples enumerating ranges of GRE tunnel IDs that are available for tenant network allocation</tun_max></tun_min></li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['ml2']['vni_ranges']</code> - (ListOpt) Comma-separated list of <vni_min>:<vni_max> tuples enumerating ranges of VXLAN VNI IDs that are available for tenant network allocation.</vni_max></vni_min></li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['ml2']['vxlan_group']</code> - (StrOpt) Multicast group for the VXLAN interface.</li>
</ul>

<h2 id="dhcp-agent-configuration">DHCP Agent Configuration</h2>
<ul>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['dhcp']['dhcp_delete_namespaces']</code> - (StrOpt) If True, namespaces will be deleted when a dhcp server is disabled.</li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['dhcp']['dhcp_agents_per_network']</code> - (IntOpt) Set the number of dhcp agents for each network. (default 1)</li>
</ul>

<h2 id="l3-agent-configuration">L3 Agent Configuration</h2>
<ul>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['l3']['router_delete_namespaces']</code> - (StrOpt) If True, namespaces will be deleted when a router is destroyed.</li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['l3']['ha']['l3_ha']</code> - (BoolOpt) If True, virtual router will be created as ha by default. (default False)</li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['l3']['ha']['max_l3_agents_per_router']</code> - (IntOpt)  The maximum number of l3 agents for each ha router. (default 3)</li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['l3']['ha']['ha_vrrp_advert_int']</code> - (IntOpt) The advertisement interval in seconds. (default 2)</li>
  <li>`openstack[‘openstack’][‘network’][‘l3’][‘router_distributed’] - Both true(bool) and ‘true’(str) will set DVR(Distributed Virtual Router) configure enabled. Setting ‘auto’ will do a simple check then decide whether or not to enable DVR, default is enabled with OVS.</li>
  <li>`openstack[‘openstack’][‘network’][‘l3’][‘router_delete_namespaces’] - (StrOpt) If True, namespaces will be deleted when a router is destroyed.</li>
</ul>

<h2 id="vpn-agent-configuration">VPN Agent Configuration</h2>
<ul>
  <li>`openstack[‘openstack’][‘network’][‘enable_vpn’] - (BoolOpt) Used to enable VPN agent, if true, namespaces must be enabled. (default false)</li>
  <li>`openstack[‘openstack’][‘network’][‘vpn’][‘vpn_device_driver’] - (ListOpt) Comma-separated list of VPN device drivers which VPN agent will use</li>
  <li>`openstack[‘openstack’][‘network’][‘vpn’][‘ipsec_status_check_interval’] - (IntOpt) Status check interval for ipsec VPN</li>
</ul>

<h2 id="lbaas-agent-configuration">LBaaS Agent Configuration</h2>
<ul>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['lbaas']['custom_interface_driver']</code> - Custom plugin to support new interface drivers</li>
  <li><code class="highlighter-rouge">openstack['openstack']['network']['lbaas']['ovs_use_veth']</code> - (BoolOpt) Used to enable veth pairs for OVS based plugins</li>
</ul>

<p>The following attributes are defined in attributes/default.rb of the common cookbook, but are documented here due to their relevance:</p>

<ul>
  <li><code class="highlighter-rouge">openstack['endpoints']['network-api-bind']['host']</code> - The IP address to bind the api service to</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['network-api-bind']['port']</code> - The port to bind the api service to</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['network-api-bind']['bind_interface']</code> - The interface name to bind the api service to</li>
</ul>

<p>If the value of the ‘bind_interface’ attribute is non-nil, then the network service will be bound to the first IP address on that interface.  If the value of the ‘bind_interface’ attribute is nil, then the network service will be bound to the IP address specified in the host attribute.</p>

<h1 id="templates">Templates</h1>
<ul>
  <li><code class="highlighter-rouge">neutron.conf.erb</code> - Config file for OpenStack Network server</li>
  <li><code class="highlighter-rouge">ml2_conf.ini.erb</code> - Configuration of Network ML2 Plugins</li>
  <li><code class="highlighter-rouge">vpn_agent.ini.erb</code> - Config file for Network VPN agent</li>
</ul>

<hr />

<h3 id="cookbook-openstack-network-attributes-default">cookbook-openstack-network-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Set the endpoints for the network service to allow all other cookbooks to
access and use them</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="sx">%w(public internal admin)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">ep_type</span><span class="o">|</span>
  <span class="c1"># openstack identity service endpoints (used by users and services)</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'scheme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">''</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9696</span>
  <span class="c1"># web-service (e.g. apache) listen address (can be different from openstack</span>
  <span class="c1"># network endpoints)</span>
<span class="k">end</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9696</span>
</code></pre>
</div>

<p>trigger the usage of syslog (will include the proper recipe to create a log
config)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># Name of the plugin to load</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'nova'</span><span class="p">][</span><span class="s1">'auth_plugin'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
<span class="c1"># Name of the plugin to load</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'identity-api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2.0'</span>
<span class="c1"># Set dbsync command timeout value</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'dbsync_timeout'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3600</span>
<span class="c1"># Specify policy.json remote filwe to import</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'policyfile_url'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="c1"># Gets set in the Network Endpoint when registering with Keystone</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'service_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'service_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'network'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'description'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'OpenStack Networking service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'rabbit_server_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'rabbitmq-server'</span>
<span class="c1"># Keystone PKI signing directory.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'cache_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/neutron/api'</span>
<span class="c1"># The bridging interface driver.</span>
<span class="c1"># This is used by the L3, DHCP and LBaaS agents.</span>
<span class="c1"># Options are:</span>
<span class="c1">#</span>
<span class="c1">#   - neutron.agent.linux.interface.OVSInterfaceDriver</span>
<span class="c1">#   - neutron.agent.linux.interface.BridgeInterfaceDriver</span>
<span class="c1">#</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'interface_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron.agent.linux.interface.OVSInterfaceDriver'</span>
<span class="c1"># The agent can use other DHCP drivers.  Dnsmasq is the simplest and requires</span>
<span class="c1"># no additional setup of the DHCP server.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'dhcp_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron.agent.linux.dhcp.Dnsmasq'</span>
<span class="c1"># Version for connection to nova</span>
<span class="c1"># TODO: (MRV) Need to allow for this in Common.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'nova'</span><span class="p">][</span><span class="s1">'url_version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/v2'</span>
</code></pre>
</div>

<p>============================= rootwrap Configuration ===================
use neutron root wrap</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'use_rootwrap'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="c1"># rootwrap.conf</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'rootwrap'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'filters_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/neutron/rootwrap.d,/usr/share/neutron/rootwrap'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'exec_dirs'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/sbin,/usr/sbin,/bin,/usr/bin'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'use_syslog'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'syslog_log_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'syslog'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'syslog_log_level'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ERROR'</span>
<span class="k">end</span>
</code></pre>
</div>

<p>============================= dnsmasq Configuration ===================
TODO: (jklare) this should be refactored and probably pull in the some dnsmasq
cookbook to do the proper configuration
the version of dnsmasq for centos 6.5 is two revs behind where the dhcp-agent needs
to run properly. This is a version that allows and starts the dhcp-agent correctly.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'dnsmasq'</span><span class="p">][</span><span class="s1">'rpm_version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'2.65-1.el6.rfx.x86_64'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'dnsmasq'</span><span class="p">][</span><span class="s1">'rpm_source'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"http://pkgs.repoforge.org/dnsmasq/dnsmasq-</span><span class="si">#{</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'dnsmasq'</span><span class="p">][</span><span class="s1">'rpm_version'</span><span class="p">]</span><span class="si">}</span><span class="s2">.rpm"</span>
<span class="c1"># Upstream resolver to use</span>
<span class="c1"># This will be used by dnsmasq to resolve recursively</span>
<span class="c1"># but will not be used if the tenant specifies a dns</span>
<span class="c1"># server in their subnet</span>
<span class="c1">#</span>
<span class="c1"># Defaults are spread out across multiple, presumably</span>
<span class="c1"># reliable, upstream providers</span>
<span class="c1">#</span>
<span class="c1"># 8.8.8.8 is Google</span>
<span class="c1"># 209.244.0.3 is Level3</span>
<span class="c1">#</span>
<span class="c1"># May be a comma separated list of servers</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'dnsmasq'</span><span class="p">][</span><span class="s1">'upstream_dns_servers'</span><span class="p">]</span> <span class="o">=</span> <span class="sx">%w(8.8.8.8 209.244.0.3)</span>
</code></pre>
</div>

<p>============================= DHCP Agent Configuration ===================</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_dhcp'</span><span class="p">][</span><span class="s1">'config_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/neutron/dhcp_agent.ini'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_dhcp'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'interface_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron.agent.linux.interface.OVSInterfaceDriver'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'dnsmasq_config_file '</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/neutron/dnsmasq.conf'</span>
<span class="k">end</span>
</code></pre>
</div>

<p>============================= L3 Agent Configuration =====================</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_l3'</span><span class="p">][</span><span class="s1">'external_network_bridge_interface'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'eth1'</span>
</code></pre>
</div>

<p>Customize the l3 config file path</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_l3'</span><span class="p">][</span><span class="s1">'config_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/neutron/l3_agent.ini'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_l3'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'interface_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron.agent.linux.interface.OVSInterfaceDriver'</span>
  <span class="c1"># Name of bridge used for external network traffic. This should be set to</span>
  <span class="c1"># empty value for the linux bridge. When external_network_bridge is empty or nil,</span>
  <span class="c1"># creation of external bridge will be skipped in the recipe.</span>
  <span class="c1"># Interface to use for external bridge.</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'external_network_bridge'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'br-ex'</span>
<span class="k">end</span>
</code></pre>
</div>

<p>============================= Metadata Agent Configuration ===============</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_metadata'</span><span class="p">][</span><span class="s1">'config_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/neutron/metadata_agent.ini'</span>
<span class="c1"># The name of the secret databag containing the metadata secret</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_metadata'</span><span class="p">][</span><span class="s1">'secret_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron_metadata_secret'</span>
<span class="n">node</span><span class="p">.</span><span class="nf">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_metadata'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre>
</div>

<p>============================= Metering Agent Configuration ===============</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_metering'</span><span class="p">][</span><span class="s1">'config_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/neutron/metering_agent.ini'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_metering'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'interface_driver'</span><span class="p">]</span> <span class="o">=</span>
    <span class="s1">'neutron.agent.linux.interface.OVSInterfaceDriver'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'driver'</span><span class="p">]</span> <span class="o">=</span>
    <span class="s1">'neutron.services.metering.drivers.iptables.iptables_driver.IptablesMeteringDriver'</span>
<span class="k">end</span>
</code></pre>
</div>

<p>============================= VPN Agent Configuration ====================
vpn_device_driver_packages in platform-specific settings is used to get driver dependencies installed, default is openswan
vpn_device_driver_services in platform-specific settings is used to enable services required by vpn drivers, default is ipsec
Set to true to enable vpnaas</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_vpnaas'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># Custom the vpnaas config file path</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_vpnaas'</span><span class="p">][</span><span class="s1">'config_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/neutron/vpn_agent.ini'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_vpnaas'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="c1"># VPN device drivers which vpn agent will use</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'interface_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron.agent.linux.interface.OVSInterfaceDriver'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'vpnagent'</span><span class="p">][</span><span class="s1">'vpn_device_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron_vpnaas.services.vpn.device_drivers.ipsec.OpenSwanDriver'</span>
  <span class="c1"># Status check interval for ipsec vpn</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'ipsec'</span><span class="p">][</span><span class="s1">'ipsec_status_check_interval'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">60</span>
  <span class="c1"># default_config_area settings is used to set the area where default StrongSwan configuration files are located</span>
  <span class="k">case</span> <span class="n">platform_family</span>
  <span class="k">when</span> <span class="s1">'fedora'</span><span class="p">,</span> <span class="s1">'rhel'</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'strongswan'</span><span class="p">][</span><span class="s1">'default_config_area'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/usr/share/strongswan/templates/config/strongswan.d'</span>
  <span class="k">when</span> <span class="s1">'debian'</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'strongswan'</span><span class="p">][</span><span class="s1">'default_config_area'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/strongswan.d'</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>============================= LBaaS Agent Configuration ==================
Set to true to enable lbaas</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_lbaas'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># Custom the lbaas config file path</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_lbaas'</span><span class="p">][</span><span class="s1">'config_file'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/neutron/lbaas_agent.ini'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_lbaas'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'periodic_interval'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'ovs_use_veth'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'interface_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron.agent.linux.interface.OVSInterfaceDriver'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'device_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron_lbaas.services.loadbalancer.drivers.haproxy.namespace_driver.HaproxyNSDriver'</span>
  <span class="k">case</span> <span class="n">platform_family</span>
  <span class="k">when</span> <span class="s1">'fedora'</span><span class="p">,</span> <span class="s1">'rhel'</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'haproxy'</span><span class="p">][</span><span class="s1">'user_group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nobody'</span>
  <span class="k">when</span> <span class="s1">'debian'</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'haproxy'</span><span class="p">][</span><span class="s1">'user_group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nogroup'</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>============================= FWaaS Configuration ==================
TODO(jklare) : check why the package is installed and if the configuration
works at all (if so, this needs refactoring parallel to the lbaas and vpnaas
recipes and attributes)
Set to True to enable firewall service</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network_fwaas'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># Firewall service driver with linux iptables</span>
<span class="c1"># default['openstack']['network']['fwaas']['driver'] = 'neutron_fwaas.services.firewall.drivers.linux.iptables_fwaas.IptablesFwaasDriver'</span>
<span class="c1"># Custom the fwaas config file path</span>
<span class="c1"># default['openstack']['network']['fwaas']['config_file'] = '/etc/neutron/fwaas_driver.ini'</span>

<span class="o">=============================</span> <span class="n">platform</span><span class="o">-</span><span class="n">specific</span> <span class="n">settings</span> <span class="o">===========</span>

<span class="sb">``` ruby
default['openstack']['network']['platform'].tap do |platform|
  platform['user'] = 'neutron'
  platform['group'] = 'neutron'
  platform['vpn_device_driver_packages'] =
    %w(openswan)
  platform['neutron_dhcp_agent_service'] =
    'neutron-dhcp-agent'
  platform['neutron_l3_agent_service'] =
    'neutron-l3-agent'
  platform['neutron_vpn_agent_service'] =
    'neutron-vpn-agent'
  platform['vpn_device_driver_services'] =
    %w(ipsec)
  platform['neutron_lb_agent_service'] =
    'neutron-lbaas-agent'
  platform['neutron_metadata_agent_service'] =
    'neutron-metadata-agent'
  platform['neutron_metering_agent_service'] =
    'neutron-metering-agent'
  platform['neutron_server_service'] =
    'neutron-server'
  platform['neutron_lbaas_python_dependencies'] =
    %w(python-neutron-lbaas)
  platform['neutron_vpnaas_python_dependencies'] =
    %w(python-neutron-vpnaas)
  case platform_family
  when 'fedora', 'rhel' # :pragma-foodcritic: ~FC024 - won't fix this
    platform['neutron_packages'] =
      %w(openstack-neutron openstack-neutron-ml2 iproute)
    platform['neutron_client_packages'] =
      %w(python-neutronclient)
    platform['neutron_dhcp_packages'] =
      %w(openstack-neutron iproute)
    platform['neutron_l3_packages'] =
      %w(openstack-neutron iproute radvd keepalived)
    platform['neutron_plugin_package'] =
      'neutron-plugin-ml2'
    # openstack-neutron-fwaas
    platform['neutron_vpnaas_packages'] =
      %w(openstack-neutron-vpnaas iproute)
    platform['neutron_lbaas_packages'] =
      %w(openstack-neutron-lbaas haproxy iproute)
    platform['neutron_openvswitch_packages'] =
      %w(openvswitch)
    platform['neutron_openvswitch_agent_packages'] =
      %w(openstack-neutron-openvswitch iproute)
    platform['neutron_linuxbridge_agent_packages'] =
      %w(openstack-neutron-linuxbridge iproute)
    platform['neutron_linuxbridge_agent_service'] =
      %w(neutron-plugin-linuxbridge-agent)
    platform['neutron_metadata_agent_packages'] =
      %w()
    platform['neutron_metering_agent_packages'] =
      %w(openstack-neutron-metering-agent)
    platform['neutron_server_packages'] =
      %w()
    platform['neutron_openvswitch_service'] =
      'openvswitch'
    platform['neutron_openvswitch_agent_service'] =
      'neutron-openvswitch-agent'
    platform['package_overrides'] =
      ''
  when 'debian'
    platform['neutron_packages'] =
      %w(neutron-common python-pyparsing python-cliff)
    platform['neutron_client_packages'] =
      %w(python-neutronclient python-pyparsing)
    platform['neutron_dhcp_packages'] =
      %w(neutron-dhcp-agent)
    platform['neutron_l3_packages'] =
      %w(neutron-l3-agent radvd keepalived)
    # python-neutron-fwaas
    platform['neutron_vpnaas_packages'] =
      %w(python-neutron-vpnaas neutron-vpn-agent)
    platform['neutron_lbaas_packages'] =
      %w(python-neutron-lbaas neutron-lbaas-agent haproxy)
    platform['neutron_openvswitch_packages'] =
      %w(openvswitch-switch openvswitch-datapath-dkms bridge-utils)
    platform['neutron_openvswitch_build_packages'] =
      %w(
        build-essential pkg-config fakeroot
        libssl-dev openssl debhelper
        autoconf dkms python-all
        python-qt4 python-zopeinterface
        python-twisted-conch
      )
    platform['neutron_openvswitch_agent_packages'] =
      %w(neutron-openvswitch-agent)
    platform['neutron_linuxbridge_agent_packages'] =
      %w(neutron-plugin-linuxbridge neutron-plugin-linuxbridge-agent)
    platform['neutron_linuxbridge_agent_service'] =
      'neutron-plugin-linuxbridge-agent'
    platform['neutron_metadata_agent_packages'] =
      %w(neutron-metadata-agent)
    platform['neutron_metering_agent_packages'] =
      %w(neutron-metering-agent)
    platform['neutron_server_packages'] =
      %w(neutron-server)
    platform['neutron_openvswitch_service'] =
      'openvswitch-switch'
    platform['neutron_openvswitch_agent_service'] =
      'neutron-openvswitch-agent'
    platform['package_overrides'] =
      "-o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef'"
  end
end
</span></code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-network-attributes-neutronconf">cookbook-openstack-network-attributes-neutron_conf</h3>

<p><a href="#contents">back to top</a></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'conf_secrets'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">].</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
  <span class="c1"># [DEFAULT] section</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_config_append'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/openstack/logging.conf'</span>
  <span class="k">else</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/neutron'</span>
  <span class="k">end</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'control_exchange'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'core_plugin'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ml2'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'rpc_backend'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'service_type'</span><span class="p">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [agent] section</span>
  <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'use_rootwrap'</span><span class="p">]</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">'agent'</span><span class="p">][</span><span class="s1">'root_helper'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'sudo neutron-rootwrap /etc/neutron/rootwrap.conf'</span>
  <span class="k">end</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [keystone_authtoken] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'auth_plugin'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'region_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'neutron'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [nova] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'nova'</span><span class="p">][</span><span class="s1">'auth_plugin'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'nova'</span><span class="p">][</span><span class="s1">'region_name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'nova'</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nova'</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'nova'</span><span class="p">][</span><span class="s1">'tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1"># [oslo_concurrency] section</span>
  <span class="n">conf</span><span class="p">[</span><span class="s1">'oslo_concurrency'</span><span class="p">][</span><span class="s1">'lock_path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/lib/neutron/lock'</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-object-storage">cookbook-openstack-object-storage</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-object-storage-readme">cookbook-openstack-object-storage-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-9">Description</h1>

<p>Installs the OpenStack Object Storage service <strong>Swift</strong> as part of the OpenStack reference deployment Chef for OpenStack. The http://github.com/openstack/chef-openstack-repo contains documentation for using this cookbook in the context of a full OpenStack deployment. Swift is currently installed from packages.</p>

<p>https://wiki.openstack.org/wiki/Swift</p>

<h1 id="requirements-10">Requirements</h1>

<h2 id="clients">Clients</h2>

<ul>
  <li>CentOS &gt;= 7</li>
  <li>Ubuntu &gt;= 14.04</li>
</ul>

<h2 id="chef">Chef</h2>

<ul>
  <li>12</li>
</ul>

<h2 id="dependent-cookbooks">Dependent Cookbooks</h2>

<ul>
  <li>openstack-common</li>
  <li>openstack-identity</li>
  <li>memcached</li>
  <li>statsd</li>
</ul>

<h1 id="roles">Roles</h1>

<ul>
  <li>swift-account-server - storage node for account data</li>
  <li>swift-container-server - storage node for container data</li>
  <li>swift-management-server - responsible for ring generation</li>
  <li>swift-object-server - storage node for object server</li>
  <li>swift-proxy-server - proxy for swift storage nodes</li>
  <li>swift-setup - server responsible for generating initial settings</li>
</ul>

<p>The swift-management-server role performs the following functions:</p>

<ul>
  <li>proxy node that knows super admin password</li>
  <li>ring repository and ring building workstation</li>
  <li>generally always has the swift-setup role too</li>
  <li>there can only be <em>one</em> swift-management-server</li>
</ul>

<p>There <em>must</em> be a node with the the swift-management-server role to act
as the ring repository.</p>

<p>In small environments, it is likely that all storage machines will
have all-in-one roles, with a load balancer ahead of it</p>

<p>In larger environments, where it is cost effective to split the proxy
and storage layer, storage nodes will carry
swift-{account,container,object}-server roles, and there will be
dedicated hosts with the swift-proxy-server role.</p>

<p>In really really huge environments, it’s possible that the storage
node will be split into swift-{container,account}-server nodes and
swift-object-server nodes.</p>

<h1 id="recipes-2">Recipes</h1>

<h2 id="client-6">client</h2>
<ul>
  <li>Install the swift client packages</li>
</ul>

<h1 id="attributes-10">Attributes</h1>

<p>There are other attributes that must be set depending on authmode.
For “swauth”, the following attributes are used:</p>

<ul>
  <li><code class="highlighter-rouge">default[:swift][:authkey]</code> - swauth super admin key if using swauth (defaults to test)</li>
</ul>

<p>The following secrets can be defined in the databag defined in Common [‘openstack’][‘secret’][‘secrets_data_bag’]</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="w">        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"swift_hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1a7c0568fa84"</span><span class="w">
          </span><span class="s2">"swift_authkey"</span><span class="err">:</span><span class="w"> </span><span class="s2">"keY4all"</span><span class="w">
          </span><span class="s2">"dispersion_auth_user"</span><span class="err">:</span><span class="w"> </span><span class="s2">"ops:dispersion"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"dispersion_auth_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dispersionpass"</span><span class="w">
        </span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>In addition, because swift is typically deployed as a cluster
there are some attributes used to find interfaces and ip addresses
on storage nodes:</p>

<ul>
  <li><code class="highlighter-rouge">default[:swift][:git_builder_ip]</code> - the IP address of the management server which other cluster members will use as their git pull target for ring updates (defaults to 127.0.0.1)</li>
  <li><code class="highlighter-rouge">default[:swift][:network][:proxy-bind-ip]</code> - the IP address to bind to
on the proxy servers (defaults to 0.0.0.0 for all addresses)</li>
  <li><code class="highlighter-rouge">default[:swift][:network][:proxy-bind-port]</code> - the port to bind to
on the proxy servers (defaults to 8080)</li>
  <li><code class="highlighter-rouge">default[:swift][:network][:account-bind-ip]</code> - the IP address to bind to
on the account servers (defaults to 0.0.0.0 for all addresses)</li>
  <li><code class="highlighter-rouge">default[:swift][:network][:account-bind-port]</code> - the port to bind to
on the account servers (defaults to 6002)</li>
  <li><code class="highlighter-rouge">default[:swift][:network][:container-bind-ip]</code> - the IP address to bind to
on the container servers (defaults to 0.0.0.0 for all addresses)</li>
  <li><code class="highlighter-rouge">default[:swift][:network][:container-bind-port]</code> - the port to bind to
on the container servers (defaults to 6002)</li>
  <li><code class="highlighter-rouge">default[:swift][:network][:object-bind-ip]</code> - the IP address to bind to
on the object servers (defaults to 0.0.0.0 for all addresses)</li>
  <li><code class="highlighter-rouge">default[:swift][:network][:object-bind-port]</code> - the port to bind to
on the container servers (defaults to 6002)</li>
  <li><code class="highlighter-rouge">default[:swift][:network][:object-cidr]</code> - the CIDR network for your object
servers in order to build the ring (defaults to 10.0.0.0/24)</li>
</ul>

<h1 id="proxy-plugins">Proxy Plugins</h1>

<h2 id="formpost">Formpost</h2>

<ul>
  <li><code class="highlighter-rouge">default[:swift][:formpost][:enabled]</code> - optionally enable the formpost proxy plugin (defaults to false)</li>
</ul>

<h2 id="tempurl">TempURL</h2>

<ul>
  <li><code class="highlighter-rouge">default[:swift][:tempurl][:enabled]</code> - optionally enable the tempurl proxy plugin (defaults to false)</li>
  <li><code class="highlighter-rouge">default[:swift][:tempurl][:incoming_remove_headers]</code> - The headers to remove from incoming requests (defaults to x-timestamp)</li>
  <li><code class="highlighter-rouge">default[:swift][:tempurl][:incoming_allow_headers]</code> - The headers allowed as exceptions to incoming_remove_headers (defaults to empty string)</li>
  <li><code class="highlighter-rouge">default[:swift][:tempurl][:incoming_allow_headers]</code> - The headers allowed as exceptions to incoming_remove_headers (defaults to empty string)</li>
  <li><code class="highlighter-rouge">default[:swift][:tempurl][:outgoing_remove_headers]</code> - The headers to remove from outgoing responses (defaults to x-object-meta-*)</li>
  <li><code class="highlighter-rouge">default[:swift][:tempurl][:outgoing_allow_headers]</code> - The headers allowed as exceptions to outgoing_remove_headers (defaults x-object-meta-public-*)</li>
</ul>

<h2 id="domain-remap">Domain Remap</h2>

<ul>
  <li><code class="highlighter-rouge">default[:swift][:domain_remap][:enabled]</code> - optionally enable the domain remap proxy plugin (defaults to false)</li>
  <li><code class="highlighter-rouge">default[:swift][:domain_remap][:storage_domain]</code> - The domain remap reseller domain (defaults to example.com)</li>
  <li><code class="highlighter-rouge">default[:swift][:domain_remap][:root_path]</code> - The domain remap root path (defaults to v1)</li>
  <li><code class="highlighter-rouge">default[:swift][:domain_remap][:reseller_prefixes]</code> - The domain remap reseller prefixes (defaults to AUTH)</li>
</ul>

<h2 id="staticweb">Staticweb</h2>

<ul>
  <li><code class="highlighter-rouge">default[:swift][:staticweb][:enabled]</code> - optionally enable the staticweb proxy plugin (defaults to false)</li>
  <li><code class="highlighter-rouge">default[:swift][:staticweb][:cache_timeout]</code> - Seconds to cache container x-container-meta-web-* header values (defaults to 300)</li>
</ul>

<h1 id="examples-2">Examples</h1>

<h2 id="example-environment">Example environment</h2>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"default_attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"swift"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"swift_hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"107c0568ea84"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"authmode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"swauth"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"authkey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"auto_rebuild_rings"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nt">"git_builder_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.0.0.10"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"swauth"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://10.0.0.10:8080/v1/"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"swift"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"chef_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"environment"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"json_class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Chef::Environment"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>This sets up defaults for a swauth-based cluster with the storage
network on 10.0.0.0/24.</p>

<h2 id="standalone-storage-server">Standalone Storage Server</h2>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"swift-object-server"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"json_class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Chef::Role"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"run_list"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"recipe[swift::object-server]"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A storage server role."</span><span class="p">,</span><span class="w">
  </span><span class="nt">"chef_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"role"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h2 id="standalone-proxy-server">Standalone Proxy Server</h2>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="w">  </span><span class="s2">"run_list"</span><span class="err">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"role[swift-proxy-server]"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span></code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-object-storage-attributes-default">cookbook-openstack-object-storage-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'service_tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'service_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'swift'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'service_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
</code></pre>
</div>

<p>Default swift user</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'swift'</span>
<span class="c1"># Default swift group</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'swift'</span>
<span class="c1"># Default region</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
</code></pre>
</div>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
"</span>
</code></pre>
</div>

<hr />
<p>node/ring settings
——————–</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'state'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c1"># Hour to run swift_auditor on storage nodes</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'audit_hour'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'5'</span>
<span class="c1">#  Eval-able expression that lists</span>
<span class="c1">#   candidate disk nodes for disk probing.  The result should be a hash</span>
<span class="c1">#   with keys being the device name (without the leading "/dev/") and a</span>
<span class="c1">#   hash block of any extra info associated with the device.  For</span>
<span class="c1">#   example: { "sdc" =&gt; { "model": "Hitachi 7K3000" }}.  Largely,</span>
<span class="c1">#   though, if you are going to make a list of valid devices, you</span>
<span class="c1">#   probably know all the valid devices, and don't need to pass any</span>
<span class="c1">#   metadata about them, so { "sdc" =&gt; {}} is probably enough.  Example</span>
<span class="c1">#   expression: Hash[('a'..'f').to_a.collect{|x| [ "sd{x}", {} ]}]</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'disk_enum_expr'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'node[:block_device]'</span>
<span class="c1"># Flag to rebuild rings</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'auto_rebuild_rings'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># ip for git builder</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'git_builder_ip'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="c1"># How many server changes require before a rebalance is done</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'wait_for'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre>
</div>

<p>swift_hash_path_suffix and swift_hash_path_prefix are used as part of the
the hashing algorithm when determining data placement in the cluster.
These values should remain secret and MUST NOT change
once a cluster has been deployed.
Deprecated in juno, use swift_hash_path_prefix</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swift_hash'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="c1"># A value of nil will get the hash from the get_password library method in common</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swift_hash_path_prefix'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swift_hash'</span><span class="p">]</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swift_hash_path_suffix'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>The swift-constraints section sets the basic constraints on data
saved in the swift cluster. These constraints are automatically
published by the proxy server in responses to /info requests.
max_file_size is the largest “normal” object that can be saved in
the cluster. This is also the limit on the size of each segment of
a “large” object when using the large object manifest support.
This value is set in bytes. Setting it to lower than 1MiB will cause
some tests to fail. It is STRONGLY recommended to leave this value at
the default (5 * 2**30 + 2).</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'max_file_size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5368709122</span>
<span class="c1"># max_meta_name_length is the max number of bytes in the utf8 encoding</span>
<span class="c1"># of the name portion of a metadata header.</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'max_meta_name_length'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">128</span>
<span class="c1"># max_meta_value_length is the max number of bytes in the utf8 encoding</span>
<span class="c1"># of a metadata value</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'max_meta_value_length'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">256</span>
<span class="c1"># max_meta_count is the max number of metadata keys that can be stored</span>
<span class="c1"># on a single account, container, or object</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'max_meta_count'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">90</span>
<span class="c1"># max_meta_overall_size is the max number of bytes in the utf8 encoding</span>
<span class="c1"># of the metadata (keys + values)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'max_meta_overall_size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4096</span>
<span class="c1"># max_header_size is the max number of bytes in the utf8 encoding of each</span>
<span class="c1"># header. Using 8192 as default because eventlet use 8192 as max size of</span>
<span class="c1"># header line. This value may need to be increased when using identity</span>
<span class="c1"># v3 API tokens including more than 7 catalog entries.</span>
<span class="c1"># See also include_service_catalog in proxy-server.conf-sample</span>
<span class="c1"># (documented in overview_auth.rst)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'max_header_size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8192</span>
<span class="c1"># max_object_name_length is the max number of bytes in the utf8 encoding</span>
<span class="c1"># of an object name</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'max_object_name_length'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="c1"># container_listing_limit is the default (and max) number of items</span>
<span class="c1"># returned for a container listing request</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container_listing_limit'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="c1"># account_listing_limit is the default (and max) number of items returned</span>
<span class="c1"># for an account listing request</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'account_listing_limit'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="c1"># max_account_name_length is the max number of bytes in the utf8 encoding</span>
<span class="c1"># of an account name</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'max_account_name_length'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">256</span>
<span class="c1"># max_container_name_length is the max number of bytes in the utf8 encoding</span>
<span class="c1"># of a container name</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'max_container_name_length'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">256</span>
</code></pre>
</div>

<p>Use the openstack-common cookbook databags with the
following keys:
secret tokens
“swift_hash_path_prefix”
“swift_hash_path_suffix”
“swift_authkey”
“dispersion_auth_key”
“dispersion_auth_user”
The follow swift specific databag support is DEPRECATED.
we support an optional secret databag where we will retrieve the
following attributes overriding any default attributes here</p>

<p>{
“swift_hash”: “107c0568ea84”
“swift_authkey”: “keW4all”
“dispersion_auth_user”: “test:test”,
“dispersion_auth_key”: “test”
}</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swift_secret_databag_name'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<hr />
<p>roles
——————–</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'setup_chef_role'</span><span class="p">]</span>             <span class="o">=</span> <span class="s1">'os-object-storage-setup'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'management_server_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-object-storage-management'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'proxy_server_chef_role'</span><span class="p">]</span>      <span class="o">=</span> <span class="s1">'os-object-storage-proxy'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'object_server_chef_role'</span><span class="p">]</span>     <span class="o">=</span> <span class="s1">'os-object-storage-object'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'account_server_chef_role'</span><span class="p">]</span>    <span class="o">=</span> <span class="s1">'os-object-storage-account'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container_server_chef_role'</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">'os-object-storage-container'</span>
</code></pre>
</div>

<hr />
<p>authentication
——————–
Authenitcation mode, either keystone or swauth</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'authmode'</span><span class="p">]</span>              <span class="o">=</span> <span class="s1">'keystone'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'authkey'</span><span class="p">]</span>               <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swift_url'</span><span class="p">]</span>             <span class="o">=</span> <span class="s1">'http://127.0.0.1:8080/v1/'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swauth_url'</span><span class="p">]</span>            <span class="o">=</span> <span class="s1">'http://127.0.0.1:8080/v1/'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'auth_url'</span><span class="p">]</span>              <span class="o">=</span> <span class="s1">'http://127.0.0.1:8080/auth/v1.0'</span>
<span class="c1"># Keystone version</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span>
<span class="c1"># Keystone PKI signing directory</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'cache_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/swift/api'</span>
</code></pre>
</div>

<hr />
<p>dispersion settings
———————</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'dispersion'</span><span class="p">][</span><span class="s1">'auth_user'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'dispersion'</span><span class="p">][</span><span class="s1">'auth_key'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>settings for the swift ring - these default settings are
a safe setting for testing but part_power should be set to
26 in production to allow a swift cluster with 50,000 spindles</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'ring'</span><span class="p">][</span><span class="s1">'part_power'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">18</span>
<span class="c1"># The minimum number of hours before swift is allowed to migrate a partition</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'ring'</span><span class="p">][</span><span class="s1">'min_part_hours'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1"># How many replicas swift should retain</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'ring'</span><span class="p">][</span><span class="s1">'replicas'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="c1"># Zone, will look like "z1" on swift-ring-builder command line</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'ring'</span><span class="p">][</span><span class="s1">'zone'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'1'</span>
<span class="c1"># Region, will look like "r1" on swift-ring-builder command line</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'ring'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'1'</span>
</code></pre>
</div>

<hr />
<p>statistics
——————
Current statsd cookbook is not supported on rhel platforms</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="n">platform_family?</span><span class="p">(</span><span class="s1">'debian'</span><span class="p">)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'sample_rate'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre>
</div>

<p>there are two ways to discover your graphite server ip for
statsd to periodically publish to.  You can directly set
the ip below, or leave it set to nil and supply chef with
the role name of your graphite server and the interface
name to retrieve the appropriate internal ip address from</p>

<p>if no servers with the role below can be found then
127.0.0.1 will be used</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'graphing_ip'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'graphing_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'graphite-role'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'graphing_interface'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'eth0'</span>
</code></pre>
</div>

<p>how frequently to run chef instantiated /usr/local/bin/swift_statsd_publish.py
which publishes dispersion and recon statistics (in minutes)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'report_frequency'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
</code></pre>
</div>

<p>enable or disable specific portions of generated report</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'enable_dispersion_report'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'enable_recon_report'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'enable_disk_report'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<p>settings for statsd which should be configured to use the local
statsd daemon that chef will install if statistics are enabled</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'statsd_host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'statsd_port'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'8125'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'statsd_prefix'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'openstack.swift'</span>
</code></pre>
</div>

<p>paths to the recon cache files</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'recon_account_cache'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/swift/account.recon'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'recon_container_cache'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/swift/container.recon'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'statistics'</span><span class="p">][</span><span class="s1">'recon_object_cache'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/swift/object.recon'</span>
</code></pre>
</div>

<hr />
<p>network settings
——————
the cidr configuration items are unimportant for a single server
configuration, but in a multi-server setup, the cidr should match
the interface appropriate to that service as they are used to
resolve the appropriate addresses to use for internode
communication
Deprecated in Juno, use Common attributes instead
proxy servers</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'proxy-bind-ip'</span><span class="p">]</span>            <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'proxy-bind-port'</span><span class="p">]</span>          <span class="o">=</span> <span class="kp">nil</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'proxy-cidr'</span><span class="p">]</span>               <span class="o">=</span> <span class="s1">'127.0.0.0/8'</span>
</code></pre>
</div>

<p>account servers</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'account-bind-ip'</span><span class="p">]</span>          <span class="o">=</span> <span class="s1">'0.0.0.0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'account-bind-port'</span><span class="p">]</span>        <span class="o">=</span> <span class="s1">'6002'</span>
</code></pre>
</div>

<p>container servers</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'container-bind-ip'</span><span class="p">]</span>        <span class="o">=</span> <span class="s1">'0.0.0.0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'container-bind-port'</span><span class="p">]</span>      <span class="o">=</span> <span class="s1">'6001'</span>
</code></pre>
</div>

<p>object servers</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'object-bind-ip'</span><span class="p">]</span>           <span class="o">=</span> <span class="s1">'0.0.0.0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'object-bind-port'</span><span class="p">]</span>         <span class="o">=</span> <span class="s1">'6000'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'network'</span><span class="p">][</span><span class="s1">'object-cidr'</span><span class="p">]</span>              <span class="o">=</span> <span class="s1">'127.0.0.0/8'</span>
</code></pre>
</div>

<hr />
<p>sysctl
——————
set sysctl properties for time waits</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'sysctl'</span><span class="p">][</span><span class="s1">'net.ipv4.tcp_tw_recycle'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'sysctl'</span><span class="p">][</span><span class="s1">'net.ipv4.tcp_tw_reuse'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'sysctl'</span><span class="p">][</span><span class="s1">'net.ipv4.tcp_syncookies'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre>
</div>

<p>N.B. conntrack_max may also need to be adjusted if
server is running a stateful firewall
——————
disk search
——————
disk_test_filter is an array of predicates to test against disks to
determine if a disk should be formatted and configured for swift.
Each predicate is evaluated in turn, and a false from the predicate
will result in the disk not being considered as a candidate for
formatting.
Each rule gets evaluated with “candidate” set to the device name
without the leading “/dev/”) and info set to the node hash value.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'disk_test_filter'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s1">'candidate =~ /(sd|hd|xvd|vd)(?!a$)[a-z]+/'</span><span class="p">,</span>
  <span class="s2">"File.exist?('/dev/' + candidate)"</span><span class="p">,</span>
  <span class="s2">"not system('/sbin/parted /dev/' + candidate + ' -s print | grep linux-swap')"</span><span class="p">,</span>
  <span class="s2">"not info.has_key?('removable') or info['removable'] == 0.to_s"</span><span class="p">]</span>
</code></pre>
</div>

<hr />
<p>template overrides
——————-
account-server
Use an integer to override the number of pre-forked processes that will
accept connections.  Zero means no fork. Should default to the number of
effective cpu cores in the system.  It’s worth noting that individual
workers will # use many eventlet co-routines to service multiple concurrent
requests.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'account-server'</span><span class="p">][</span><span class="s1">'workers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'auto'</span>
</code></pre>
</div>

<p>Maximum number of clients one worker can process simultaneously (it will
actually accept(2) N + 1). Setting this to one (1) will only handle one request
at a time, without accepting another request concurrently.  The default is 1024.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'account-server'</span><span class="p">][</span><span class="s1">'max_clients'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1024</span>
</code></pre>
</div>

<p>Parent directory or where devices are mounted. Default is /srv/node</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'account-server'</span><span class="p">][</span><span class="s1">'devices'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/srv/node'</span>
</code></pre>
</div>

<p>Whether or not check if the devices are mounted to prevent accidentally writing to
the root device. The default is set to true.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'account-server'</span><span class="p">][</span><span class="s1">'mount_check'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<p>proxy-server
Use an integer to override the number of pre-forked processes that will
accept connections.  Zero means no fork. Should default to the number of
effective cpu cores in the system.  It’s worth noting that individual
workers will # use many eventlet co-routines to service multiple concurrent
requests.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'proxy-server'</span><span class="p">][</span><span class="s1">'workers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'auto'</span>
</code></pre>
</div>

<p>Maximum number of clients one worker can process simultaneously (it will
actually accept(2) N + 1). Setting this to one (1) will only handle one request
at a time, without accepting another request concurrently.  The default is 1024.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'proxy-server'</span><span class="p">][</span><span class="s1">'max_clients'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1024</span>
</code></pre>
</div>

<p>Request timeout to external services. The default is 10 seconds.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'proxy-server'</span><span class="p">][</span><span class="s1">'node_timeout'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
</code></pre>
</div>

<p>enable or disable formpost</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'formpost'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>enable or disable tempurl</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'tempurl'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>The headers to remove from incoming requests. Simply a whitespace delimited
list of header names and names can optionally end with ‘*’ to indicate a
prefix match. incoming_allow_headers is a list of exceptions to these
removals.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'tempurl'</span><span class="p">][</span><span class="s1">'incoming_remove_headers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'x-timestamp'</span>
</code></pre>
</div>

<p>The headers allowed as exceptions to incoming_remove_headers. Simply a
whitespace delimited list of header names and names can optionally end with
‘*’ to indicate a prefix match.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'tempurl'</span><span class="p">][</span><span class="s1">'incoming_allow_headers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">''</span>
</code></pre>
</div>

<p>The headers to remove from outgoing responses. Simply a whitespace delimited
list of header names and names can optionally end with ‘*’ to indicate a
prefix match. outgoing_allow_headers is a list of exceptions to these
removals.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'tempurl'</span><span class="p">][</span><span class="s1">'outgoing_remove_headers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'x-object-meta-*'</span>
</code></pre>
</div>

<p>The headers allowed as exceptions to outgoing_remove_headers. Simply a
whitespace delimited list of header names and names can optionally end with
‘*’ to indicate a prefix match.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'tempurl'</span><span class="p">][</span><span class="s1">'outgoing_allow_headers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'x-object-meta-public-*'</span>
</code></pre>
</div>

<p>enable or disable domain_remap</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'domain_remap'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>enable domain log name</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'domain_remap'</span><span class="p">][</span><span class="s1">'log_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'domain_remap'</span>
</code></pre>
</div>

<p>domain remap log facilty</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'domain_remap'</span><span class="p">][</span><span class="s1">'log_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'LOG_LOCAL0'</span>
</code></pre>
</div>

<p>domain remap log level</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'domain_remap'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
</code></pre>
</div>

<p>domain remap log headers</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'domain_remap'</span><span class="p">][</span><span class="s1">'log_headers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'False'</span>
</code></pre>
</div>

<p>domain remap reseller domain</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'domain_remap'</span><span class="p">][</span><span class="s1">'storage_domain'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'example.com'</span>
</code></pre>
</div>

<p>domain remap root path</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'domain_remap'</span><span class="p">][</span><span class="s1">'path_root'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v1'</span>
</code></pre>
</div>

<p>domain remap reseller prefixes</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'domain_remap'</span><span class="p">][</span><span class="s1">'reseller_prefixes'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'AUTH'</span>
</code></pre>
</div>

<p>whether or not to enable staticweb in the swift proxy</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'staticweb'</span><span class="p">][</span><span class="s1">'enabled'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>Seconds to cache container x-container-meta-web-* header values.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'staticweb'</span><span class="p">][</span><span class="s1">'cache_timeout'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
</code></pre>
</div>

<p>staticweb logging options</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'staticweb'</span><span class="p">][</span><span class="s1">'log_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'LOG_LOCAL0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'staticweb'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'staticweb'</span><span class="p">][</span><span class="s1">'access_log_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'staticweb'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'staticweb'</span><span class="p">][</span><span class="s1">'access_log_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'LOG_LOCAL0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'staticweb'</span><span class="p">][</span><span class="s1">'access_log_level'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'staticweb'</span><span class="p">][</span><span class="s1">'log_headers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'False'</span>
</code></pre>
</div>

<p>container-server
Use an integer to override the number of pre-forked processes that will
accept connections.  Zero means no fork. Should default to the number of
effective cpu cores in the system.  It’s worth noting that individual
workers will # use many eventlet co-routines to service multiple concurrent
requests.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'workers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'auto'</span>
</code></pre>
</div>

<p>Maximum number of clients one worker can process simultaneously (it will
actually accept(2) N + 1). Setting this to one (1) will only handle one request
at a time, without accepting another request concurrently.  The default is 1024.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'max_clients'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1024</span>
</code></pre>
</div>

<p>Parent directory or where devices are mounted. Default is /srv/node</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'devices'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/srv/node'</span>
</code></pre>
</div>

<p>Whether or not check if the devices are mounted to prevent accidentally writing to
the root device. The default is set to true.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'mount_check'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<p>Override this with an allowed list of your various swift clusters if you wish
to enable container sync for your end-users between clusters.  This should
be an array of fqdn hostnames for the cluster end-points that your end-users
would access in the format of [‘host1’, ‘host2’, ‘host3’]</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'allowed_sync_hosts'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre>
</div>

<p>container-sync logging settings</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'container-sync'</span><span class="p">][</span><span class="s1">'log_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'container-sync'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'container-sync'</span><span class="p">][</span><span class="s1">'log_facility'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'LOG_LOCAL0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'container-sync'</span><span class="p">][</span><span class="s1">'log_level'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'INFO'</span>
</code></pre>
</div>

<p>If you need to use an HTTP Proxy, set it here; defaults to no proxy.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'container-sync'</span><span class="p">][</span><span class="s1">'sync_proxy'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Will sync, at most, each container once per interval (in seconds)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'container-sync'</span><span class="p">][</span><span class="s1">'interval'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
</code></pre>
</div>

<p>Maximum amount of time to spend syncing each container per pass (in seconds)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'container-server'</span><span class="p">][</span><span class="s1">'container-sync'</span><span class="p">][</span><span class="s1">'container_time'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">60</span>
</code></pre>
</div>

<p>object-server
Use an integer to override the number of pre-forked processes that will
accept connections.  Zero means no fork. Should default to the number of
effective cpu cores in the system.  It’s worth noting that individual
workers will # use many eventlet co-routines to service multiple concurrent
requests.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'object-server'</span><span class="p">][</span><span class="s1">'workers'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'auto'</span>
</code></pre>
</div>

<p>Maximum number of clients one worker can process simultaneously (it will
actually accept(2) N + 1). Setting this to one (1) will only handle one request
at a time, without accepting another request concurrently.  The default is 1024.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'object-server'</span><span class="p">][</span><span class="s1">'max_clients'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1024</span>
</code></pre>
</div>

<p>Parent directory or where devices are mounted. Default is /srv/node</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'object-server'</span><span class="p">][</span><span class="s1">'devices'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/srv/node'</span>
</code></pre>
</div>

<p>Whether or not check if the devices are mounted to prevent accidentally writing to
the root device. The default is set to true.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'object-server'</span><span class="p">][</span><span class="s1">'mount_check'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<p>Time in seconds to wait between replication passes. The default is 30.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'object-server'</span><span class="p">][</span><span class="s1">'replicator'</span><span class="p">][</span><span class="s1">'run_pause'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>
</code></pre>
</div>

<p>Time elapsed in seconds before an object can be reclaimed. The default is
604800 seconds.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'object-server'</span><span class="p">][</span><span class="s1">'replicator'</span><span class="p">][</span><span class="s1">'reclaim_age'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">604800</span>
</code></pre>
</div>

<hr />
<p>swauth source
—————–
Versions of swauth in Ubuntu Cloud Archive PPA can be outdated. This
allows us to chose to install directly from a tagged branch of
gholt’s repository.
values:  package, git</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swauth_source'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'package'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swauth_repository'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'https://github.com/gholt/swauth.git'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'swauth_version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'1.0.8'</span>
</code></pre>
</div>

<hr />
<p>packages
——————
Leveling between distros</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform_family</span>
<span class="k">when</span> <span class="s1">'rhel'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'disk_format'</span> <span class="o">=&gt;</span> <span class="s1">'ext4'</span><span class="p">,</span>
    <span class="s1">'proxy_packages'</span> <span class="o">=&gt;</span> <span class="sx">%w(openstack-swift-proxy sudo cronie python-memcached)</span><span class="p">,</span>
    <span class="s1">'object_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-swift-object'</span><span class="p">,</span> <span class="s1">'sudo'</span><span class="p">,</span> <span class="s1">'cronie'</span><span class="p">],</span>
    <span class="s1">'container_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-swift-container'</span><span class="p">,</span> <span class="s1">'sudo'</span><span class="p">,</span> <span class="s1">'cronie'</span><span class="p">],</span>
    <span class="s1">'account_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-swift-account'</span><span class="p">,</span> <span class="s1">'sudo'</span><span class="p">,</span> <span class="s1">'cronie'</span><span class="p">],</span>
    <span class="s1">'swift_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-swift'</span><span class="p">,</span> <span class="s1">'sudo'</span><span class="p">,</span> <span class="s1">'cronie'</span><span class="p">],</span>
    <span class="s1">'swift_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-swiftclient'</span><span class="p">],</span>
    <span class="s1">'swauth_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-swauth'</span><span class="p">,</span> <span class="s1">'sudo'</span><span class="p">,</span> <span class="s1">'cronie'</span><span class="p">],</span>
    <span class="s1">'rsync_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'rsync'</span><span class="p">],</span>
    <span class="s1">'git_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'xinetd'</span><span class="p">,</span> <span class="s1">'git'</span><span class="p">,</span> <span class="s1">'git-daemon'</span><span class="p">],</span>
    <span class="s1">'service_prefix'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-'</span><span class="p">,</span>
    <span class="s1">'service_suffix'</span> <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,</span>
    <span class="s1">'git_dir'</span> <span class="o">=&gt;</span> <span class="s1">'/var/lib/git'</span><span class="p">,</span>
    <span class="s1">'git_service'</span> <span class="o">=&gt;</span> <span class="s1">'git'</span><span class="p">,</span>
    <span class="s1">'override_options'</span> <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,</span>
    <span class="s1">'swift_statsd_publish'</span> <span class="o">=&gt;</span> <span class="s1">'/usr/bin/swift-statsd-publish.py'</span>
  <span class="p">}</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'object-storage'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'disk_format'</span> <span class="o">=&gt;</span> <span class="s1">'xfs'</span><span class="p">,</span>
    <span class="s1">'proxy_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'swift-proxy'</span><span class="p">,</span> <span class="s1">'python-memcache'</span><span class="p">],</span>
    <span class="s1">'object_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'swift-object'</span><span class="p">],</span>
    <span class="s1">'container_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'swift-container'</span><span class="p">],</span>
    <span class="s1">'account_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'swift-account'</span><span class="p">,</span> <span class="s1">'python-swiftclient'</span><span class="p">],</span>
    <span class="s1">'swift_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'swift'</span><span class="p">],</span>
    <span class="s1">'swift_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-swiftclient'</span><span class="p">],</span>
    <span class="s1">'swauth_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'swauth'</span><span class="p">],</span>
    <span class="s1">'rsync_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'rsync'</span><span class="p">],</span>
    <span class="s1">'git_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'git-daemon-sysvinit'</span><span class="p">],</span>
    <span class="s1">'service_prefix'</span> <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,</span>
    <span class="s1">'service_suffix'</span> <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,</span>
    <span class="s1">'git_dir'</span> <span class="o">=&gt;</span> <span class="s1">'/var/cache/git'</span><span class="p">,</span>
    <span class="s1">'git_service'</span> <span class="o">=&gt;</span> <span class="s1">'git-daemon'</span><span class="p">,</span>
    <span class="s1">'override_options'</span> <span class="o">=&gt;</span> <span class="s2">"-o Dpkg::Options:='--force-confold' -o Dpkg::Option:='--force-confdef'"</span><span class="p">,</span>
    <span class="s1">'swift_statsd_publish'</span> <span class="o">=&gt;</span> <span class="s1">'/usr/local/bin/swift-statsd-publish.py'</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-ops-database">cookbook-openstack-ops-database</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-ops-database-readme">cookbook-openstack-ops-database-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-10">Description</h1>

<p>This cookbook provides a reference example of database configuration for the OpenStack deployment provided by Chef for OpenStack. It currently supports MySQL and PostgreSQL.</p>

<h1 id="requirements-11">Requirements</h1>

<p>Chef 11 with Ruby 1.9.x required.</p>

<h1 id="platforms">Platforms</h1>

<ul>
  <li>Ubuntu-14.04</li>
  <li>SLES 11 SP3</li>
  <li>RHEL/CentOS 7.0</li>
</ul>

<h1 id="cookbooks-8">Cookbooks</h1>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>database</li>
  <li>openstack-common</li>
  <li>mysql</li>
  <li>mysql2_chef_gem</li>
  <li>postgresql</li>
</ul>

<h1 id="usage-10">Usage</h1>

<p>The usage of this cookbook is optional, you may choose to set up your own databases without using this cookbook. If you choose to do so, you will need to do the following:</p>

<ul>
  <li>create the schema specified by the <code class="highlighter-rouge">openstack-db</code> recipe.</li>
  <li>create and upload encrypted data bags into your chef environment, as
specified by <code class="highlighter-rouge">#get_password</code> in the <code class="highlighter-rouge">openstack-db</code> recipe.</li>
</ul>

<h1 id="resourcesproviders-1">Resources/Providers</h1>

<p>None</p>

<h1 id="templates-1">Templates</h1>

<p>None</p>

<h1 id="recipes-3">Recipes</h1>

<h2 id="client-7">client</h2>

<ul>
  <li>database client configuration, selected by attributes</li>
</ul>

<h2 id="server-2">server</h2>

<ul>
  <li>database server configuration, selected by attributes</li>
</ul>

<h2 id="mysql-client">mysql-client</h2>

<ul>
  <li>calls mysql::ruby and mysql::client and installs the mysql client python packages</li>
</ul>

<h2 id="mysql-server">mysql-server</h2>

<ul>
  <li>configures the mysql server for OpenStack</li>
</ul>

<h2 id="postgresql-client">postgresql-client</h2>

<ul>
  <li>calls postgresql::ruby and postgresql::client and installs the postgresql client python packages</li>
</ul>

<h2 id="postgresql-server">postgresql-server</h2>

<ul>
  <li>configures the PostgreSQL server for OpenStack</li>
</ul>

<h2 id="openstack-db">openstack-db</h2>

<ul>
  <li>creates necessary tables, users, and grants for OpenStack</li>
</ul>

<h1 id="attributes-11">Attributes</h1>

<p>The following attributes are defined in attributes/database.rb of the common cookbook, but are documented here due to their relevance:</p>

<ul>
  <li><code class="highlighter-rouge">openstack["endpoints"]["db"]["host"]</code> - The IP address to bind the database service to</li>
  <li><code class="highlighter-rouge">openstack["endpoints"]["db"]["scheme"]</code> - Unused at this time</li>
  <li><code class="highlighter-rouge">openstack["endpoints"]["db"]["port"]</code> - The port to bind the database service to</li>
  <li><code class="highlighter-rouge">openstack["endpoints"]["db"]["path"]</code> - Unused at this time</li>
  <li><code class="highlighter-rouge">openstack["endpoints"]["db"]["bind_interface"]</code> - The interface name to bind the database service to</li>
  <li><code class="highlighter-rouge">openstack["db"]["root_user_key"]</code> - The key used to retrieve the root user password; the key is both the name of the data-bag item and
name of the key containing the password value within the data-bag item. This is defined in Common.</li>
</ul>

<p>If the value of the “bind_interface” attribute is non-nil, then the database service will be bound to the first IP address on that interface.  If the value of the “bind_interface” attribute is nil, then the database service will be bound to the IP address specified in the host attribute.</p>

<p>See the attributes mysql.rb file for the mysql specific attributes that are available.</p>

<p>For more information see: http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html</p>

<hr />

<h3 id="cookbook-openstack-ops-database-attributes-default">cookbook-openstack-ops-database-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'db'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'
# This file autogenerated by Chef
# Do not edit, changes will be overwritten
'</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-ops-database-attributes-mysql">cookbook-openstack-ops-database-attributes-mysql</h3>

<p><a href="#contents">back to top</a></p>

<p>MySql attributes that we use the mysql cookbook defaults:
Data directory</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'data_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>MySql attributes that we select defaults for:
Version, support 5.5 and above</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'5.5'</span>
<span class="c1"># Service name</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'service_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'default'</span>
<span class="c1"># Storage engine, base OpenStack requires the InnoDB flavor</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'default-storage-engine'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'InnoDB'</span>
<span class="c1"># InnoDB lock mode for generating auto-increment values</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'innodb_autoinc_lock_mode'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'1'</span>
<span class="c1"># InnoDB give each table its own file</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'innodb_file_per_table'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'OFF'</span>
<span class="c1"># InnoDB thread concurrency</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'innodb_thread_concurrency'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'0'</span>
<span class="c1"># InnoDB commit concurrency</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'innodb_commit_concurrency'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'0'</span>
<span class="c1"># InnoDB number of read io threads</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'innodb_read_io_threads'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'4'</span>
<span class="c1"># InnoDB number of commit transactions to flush log</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'innodb_flush_log_at_trx_commit'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'1'</span>
<span class="c1"># InnoDB memory buffer for caching table data and indexes</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'innodb_buffer_pool_size'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'134217728'</span>
<span class="c1"># InnoDB size of each log file in a log group</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'innodb_log_file_size'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'5242880'</span>
<span class="c1"># InnoDB size of buffer for logs</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'innodb_log_buffer_size'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'8388608'</span>
<span class="c1"># Skip name resolution</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'skip-name-resolve'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># Character set</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'character-set-server'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'latin1'</span>
<span class="c1"># Memory allocated for caching query results</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'query_cache_size'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'0'</span>
<span class="c1"># Maximum number of connections</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mysql'</span><span class="p">][</span><span class="s1">'max_connections'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'151'</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-ops-messaging">cookbook-openstack-ops-messaging</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-ops-messaging-readme">cookbook-openstack-ops-messaging-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-11">Description</h1>

<p>This cookbook provides shared message queue configuration for the OpenStack deployment provided by Chef for OpenStack. The http://github.com/mattray/chef-openstack-repo contains documentation for using this cookbook in the context of a full OpenStack deployment. It currently supports RabbitMQ and will soon other queues.</p>

<h1 id="requirements-12">Requirements</h1>

<p>Chef 11 with Ruby 1.9.x required.</p>

<h1 id="platforms-1">Platforms</h1>

<ul>
  <li>Ubuntu-14.04</li>
</ul>

<h1 id="cookbooks-9">Cookbooks</h1>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>openstack-common</li>
  <li>rabbitmq</li>
</ul>

<h1 id="usage-11">Usage</h1>

<p>The usage of this cookbook is optional, you may choose to set up your own messaging service without using this cookbook. If you choose to do so, you will need to provide all of the attributes listed under the <a href="#attributes">Attributes</a>.</p>

<h1 id="resourcesproviders-2">Resources/Providers</h1>

<p>None</p>

<h1 id="templates-2">Templates</h1>

<p>None</p>

<h1 id="recipes-4">Recipes</h1>

<h2 id="server-3">server</h2>

<ul>
  <li>message queue server configuration, selected by attributes</li>
</ul>

<h2 id="rabbitmq-server">rabbitmq-server</h2>

<ul>
  <li>configures the RabbitMQ server for OpenStack</li>
</ul>

<h1 id="attributes-12">Attributes</h1>

<ul>
  <li><code class="highlighter-rouge">openstack["mq"]["cluster"]</code> - whether or not to cluster rabbit, defaults to ‘false’</li>
</ul>

<p>The following attributes are defined in attributes/messaging.rb of the common cookbook, but are documented here due to their relevance:</p>

<ul>
  <li><code class="highlighter-rouge">openstack["endpoints"]["mq"]["host"]</code> - The IP address to bind the rabbit service to</li>
  <li><code class="highlighter-rouge">openstack["endpoints"]["mq"]["scheme"]</code> - Unused at this time</li>
  <li><code class="highlighter-rouge">openstack["endpoints"]["mq"]["port"]</code> - The port to bind the rabbit service to</li>
  <li><code class="highlighter-rouge">openstack["endpoints"]["mq"]["path"]</code> - Unused at this time</li>
  <li><code class="highlighter-rouge">openstack["endpoints"]["mq"]["bind_interface"]</code> - The interface name to bind the rabbit service to</li>
  <li><code class="highlighter-rouge">openstack["mq"]["rabbitmq"]["use_ssl"]</code> - Enables/disables SSL for RabbitMQ, the default is false.</li>
</ul>

<p>If the value of the “bind_interface” attribute is non-nil, then the rabbit service will be bound to the first IP address on that interface.  If the value of the “bind_interface” attribute is nil, then the rabbit service will be bound to the IP address specified in the host attribute.</p>

<hr />

<h3 id="cookbook-openstack-ops-messaging-attributes-default">cookbook-openstack-ops-messaging-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'cluster'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<p>Allow cluster_disk_nodes to be optionally set based upon a node role search.
If set to false, mq cluster nodes can be added on-the-fly using the cluster command.
see https://www.rabbitmq.com/clustering.html</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'mq'</span><span class="p">][</span><span class="s1">'search_for_cluster_disk_nodes'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">if</span> <span class="n">platform_family?</span><span class="p">(</span><span class="s1">'debian'</span><span class="p">,</span> <span class="s1">'suse'</span><span class="p">)</span>
  <span class="n">override</span><span class="p">[</span><span class="s1">'rabbitmq'</span><span class="p">][</span><span class="s1">'use_distro_version'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-orchestration">cookbook-openstack-orchestration</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-orchestration-readme">cookbook-openstack-orchestration-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-12">Description</h1>

<p>This cookbook installs the OpenStack Heat service <strong>Heat</strong> as part of an OpenStack reference deployment Chef for OpenStack.</p>

<p>https://wiki.openstack.org/wiki/Heat</p>

<h1 id="requirements-13">Requirements</h1>

<p>Chef 11 or higher required (for Chef environment use).</p>

<h2 id="cookbooks-10">Cookbooks</h2>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>openstack-common</li>
  <li>openstack-identity</li>
</ul>

<h1 id="usage-12">Usage</h1>

<h2 id="api-3">api</h2>
<ul>
  <li>Configure and start heat-api service</li>
</ul>

<h2 id="api-cfn">api-cfn</h2>
<ul>
  <li>Configure and start heat-api-cfn service</li>
</ul>

<h2 id="api-cloudwatch">api-cloudwatch</h2>
<ul>
  <li>Configure and start heat-api-cloudwatch service</li>
</ul>

<h2 id="client-8">client</h2>
<ul>
  <li>Install the heat client packages</li>
</ul>

<h2 id="common">common</h2>
<ul>
  <li>Installs the heat packages and setup configuration for Heat.</li>
</ul>

<h2 id="engine">engine</h2>
<ul>
  <li>Setup the heat database and start heat-engine service</li>
</ul>

<h2 id="identityregistration-1">identity_registration</h2>
<ul>
  <li>Registers the Heat API endpoint, heat service and user</li>
</ul>

<h1 id="attributes-13">Attributes</h1>

<p>Attributes for the Heat service are in the [‘openstack’][‘orchestration’] namespace.</p>

<ul>
  <li><code class="highlighter-rouge">openstack['orchestration']['identity_service_chef_role']</code> - The name of the Chef role that installs the Keystone Service API</li>
  <li><code class="highlighter-rouge">openstack['orchestration']['rabbit_server_chef_role']</code> - The name of the Chef role that knows about the message queue server</li>
  <li><code class="highlighter-rouge">openstack['orchestration']['user']</code> - User heat runs as</li>
  <li><code class="highlighter-rouge">openstack['orchestration']['group']</code> - Group heat runs as</li>
  <li><code class="highlighter-rouge">openstack['db']['orchestration']['username']</code> - Username for heat database access</li>
  <li><code class="highlighter-rouge">openstack['orchestration']['service_role']</code> - User role used by heat when interacting with keystone, defaults to ‘service’. Used in the API and registry paste.ini files</li>
  <li><code class="highlighter-rouge">openstack['orchestration']['syslog']['use']</code> - Should heat log to syslog?</li>
  <li><code class="highlighter-rouge">openstack['orchestration']['platform']</code> - hash of platform specific package/service names and options</li>
  <li><code class="highlighter-rouge">openstack['orchestration']['api']['auth']['version']</code> - Select v2.0 or v3.0. Default v2.0. The auth API version used to interact with the identity service.</li>
</ul>

<p>TODO: update this section adding new attributes</p>

<h2 id="mq-attributes-4">MQ attributes</h2>

<p>TODO: update this section with the new attributes</p>

<h2 id="service-bindings">Service bindings</h2>

<ul>
  <li><code class="highlighter-rouge">openstack['bind_service']['all']['orchestration-api']['host']</code> - The IP address to bind the service to</li>
  <li><code class="highlighter-rouge">openstack['bind_service']['all']['orchestration-api']['port']</code> - The port to bind the service to</li>
  <li>
    <p><code class="highlighter-rouge">openstack['bind_service']['all']['orchestration-api']['interface']</code> - The interface to bind the service to</p>
  </li>
  <li><code class="highlighter-rouge">openstack['bind_service']['all']['orchestration-api-cfn']['host']</code> - The IP address to bind the service to</li>
  <li><code class="highlighter-rouge">openstack['bind_service']['all']['orchestration-api-cfn']['port']</code> - The port to bind the service to</li>
  <li>
    <p><code class="highlighter-rouge">openstack['bind_service']['all']['orchestration-api-cfn']['interface']</code> - The interface to bind the service to</p>
  </li>
  <li><code class="highlighter-rouge">openstack['bind_service']['all']['orchestration-api-cloudwatch']['host']</code> - The IP address to bind the service to</li>
  <li><code class="highlighter-rouge">openstack['bind_service']['all']['orchestration-api-cloudwatch']['port']</code> - The port to bind the service to</li>
  <li><code class="highlighter-rouge">openstack['bind_service']['all']['orchestration-api-cloudwatch']['interface']</code> - The interface to bind the service to</li>
</ul>

<p>If the value of the ‘interface’ attribute is non-nil, then the service will be bound to the first IP address on that interface and
the ‘host’ attribute will be ignored. 
If the value of the ‘interface’ attribute is nil (which is the default), then the service will be bound to the IP address specified
in the ‘host’ attribute.</p>

<h2 id="miscellaneous-options-1">Miscellaneous Options</h2>

<ul>
  <li><code class="highlighter-rouge">orchestration_auth_encryption_key</code> - Key used to encrypt authentication info in the database. Length of this key must be 16, 24 or 32 characters. Comes from secrets databag.</li>
</ul>

<hr />

<h3 id="cookbook-openstack-orchestration-attributes-default">cookbook-openstack-orchestration-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="sx">%w(public internal admin)</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">ep_type</span><span class="o">|</span>
  <span class="c1"># openstack orchestration-api service endpoints (used by users and services)</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api'</span><span class="p">][</span><span class="s1">'scheme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/v1/%(tenant_id)s'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8004</span>
  <span class="c1"># openstack orchestration-api-cfn service endpoints (used by users and services)</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api-cfn'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api-cfn'</span><span class="p">][</span><span class="s1">'scheme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api-cfn'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/v1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api-cfn'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8000</span>
  <span class="c1"># openstack orchestration-api-cloudwatch service endpoints (used by users and services)</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api-cloudwatch'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api-cloudwatch'</span><span class="p">][</span><span class="s1">'scheme'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api-cloudwatch'</span><span class="p">][</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/v1'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'endpoints'</span><span class="p">][</span><span class="n">ep_type</span><span class="p">][</span><span class="s1">'orchestration-api-cloudwatch'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8003</span>
<span class="k">end</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'orchestration-api'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'orchestration-api'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8004</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'orchestration-api-cfn'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'orchestration-api-cfn'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'orchestration-api-cloudwatch'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'bind_service'</span><span class="p">][</span><span class="s1">'all'</span><span class="p">][</span><span class="s1">'orchestration-api-cloudwatch'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8003</span>
</code></pre>
</div>

<p>Set to some text value if you want templated config files
to contain a custom banner at the top of the written file</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'custom_template_banner'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'
# This file was autogenerated by Chef
# Do not edit, changes will be overwritten
'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span>
</code></pre>
</div>

<p>This is the name of the Chef role that will install the Keystone Service API</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'identity_service_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-identity'</span>
</code></pre>
</div>

<p>The name of the Chef role that knows about the message queue server
that Heat uses</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'rabbit_server_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-ops-messaging'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'service_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'ec2authtoken'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2.0'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span>
</code></pre>
</div>

<p>platform-specific settings</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform_family</span>
<span class="k">when</span> <span class="s1">'rhel'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'heat'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'heat'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'heat_common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-heat-common'</span><span class="p">],</span>
    <span class="s1">'heat_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-heatclient'</span><span class="p">],</span>
    <span class="s1">'heat_api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-heat-api'</span><span class="p">,</span> <span class="s1">'python-heatclient'</span><span class="p">],</span>
    <span class="s1">'heat_api_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-heat-api'</span><span class="p">,</span>
    <span class="s1">'heat_api_cfn_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-heat-api-cfn'</span><span class="p">,</span> <span class="s1">'python-heatclient'</span><span class="p">],</span>
    <span class="s1">'heat_api_cfn_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-heat-api-cfn'</span><span class="p">,</span>
    <span class="s1">'heat_api_cloudwatch_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-heat-api-cloudwatch'</span><span class="p">,</span> <span class="s1">'python-heatclient'</span><span class="p">],</span>
    <span class="s1">'heat_api_cloudwatch_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-heat-api-cloudwatch'</span><span class="p">,</span>
    <span class="s1">'heat_engine_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-heat-engine'</span><span class="p">],</span>
    <span class="s1">'heat_engine_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-heat-engine'</span><span class="p">,</span>
    <span class="s1">'heat_api_process_name'</span> <span class="o">=&gt;</span> <span class="s1">'heat-api'</span><span class="p">,</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
<span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'heat'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'heat'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'heat_common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'heat-common'</span><span class="p">],</span>
    <span class="s1">'heat_client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-heatclient'</span><span class="p">],</span>
    <span class="s1">'heat_api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'heat-api'</span><span class="p">,</span> <span class="s1">'python-heatclient'</span><span class="p">],</span>
    <span class="s1">'heat_api_service'</span> <span class="o">=&gt;</span> <span class="s1">'heat-api'</span><span class="p">,</span>
    <span class="s1">'heat_api_cfn_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'heat-api-cfn'</span><span class="p">,</span> <span class="s1">'python-heatclient'</span><span class="p">],</span>
    <span class="s1">'heat_api_cfn_service'</span> <span class="o">=&gt;</span> <span class="s1">'heat-api-cfn'</span><span class="p">,</span>
    <span class="s1">'heat_api_cloudwatch_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'heat-api-cloudwatch'</span><span class="p">,</span> <span class="s1">'python-heatclient'</span><span class="p">],</span>
    <span class="s1">'heat_api_cloudwatch_service'</span> <span class="o">=&gt;</span> <span class="s1">'heat-api-cloudwatch'</span><span class="p">,</span>
    <span class="s1">'heat_engine_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'heat-engine'</span><span class="p">],</span>
    <span class="s1">'heat_engine_service'</span> <span class="o">=&gt;</span> <span class="s1">'heat-engine'</span><span class="p">,</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s2">"-o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef'"</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<hr />

<h3 id="cookbook-openstack-orchestration-attributes-heatconf">cookbook-openstack-orchestration-attributes-heat_conf</h3>

<p><a href="#contents">back to top</a></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'log_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/log/heat'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'DEFAULT'</span><span class="p">][</span><span class="s1">'notification_driver'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'heat.openstack.common.notifier.rpc_notifier'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'auth_plugin'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'heat'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'keystone_authtoken'</span><span class="p">][</span><span class="s1">'tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'trustee'</span><span class="p">][</span><span class="s1">'auth_plugin'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'v2password'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'orchestration'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">][</span><span class="s1">'trustee'</span><span class="p">][</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'heat'</span>
</code></pre>
</div>

<hr />

<h2 id="cookbook-openstack-telemetry">cookbook-openstack-telemetry</h2>

<p><a href="#contents">back to top</a></p>

<hr />

<h3 id="cookbook-openstack-telemetry-readme">cookbook-openstack-telemetry-README</h3>

<p><a href="#contents">back to top</a></p>

<h1 id="description-13">Description</h1>

<p>Installs the OpenStack Metering service <strong>Ceilometer</strong> as part of the OpenStack
reference deployment Chef for OpenStack.  Ceilometer is currently installed
from packages.</p>

<p>https://wiki.openstack.org/wiki/Ceilometer</p>

<h1 id="requirements-14">Requirements</h1>

<h2 id="cookbooks-11">Cookbooks</h2>

<p>The following cookbooks are dependencies:</p>

<ul>
  <li>openstack-common</li>
  <li>openstack-identity</li>
  <li>openstack-compute</li>
</ul>

<h1 id="usage-13">Usage</h1>

<h2 id="agent-central">agent-central</h2>
<ul>
  <li>Installs agent central service.</li>
</ul>

<h2 id="agent-compute">agent-compute</h2>
<ul>
  <li>Installs agent compute service.</li>
</ul>

<h2 id="agent-notification">agent-notification</h2>
<ul>
  <li>Installs agent notification service.</li>
</ul>

<h2 id="alarm-evaluator">alarm-evaluator</h2>
<ul>
  <li>Installs alarm evaluator service.</li>
</ul>

<h2 id="alarm-notifier">alarm-notifier</h2>
<ul>
  <li>Installs alarm notifier service.</li>
</ul>

<h2 id="api-4">api</h2>
<ul>
  <li>Installs API service.</li>
</ul>

<h2 id="client-9">client</h2>
<ul>
  <li>Install the client packages</li>
</ul>

<h2 id="collector">collector</h2>
<ul>
  <li>Installs collector package and service. If the NoSQL database is used for metering service, ceilometer-dbsync will not be executed.</li>
</ul>

<h2 id="common-1">common</h2>
<ul>
  <li>Common metering configuration.</li>
</ul>

<h2 id="identityregistration-2">identity_registration</h2>
<ul>
  <li>Registers the endpoints, tenant and user for metering service with Keystone.</li>
</ul>

<h1 id="attributes-14">Attributes</h1>

<ul>
  <li><code class="highlighter-rouge">openstack['telemetry']['api']['auth']['version']</code> - Select v2.0 or v3.0. Default v2.0. The auth API version used to interact with identity service.</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['sample_source']</code> -  The source name of emitted samples, default value is openstack.</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['api']['auth']['memcached_servers']</code> - A list of memcached server(s) to use for caching</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['api']['auth']['memcache_security_strategy']</code> - Whether token data should be authenticated or authenticated and encrypted. Acceptable values are MAC or ENCRYPT</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['api']['auth']['memcache_secret_key']</code> - This string is used for key derivation</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['api']['auth']['hash_algorithms']</code> - Hash algorithms to use for hashing PKI tokens</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['api']['auth']['cafile']</code> - A PEM encoded Certificate Authority to use when verifying HTTPs connections</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['api']['auth']['insecure']</code> - Set whether to verify HTTPS connections</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['service-credentials']['cafile']</code> - A PEM encoded Certificate Authority to use when verifying HTTPs connections (for service polling authentication)</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['service-credentials']['insecure']</code> - Set whether to verify HTTPS connections (for service polling authentication)</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['dbsync_timeout']</code> - Set dbsync command timeout value</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['database']['time_to_live']</code> - Set a time_to_live parameter (ttl) for samples. Set -1 for no expiry</li>
  <li><code class="highlighter-rouge">openstack['telemetry']['notification']['store_events']</code> - Set a store_events parameter for notification service</li>
</ul>

<p>The following attributes are defined in attributes/default.rb of the common cookbook, but are documented here due to their relevance:</p>

<ul>
  <li><code class="highlighter-rouge">openstack['endpoints']['telemetry-api-bind']['host']</code> - The IP address to bind the api service to</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['telemetry-api-bind']['port']</code> - The port to bind the api service to</li>
  <li><code class="highlighter-rouge">openstack['endpoints']['telemetry-api-bind']['bind_interface']</code> - The interface name to bind the api service to</li>
</ul>

<p>If the value of the ‘bind_interface’ attribute is non-nil, then the telemetry service will be bound to the first IP address on that interface.  If the value of the ‘bind_interface’ attribute is nil, then the telemetry service will be bound to the IP address specifie</p>

<hr />

<h3 id="cookbook-openstack-telemetry-attributes-default">cookbook-openstack-telemetry-attributes-default</h3>

<p><a href="#contents">back to top</a></p>

<p>The name of the Chef role that knows about the message queue server
that Nova uses</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'rabbit_server_chef_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'os-ops-messaging'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'conf_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/etc/ceilometer'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'conf'</span><span class="p">]</span> <span class="o">=</span> <span class="o">::</span><span class="no">File</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'conf_dir'</span><span class="p">],</span> <span class="s1">'ceilometer.conf'</span><span class="p">)</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'periodic_interval'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">600</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'syslog'</span><span class="p">][</span><span class="s1">'use'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'verbose'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'true'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'debug'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'false'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'cache_dir'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/var/cache/ceilometer/api'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'version'</span><span class="p">]</span>
</code></pre>
</div>

<p>A list of memcached server(s) to use for caching</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'memcached_servers'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Whether token data should be authenticated or authenticated and encrypted. Acceptable values are MAC or ENCRYPT</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'memcache_security_strategy'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>This string is used for key derivation</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'memcache_secret_key'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Hash algorithms to use for hashing PKI tokens</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'hash_algorithms'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'md5'</span>
</code></pre>
</div>

<p>A PEM encoded Certificate Authority to use when verifying HTTPs connections</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'cafile'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Verify HTTPS connections</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'api'</span><span class="p">][</span><span class="s1">'auth'</span><span class="p">][</span><span class="s1">'insecure'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ceilometer'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'group'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ceilometer'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'region'</span><span class="p">]</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'service_user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'ceilometer'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'service_tenant_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'service'</span>
<span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'service_role'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span>
</code></pre>
</div>

<p>A PEM encoded Certificate Authority to use when verifying HTTPs connections (for service polling authentication)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'service-credentials'</span><span class="p">][</span><span class="s1">'cafile'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Verify HTTPS connections (for service polling authentication)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'service-credentials'</span><span class="p">][</span><span class="s1">'insecure'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'sample_source'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'openstack'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'dbsync_timeout'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3600</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">node</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'compute'</span><span class="p">][</span><span class="s1">'driver'</span><span class="p">]</span>
<span class="k">when</span> <span class="s1">'libvirt.LibvirtDriver'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'hypervisor_inspector'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'libvirt'</span>
<span class="k">when</span> <span class="s1">'vmwareapi.VMwareESXDriver'</span><span class="p">,</span> <span class="s1">'vmwareapi.VMwareVCDriver'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'hypervisor_inspector'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'vsphere'</span>
<span class="k">else</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'hypervisor_inspector'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="k">end</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">platform_family</span>
<span class="k">when</span> <span class="s1">'suse'</span> <span class="c1"># :pragma-foodcritic: ~FC024 - won't fix this</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer'</span><span class="p">],</span>
    <span class="s1">'agent_central_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-agent-central'</span><span class="p">],</span>
    <span class="s1">'agent_central_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-agent-central'</span><span class="p">,</span>
    <span class="s1">'agent_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-agent-compute'</span><span class="p">],</span>
    <span class="s1">'agent_compute_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-agent-compute'</span><span class="p">,</span>
    <span class="s1">'agent_notification_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-agent-notification'</span><span class="p">],</span>
    <span class="s1">'agent_notification_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-agent-notification'</span><span class="p">,</span>
    <span class="s1">'alarm_evaluator_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-alarm-evaluator'</span><span class="p">],</span>
    <span class="s1">'alarm_evaluator_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-alarm-evaluator'</span><span class="p">,</span>
    <span class="s1">'alarm_notifier_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-alarm-notifier'</span><span class="p">],</span>
    <span class="s1">'alarm_notifier_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-alarm-notifier'</span><span class="p">,</span>
    <span class="s1">'api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-api'</span><span class="p">],</span>
    <span class="s1">'api_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-api'</span><span class="p">,</span>
    <span class="s1">'client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-ceilometerclient'</span><span class="p">],</span>
    <span class="s1">'collector_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-collector'</span><span class="p">],</span>
    <span class="s1">'collector_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-collector'</span><span class="p">,</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">when</span> <span class="s1">'fedora'</span><span class="p">,</span> <span class="s1">'rhel'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-common'</span><span class="p">],</span>
    <span class="s1">'agent_central_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-central'</span><span class="p">],</span>
    <span class="s1">'agent_central_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-central'</span><span class="p">,</span>
    <span class="s1">'agent_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-compute'</span><span class="p">],</span>
    <span class="s1">'agent_compute_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-compute'</span><span class="p">,</span>
    <span class="s1">'agent_notification_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-collector'</span><span class="p">],</span>
    <span class="s1">'agent_notification_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-notification'</span><span class="p">,</span>
    <span class="s1">'alarm_evaluator_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-alarm'</span><span class="p">],</span>
    <span class="s1">'alarm_evaluator_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-alarm-evaluator'</span><span class="p">,</span>
    <span class="s1">'alarm_notifier_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-alarm'</span><span class="p">],</span>
    <span class="s1">'alarm_notifier_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-alarm-notifier'</span><span class="p">,</span>
    <span class="s1">'api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-api'</span><span class="p">],</span>
    <span class="s1">'api_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-api'</span><span class="p">,</span>
    <span class="s1">'client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-ceilometerclient'</span><span class="p">],</span>
    <span class="s1">'collector_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'openstack-ceilometer-collector'</span><span class="p">],</span>
    <span class="s1">'collector_service'</span> <span class="o">=&gt;</span> <span class="s1">'openstack-ceilometer-collector'</span><span class="p">,</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
  <span class="p">}</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">when</span> <span class="s1">'debian'</span>
  <span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'platform'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'common_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceilometer-common'</span><span class="p">],</span>
    <span class="s1">'agent_central_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceilometer-agent-central'</span><span class="p">],</span>
    <span class="s1">'agent_central_service'</span> <span class="o">=&gt;</span> <span class="s1">'ceilometer-agent-central'</span><span class="p">,</span>
    <span class="s1">'agent_compute_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceilometer-agent-compute'</span><span class="p">],</span>
    <span class="s1">'agent_compute_service'</span> <span class="o">=&gt;</span> <span class="s1">'ceilometer-agent-compute'</span><span class="p">,</span>
    <span class="s1">'agent_notification_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceilometer-agent-notification'</span><span class="p">],</span>
    <span class="s1">'agent_notification_service'</span> <span class="o">=&gt;</span> <span class="s1">'ceilometer-agent-notification'</span><span class="p">,</span>
    <span class="s1">'alarm_evaluator_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceilometer-alarm-evaluator'</span><span class="p">],</span>
    <span class="s1">'alarm_evaluator_service'</span> <span class="o">=&gt;</span> <span class="s1">'ceilometer-alarm-evaluator'</span><span class="p">,</span>
    <span class="s1">'alarm_notifier_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceilometer-alarm-notifier'</span><span class="p">],</span>
    <span class="s1">'alarm_notifier_service'</span> <span class="o">=&gt;</span> <span class="s1">'ceilometer-alarm-notifier'</span><span class="p">,</span>
    <span class="s1">'api_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceilometer-api'</span><span class="p">],</span>
    <span class="s1">'api_service'</span> <span class="o">=&gt;</span> <span class="s1">'ceilometer-api'</span><span class="p">,</span>
    <span class="s1">'client_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'python-ceilometerclient'</span><span class="p">],</span>
    <span class="s1">'collector_packages'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'ceilometer-collector'</span><span class="p">,</span> <span class="s1">'python-mysqldb'</span><span class="p">],</span>
    <span class="s1">'collector_service'</span> <span class="o">=&gt;</span> <span class="s1">'ceilometer-collector'</span><span class="p">,</span>
    <span class="s1">'package_overrides'</span> <span class="o">=&gt;</span> <span class="s2">"-o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef'"</span>
  <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>

<p>The time to live value for samples which is specified in seconds, override to -1 if no data expiry is required</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">][</span><span class="s1">'time_to_live'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1800</span>
</code></pre>
</div>

<p>Decide whether to store events in notification service or not</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">default</span><span class="p">[</span><span class="s1">'openstack'</span><span class="p">][</span><span class="s1">'telemetry'</span><span class="p">][</span><span class="s1">'notification'</span><span class="p">][</span><span class="s1">'store_events'</span><span class="p">]</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
</div>

    
  </div>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Cookbook OpenStack Documentation</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Cookbook OpenStack Documentation</li>
          <li><a href="mailto:vanderwl@us.ibm.com">vanderwl@us.ibm.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/kramvan1">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">kramvan1</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/MarkRVanderwiel">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

              <span class="username">MarkRVanderwiel</span>
            </a>
          </li>
          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">Documentation for OpenStack cookbooks generated from the source ReadMe and attribute files. 
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
